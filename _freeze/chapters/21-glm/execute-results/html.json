{
  "hash": "2f22674cbf6695bfa18573be1e7d0f00",
  "result": {
    "engine": "knitr",
    "markdown": "# Generalized Linear Models {#sec-glm}\n\n\n::: {.cell}\n\n:::\n\n\n## Beyond Normal Distributions\n\nStandard linear regression assumes that the response variable is continuous and normally distributed. But many important response variables violate these assumptions. Binary outcomes (success/failure, alive/dead) follow binomial distributions. Count data (number of events, cells, species) often follow Poisson distributions.\n\nGeneralized Linear Models (GLMs) extend linear regression to handle these situations. They provide a unified framework for modeling responses that follow different distributions from the exponential family.\n\n## Components of a GLM\n\nGLMs have three components:\n\n**Random component**: Specifies the probability distribution of the response variable (e.g., binomial, Poisson, normal).\n\n**Systematic component**: The linear predictor, a linear combination of explanatory variables:\n$$\\eta = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\ldots$$\n\n**Link function**: Connects the random and systematic components, transforming the expected value of the response to the scale of the linear predictor.\n\n## The Link Function\n\nDifferent distributions use different link functions:\n\n| Distribution | Typical Link | Link Function |\n|:-------------|:-------------|:--------------|\n| Normal | Identity | $\\eta = \\mu$ |\n| Binomial | Logit | $\\eta = \\log(\\frac{\\mu}{1-\\mu})$ |\n| Poisson | Log | $\\eta = \\log(\\mu)$ |\n\n## Logistic Regression\n\nLogistic regression models binary outcomes. The response is 0 or 1 (failure or success), and we model the probability of success as a function of predictors.\n\nThe logistic function maps the linear predictor to probabilities:\n\n$$P(Y = 1 | X) = \\frac{1}{1 + e^{-(\\beta_0 + \\beta_1 X)}}$$\n\nEquivalently, we model the log-odds:\n\n$$\\log\\left(\\frac{P}{1-P}\\right) = \\beta_0 + \\beta_1 X$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# The logistic function\ncurve(1 / (1 + exp(-x)), from = -6, to = 6, \n      xlab = \"Linear Predictor\", ylab = \"Probability\",\n      main = \"The Logistic Function\", lwd = 2, col = \"blue\")\n```\n\n::: {.cell-output-display}\n![](21-glm_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n## Fitting Logistic Regression\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Example: predicting transmission type from mpg\ndata(mtcars)\nmtcars$am <- factor(mtcars$am, labels = c(\"automatic\", \"manual\"))\n\nlogit_model <- glm(am ~ mpg, data = mtcars, family = binomial)\nsummary(logit_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = am ~ mpg, family = binomial, data = mtcars)\n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)   \n(Intercept)  -6.6035     2.3514  -2.808  0.00498 **\nmpg           0.3070     0.1148   2.673  0.00751 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 43.230  on 31  degrees of freedom\nResidual deviance: 29.675  on 30  degrees of freedom\nAIC: 33.675\n\nNumber of Fisher Scoring iterations: 5\n```\n\n\n:::\n:::\n\n\n## Interpreting Logistic Coefficients\n\nCoefficients are on the log-odds scale. To interpret them:\n\n**Exponentiate** to get odds ratios:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nexp(coef(logit_model))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n(Intercept)         mpg \n0.001355579 1.359379288 \n```\n\n\n:::\n:::\n\n\nThe odds ratio for mpg (1.36) means that each additional mpg is associated with 36% higher odds of having a manual transmission.\n\n## Making Predictions\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Predict probability for specific mpg values\nnew_data <- data.frame(mpg = c(15, 20, 25, 30))\npredict(logit_model, newdata = new_data, type = \"response\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        1         2         3         4 \n0.1194021 0.3862832 0.7450109 0.9313311 \n```\n\n\n:::\n:::\n\n\nThe `type = \"response\"` argument returns probabilities rather than log-odds.\n\n## Poisson Regression\n\nPoisson regression models count data—the number of events in a fixed period or area. The response must be non-negative integers, and we assume events occur independently at a constant rate.\n\n$$\\log(\\mu) = \\beta_0 + \\beta_1 X$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Example: modeling count data\nset.seed(42)\nexposure <- runif(100, 1, 10)\ncounts <- rpois(100, lambda = exp(0.5 + 0.3 * exposure))\n\npois_model <- glm(counts ~ exposure, family = poisson)\nsummary(pois_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = counts ~ exposure, family = poisson)\n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)    \n(Intercept)  0.42499    0.10624    4.00 6.32e-05 ***\nexposure     0.30714    0.01345   22.84  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 744.110  on 99  degrees of freedom\nResidual deviance:  97.826  on 98  degrees of freedom\nAIC: 498.52\n\nNumber of Fisher Scoring iterations: 4\n```\n\n\n:::\n:::\n\n\n## Overdispersion\n\nA key assumption of Poisson regression is that the mean equals the variance. When variance exceeds the mean (overdispersion), standard errors are underestimated and p-values too small.\n\nSolutions include:\n- Quasi-Poisson (estimates dispersion from data)\n- Negative binomial regression\n- Zero-inflated models (for excess zeros)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Check for overdispersion\n# Ratio of residual deviance to df should be near 1\npois_model$deviance / pois_model$df.residual\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.9982259\n```\n\n\n:::\n:::\n\n\n## Model Assessment\n\nGLMs use **deviance** rather than R² to assess fit. Deviance compares the fitted model to a saturated model (one parameter per observation).\n\n**Null deviance**: Deviance with only the intercept\n**Residual deviance**: Deviance of the fitted model\n\nA large drop from null to residual deviance indicates the predictors explain substantial variation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compare deviances\nwith(logit_model, null.deviance - deviance)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 13.55457\n```\n\n\n:::\n\n```{.r .cell-code}\n# Chi-square test for improvement\nwith(logit_model, pchisq(null.deviance - deviance, \n                         df.null - df.residual, \n                         lower.tail = FALSE))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.0002317271\n```\n\n\n:::\n:::\n\n\n## Model Comparison with AIC\n\nAs with linear models, AIC helps compare GLMs:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Compare models\nmodel1 <- glm(am ~ mpg, data = mtcars, family = binomial)\nmodel2 <- glm(am ~ mpg + wt, data = mtcars, family = binomial)\nmodel3 <- glm(am ~ mpg * wt, data = mtcars, family = binomial)\n\nAIC(model1, model2, model3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       df      AIC\nmodel1  2 33.67517\nmodel2  3 23.18426\nmodel3  4 24.49947\n```\n\n\n:::\n:::\n\n\n## Assumptions and Diagnostics\n\nGLM assumptions include:\n- Correct specification of the distribution\n- Correct link function\n- Independence of observations\n- No extreme multicollinearity\n\nDiagnostic tools include:\n- Residual plots (deviance or Pearson residuals)\n- Influence measures\n- Goodness-of-fit tests\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1, 2))\nplot(logit_model, which = c(1, 2))\n```\n\n::: {.cell-output-display}\n![](21-glm_files/figure-html/unnamed-chunk-10-1.png){width=768}\n:::\n:::\n\n\n## Summary\n\nGLMs provide a flexible framework for modeling non-normal response variables while maintaining the interpretability of linear models. Logistic regression for binary outcomes and Poisson regression for counts are the most common applications, but the framework extends to other distributions as needed.\n",
    "supporting": [
      "21-glm_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}