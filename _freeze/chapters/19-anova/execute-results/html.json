{
  "hash": "2d661076036dab0c8fc2154ca6694285",
  "result": {
    "engine": "knitr",
    "markdown": "# Analysis of Variance {#sec-anova}\n\n\n::: {.cell}\n\n:::\n\n\n## Beyond Two Groups\n\nThe t-test compares two groups, but many experiments involve more than two. We might compare three drug treatments, five temperature conditions, or four genetic strains. Running multiple t-tests creates problems: with many comparisons, false positives become likely even when no true differences exist.\n\nAnalysis of Variance (ANOVA) provides a solution. It tests whether any of the group means differ from the others in a single test, controlling the overall Type I error rate.\n\n## The ANOVA Framework\n\nANOVA partitions the total variation in the data into components: variation between groups (due to treatment effects) and variation within groups (due to random error).\n\n![](../images/images_5b.016.jpeg){fig-align=\"center\"}\n\nThe key insight is that if groups have equal means, the between-group variation should be similar to the within-group variation. If the between-group variation is much larger, the group means probably differ.\n\n![](../images/images_5b.015.jpeg){fig-align=\"center\"}\n\n## The F-Test\n\nANOVA uses the F-statistic:\n\n$$F = \\frac{MS_{between}}{MS_{within}} = \\frac{\\text{Variance between groups}}{\\text{Variance within groups}}$$\n\nUnder the null hypothesis (all group means equal), F follows an F-distribution. Large F values indicate that group means differ more than expected by chance.\n\n## One-Way ANOVA in R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Example using iris data\niris_aov <- aov(Sepal.Length ~ Species, data = iris)\nsummary(iris_aov)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Df Sum Sq Mean Sq F value Pr(>F)    \nSpecies       2  63.21  31.606   119.3 <2e-16 ***\nResiduals   147  38.96   0.265                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\nThe significant p-value tells us that sepal length differs among species, but not which species differ from which.\n\n## ANOVA Assumptions\n\nLike the t-test, ANOVA assumes:\n\n1. **Normality**: Observations within each group are normally distributed\n2. **Homogeneity of variance**: Groups have equal variances\n3. **Independence**: Observations are independent\n\nANOVA is robust to mild violations of normality, especially with balanced designs and large samples. Serious violations of homogeneity of variance are more problematic but can be addressed with Welch's ANOVA or transformations.\n\n## Post-Hoc Comparisons\n\nA significant ANOVA tells us groups differ but not how. **Post-hoc tests** compare specific pairs of groups while controlling for multiple comparisons.\n\n**Tukey's HSD** (Honestly Significant Difference) compares all pairs:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTukeyHSD(iris_aov)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = Sepal.Length ~ Species, data = iris)\n\n$Species\n                      diff       lwr       upr p adj\nversicolor-setosa    0.930 0.6862273 1.1737727     0\nvirginica-setosa     1.582 1.3382273 1.8257727     0\nvirginica-versicolor 0.652 0.4082273 0.8957727     0\n```\n\n\n:::\n:::\n\n\nEach pairwise comparison includes the difference in means, confidence interval, and adjusted p-value.\n\n## Planned Contrasts\n\nIf you have specific hypotheses about which groups should differ (decided before seeing the data), planned contrasts are more powerful than post-hoc tests. They focus statistical power on the comparisons you care about.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Example: Compare setosa to the average of the other two species\ncontrasts(iris$Species) <- cbind(\n  setosa_vs_others = c(2, -1, -1)\n)\nsummary.lm(aov(Sepal.Length ~ Species, data = iris))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\naov(formula = Sepal.Length ~ Species, data = iris)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.6880 -0.3285 -0.0060  0.3120  1.3120 \n\nCoefficients:\n                        Estimate Std. Error t value Pr(>|t|)    \n(Intercept)              5.84333    0.04203 139.020  < 2e-16 ***\nSpeciessetosa_vs_others -0.41867    0.02972 -14.086  < 2e-16 ***\nSpecies                  0.46103    0.07280   6.333 2.77e-09 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.5148 on 147 degrees of freedom\nMultiple R-squared:  0.6187,\tAdjusted R-squared:  0.6135 \nF-statistic: 119.3 on 2 and 147 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n## Fixed vs. Random Effects\n\n**Fixed effects** are specific treatments of interest that would be the same if the study were replicated—drug A, drug B, drug C. Conclusions apply only to these specific treatments.\n\n**Random effects** are levels sampled from a larger population—particular subjects, batches, or locations. The goal is to generalize to the population of possible levels, not just those observed.\n\nThe distinction matters because it affects how F-ratios are calculated and what conclusions can be drawn.\n\n## Two-Way ANOVA\n\nWhen experiments have two factors, two-way ANOVA examines main effects of each factor and their interaction.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Simulated factorial design\nset.seed(42)\nn <- 20\ndata_factorial <- data.frame(\n  response = c(rnorm(n, 10, 2), rnorm(n, 12, 2), \n               rnorm(n, 11, 2), rnorm(n, 18, 2)),\n  factor_A = rep(c(\"A1\", \"A1\", \"A2\", \"A2\"), each = n),\n  factor_B = rep(c(\"B1\", \"B2\", \"B1\", \"B2\"), each = n)\n)\n\ntwo_way <- aov(response ~ factor_A * factor_B, data = data_factorial)\nsummary(two_way)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                  Df Sum Sq Mean Sq F value   Pr(>F)    \nfactor_A           1  279.6   279.6   59.95 3.41e-11 ***\nfactor_B           1  352.6   352.6   75.61 5.12e-13 ***\nfactor_A:factor_B  1  195.2   195.2   41.87 8.57e-09 ***\nResiduals         76  354.4     4.7                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\nAn **interaction** means the effect of one factor depends on the level of the other. Significant interactions often require examining simple effects rather than main effects.\n\n## Interaction Plots\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Visualize interaction\ninteraction.plot(data_factorial$factor_A, data_factorial$factor_B, \n                 data_factorial$response,\n                 col = c(\"blue\", \"red\"), lwd = 2,\n                 xlab = \"Factor A\", ylab = \"Response\",\n                 trace.label = \"Factor B\")\n```\n\n::: {.cell-output-display}\n![](19-anova_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nNon-parallel lines suggest an interaction. Parallel lines suggest additive (non-interacting) effects.\n\n![](../images/images_7a.022.jpeg){fig-align=\"center\"}\n\n## Nested Designs\n\nIn nested designs, levels of one factor exist only within levels of another. For example, technicians might be nested within labs—each technician works in only one lab.\n\nNested designs have no interaction term because not all combinations of factor levels exist. They are common when sampling is hierarchical.\n\n## Practical Considerations\n\nReport effect sizes (like $\\eta^2$) alongside p-values. A significant ANOVA with tiny effect size may not be practically meaningful.\n\nCheck assumptions with residual plots. Consider transformations or nonparametric alternatives (Kruskal-Wallis) when assumptions are violated.\n\nPlan your sample size using power analysis before collecting data, specifying the minimum effect size you want to detect.\n",
    "supporting": [
      "19-anova_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}