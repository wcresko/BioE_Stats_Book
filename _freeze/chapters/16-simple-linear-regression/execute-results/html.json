{
  "hash": "5b4a2b40faa8b8e633ac291128e225d3",
  "result": {
    "engine": "knitr",
    "markdown": "# Simple Linear Regression {#sec-linear-regression}\n\n\n::: {.cell}\n\n:::\n\n\n## From Correlation to Prediction\n\nCorrelation tells us that two variables are related, but it does not allow us to predict one from the other or to describe the nature of that relationship. Linear regression goes further—it models the relationship between variables, allowing us to make predictions and to quantify how changes in one variable are associated with changes in another.\n\nIn simple linear regression, we model a response variable Y as a linear function of a predictor variable X:\n\n$$y_i = \\beta_0 + \\beta_1 x_i + \\epsilon_i$$\n\nHere $\\beta_0$ is the intercept (the expected value of Y when X equals zero), $\\beta_1$ is the slope (how much Y changes for a one-unit change in X), and $\\epsilon_i$ represents the random error—the part of Y not explained by X.\n\n![](../images/images_4b.008.jpeg){fig-align=\"center\"}\n\n## Origins of the Term \"Regression\"\n\nThe term \"regression\" comes from Francis Galton's studies of heredity in the 1880s. He observed that tall parents tended to have children who were tall, but not as extremely tall as the parents—children's heights \"regressed\" toward the population mean. This phenomenon, now called regression to the mean, is a statistical artifact that appears whenever two variables are imperfectly correlated.\n\n![](../images/images_4b.002.jpeg){fig-align=\"center\"}\n\n## Fitting the Model: Ordinary Least Squares\n\nThe most common method for fitting a regression line is **ordinary least squares (OLS)**. OLS finds the line that minimizes the sum of squared residuals—the squared vertical distances between observed points and the fitted line.\n\n![](../images/images_4b.009.jpeg){fig-align=\"center\"}\n\nThe OLS estimates for the slope and intercept are:\n\n$$\\hat{\\beta}_1 = \\frac{\\sum(x_i - \\bar{x})(y_i - \\bar{y})}{\\sum(x_i - \\bar{x})^2} = r \\frac{s_y}{s_x}$$\n\n$$\\hat{\\beta}_0 = \\bar{y} - \\hat{\\beta}_1 \\bar{x}$$\n\nNotice that the slope equals the correlation coefficient times the ratio of standard deviations. This makes clear the connection between correlation and regression.\n\n## Linear Regression in R\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Example: zebrafish size data\nset.seed(42)\nn <- 100\nlength_cm <- runif(n, 0.5, 3.5)\nweight_mg <- 15 * length_cm^2 + rnorm(n, sd = 10)\n\n# Fit the model\nfish_lm <- lm(weight_mg ~ length_cm)\nsummary(fish_lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = weight_mg ~ length_cm)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-39.277  -9.033  -0.432   9.998  29.934 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -51.429      3.579  -14.37   <2e-16 ***\nlength_cm     61.660      1.583   38.95   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 14.27 on 98 degrees of freedom\nMultiple R-squared:  0.9393,\tAdjusted R-squared:  0.9387 \nF-statistic:  1517 on 1 and 98 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\nThe output shows the estimated coefficients with their standard errors, t-statistics, and p-values. The Multiple R-squared indicates how much of the variance in Y is explained by X.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Visualize the fit\nplot(length_cm, weight_mg, pch = 19, col = \"blue\",\n     xlab = \"Length (cm)\", ylab = \"Weight (mg)\",\n     main = \"Linear Regression: Weight vs Length\")\nabline(fish_lm, col = \"red\", lwd = 2)\n```\n\n::: {.cell-output-display}\n![](16-simple-linear-regression_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n## Interpretation of Coefficients\n\nThe **intercept** $\\hat{\\beta}_0$ is the predicted value of Y when X equals zero. This may or may not be meaningful depending on whether X = 0 makes sense in your context.\n\nThe **slope** $\\hat{\\beta}_1$ is the predicted change in Y for a one-unit increase in X. If the slope is 15, then each additional unit of X is associated with 15 more units of Y on average.\n\n## Hypothesis Testing in Regression\n\nThe hypothesis test for the slope asks whether there is evidence of a relationship between X and Y:\n\n$$H_0: \\beta_1 = 0 \\quad \\text{(no relationship)}$$\n$$H_A: \\beta_1 \\neq 0 \\quad \\text{(relationship exists)}$$\n\nThe test uses a t-statistic, comparing the estimated slope to its standard error. The p-value indicates the probability of observing a slope this far from zero if the true slope were zero.\n\n![](../images/images_4b.011.jpeg){fig-align=\"center\"}\n\n## R-Squared: Measuring Model Fit\n\n**R-squared** ($R^2$) measures the proportion of variance in Y explained by the model:\n\n$$R^2 = 1 - \\frac{SS_{error}}{SS_{total}} = \\frac{SS_{model}}{SS_{total}}$$\n\nIn simple linear regression, $R^2$ equals the square of the correlation coefficient. An $R^2$ of 0.7 means the model explains 70% of the variance in Y; the remaining 30% is unexplained.\n\nBe cautious with $R^2$—it always increases when you add predictors, even useless ones. Adjusted $R^2$ penalizes for model complexity.\n\n## Making Predictions\n\nOnce you have a fitted model, you can predict Y for new values of X:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Predict weight for new lengths\nnew_lengths <- data.frame(length_cm = c(1.0, 2.0, 3.0))\npredict(fish_lm, newdata = new_lengths, interval = \"confidence\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        fit        lwr       upr\n1  10.23108   5.828292  14.63387\n2  71.89135  69.050838  74.73186\n3 133.55162 129.491293 137.61194\n```\n\n\n:::\n:::\n\n\nThe confidence interval indicates uncertainty about the mean Y at each X value. A prediction interval (using `interval = \"prediction\"`) would be wider, accounting for individual variability around that mean.\n\n## Model Assumptions\n\nLinear regression assumptions include:\n\n1. **Linearity**: The relationship between X and Y is linear\n2. **Independence**: Observations are independent of each other\n3. **Normality**: Residuals are normally distributed\n4. **Homoscedasticity**: Residuals have constant variance across X\n\nThese assumptions should be checked through residual analysis, which we cover in the next chapter.\n",
    "supporting": [
      "16-simple-linear-regression_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}