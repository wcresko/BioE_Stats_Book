<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>10&nbsp; Sampling and Parameter Estimation – Statistics for Bioengineering</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/11-hypothesis-testing.html" rel="next">
<link href="../chapters/09-continuous-distributions.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-485d01fc63b59abcd3ee1bf1e8e2748d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/07-probability-foundations.html">Probability and Distributions</a></li><li class="breadcrumb-item"><a href="../chapters/10-sampling-estimation.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Sampling and Parameter Estimation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Statistics for Bioengineering</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Foundations of Data Science</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-unix-command-line.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Unix and the Command Line</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03-r-rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R and RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04-markdown-latex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Markdown and LaTeX</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05-tidy-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Tidy Data and Data Wrangling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06-data-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Probability and Distributions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07-probability-foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Foundations of Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/08-discrete-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/09-continuous-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Continuous Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/10-sampling-estimation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Sampling and Parameter Estimation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Statistical Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/11-hypothesis-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/12-t-tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">T-Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/13-nonparametric-tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Nonparametric Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/14-bootstrapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Bootstrapping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/14b-what-are-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">What are Models?</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/15-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Correlation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/16-simple-linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Simple Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/17-residual-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Residual Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/18-statistical-power.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Statistical Power</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/19-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/20-multiple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Multiple Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/21-glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Generalized Linear Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/22-statistical-learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Statistical Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/23-dimensionality-reduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Dimensionality Reduction and Multivariate Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/24-high-performance-computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">High Performance Computing</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Scientific Communication</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/25-presenting-results.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Presenting Statistical Results</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Historical Context</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A1-eugenics-history.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">The Eugenics History of Statistics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A2-r-reference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">R Command Reference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A3-probability-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Common Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A4-greek-letters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Greek Letters in Mathematics and Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A5-sampling-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Sampling Distributions in Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A6-unix-reference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Unix Command Reference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A7-latex-reference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">LaTeX Command Reference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A8-keyboard-shortcuts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Keyboard Shortcuts Reference</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-problem-of-inference" id="toc-the-problem-of-inference" class="nav-link active" data-scroll-target="#the-problem-of-inference"><span class="header-section-number">10.1</span> The Problem of Inference</a></li>
  <li><a href="#parameters-and-statistics" id="toc-parameters-and-statistics" class="nav-link" data-scroll-target="#parameters-and-statistics"><span class="header-section-number">10.2</span> Parameters and Statistics</a></li>
  <li><a href="#point-estimates" id="toc-point-estimates" class="nav-link" data-scroll-target="#point-estimates"><span class="header-section-number">10.3</span> Point Estimates</a></li>
  <li><a href="#the-sampling-distribution-of-the-mean" id="toc-the-sampling-distribution-of-the-mean" class="nav-link" data-scroll-target="#the-sampling-distribution-of-the-mean"><span class="header-section-number">10.4</span> The Sampling Distribution of the Mean</a></li>
  <li><a href="#standard-error" id="toc-standard-error" class="nav-link" data-scroll-target="#standard-error"><span class="header-section-number">10.5</span> Standard Error</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals"><span class="header-section-number">10.6</span> Confidence Intervals</a></li>
  <li><a href="#the-central-limit-theorem-in-practice" id="toc-the-central-limit-theorem-in-practice" class="nav-link" data-scroll-target="#the-central-limit-theorem-in-practice"><span class="header-section-number">10.7</span> The Central Limit Theorem in Practice</a>
  <ul class="collapse">
  <li><a href="#the-clt-demonstrated" id="toc-the-clt-demonstrated" class="nav-link" data-scroll-target="#the-clt-demonstrated"><span class="header-section-number">10.7.1</span> The CLT Demonstrated</a></li>
  <li><a href="#margin-of-error-quantifying-precision" id="toc-margin-of-error-quantifying-precision" class="nav-link" data-scroll-target="#margin-of-error-quantifying-precision"><span class="header-section-number">10.7.2</span> Margin of Error: Quantifying Precision</a></li>
  <li><a href="#polling-as-a-statistical-inference-problem" id="toc-polling-as-a-statistical-inference-problem" class="nav-link" data-scroll-target="#polling-as-a-statistical-inference-problem"><span class="header-section-number">10.7.3</span> Polling as a Statistical Inference Problem</a></li>
  <li><a href="#how-sample-size-affects-margin-of-error" id="toc-how-sample-size-affects-margin-of-error" class="nav-link" data-scroll-target="#how-sample-size-affects-margin-of-error"><span class="header-section-number">10.7.4</span> How Sample Size Affects Margin of Error</a></li>
  <li><a href="#interpreting-polls-uncertainty-in-action" id="toc-interpreting-polls-uncertainty-in-action" class="nav-link" data-scroll-target="#interpreting-polls-uncertainty-in-action"><span class="header-section-number">10.7.5</span> Interpreting Polls: Uncertainty in Action</a></li>
  <li><a href="#correct-language-for-confidence-intervals" id="toc-correct-language-for-confidence-intervals" class="nav-link" data-scroll-target="#correct-language-for-confidence-intervals"><span class="header-section-number">10.7.6</span> Correct Language for Confidence Intervals</a></li>
  <li><a href="#the-practical-value-of-margin-of-error" id="toc-the-practical-value-of-margin-of-error" class="nav-link" data-scroll-target="#the-practical-value-of-margin-of-error"><span class="header-section-number">10.7.7</span> The Practical Value of Margin of Error</a></li>
  </ul></li>
  <li><a href="#coefficient-of-variation" id="toc-coefficient-of-variation" class="nav-link" data-scroll-target="#coefficient-of-variation"><span class="header-section-number">10.8</span> Coefficient of Variation</a></li>
  <li><a href="#percentiles-and-quantiles" id="toc-percentiles-and-quantiles" class="nav-link" data-scroll-target="#percentiles-and-quantiles"><span class="header-section-number">10.9</span> Percentiles and Quantiles</a></li>
  <li><a href="#bias-and-variability" id="toc-bias-and-variability" class="nav-link" data-scroll-target="#bias-and-variability"><span class="header-section-number">10.10</span> Bias and Variability</a></li>
  <li><a href="#the-bootstrap-resampling-for-estimation" id="toc-the-bootstrap-resampling-for-estimation" class="nav-link" data-scroll-target="#the-bootstrap-resampling-for-estimation"><span class="header-section-number">10.11</span> The Bootstrap: Resampling for Estimation</a>
  <ul class="collapse">
  <li><a href="#the-bootstrap-algorithm" id="toc-the-bootstrap-algorithm" class="nav-link" data-scroll-target="#the-bootstrap-algorithm"><span class="header-section-number">10.11.1</span> The Bootstrap Algorithm</a></li>
  <li><a href="#bootstrap-confidence-intervals" id="toc-bootstrap-confidence-intervals" class="nav-link" data-scroll-target="#bootstrap-confidence-intervals"><span class="header-section-number">10.11.2</span> Bootstrap Confidence Intervals</a></li>
  <li><a href="#when-to-use-the-bootstrap" id="toc-when-to-use-the-bootstrap" class="nav-link" data-scroll-target="#when-to-use-the-bootstrap"><span class="header-section-number">10.11.3</span> When to Use the Bootstrap</a></li>
  </ul></li>
  <li><a href="#maximum-likelihood-estimation" id="toc-maximum-likelihood-estimation" class="nav-link" data-scroll-target="#maximum-likelihood-estimation"><span class="header-section-number">10.12</span> Maximum Likelihood Estimation</a></li>
  <li><a href="#simulation-based-understanding-of-estimation" id="toc-simulation-based-understanding-of-estimation" class="nav-link" data-scroll-target="#simulation-based-understanding-of-estimation"><span class="header-section-number">10.13</span> Simulation-Based Understanding of Estimation</a></li>
  <li><a href="#principles-of-experimental-design" id="toc-principles-of-experimental-design" class="nav-link" data-scroll-target="#principles-of-experimental-design"><span class="header-section-number">10.14</span> Principles of Experimental Design</a>
  <ul class="collapse">
  <li><a href="#randomization" id="toc-randomization" class="nav-link" data-scroll-target="#randomization"><span class="header-section-number">10.14.1</span> Randomization</a></li>
  <li><a href="#controls" id="toc-controls" class="nav-link" data-scroll-target="#controls"><span class="header-section-number">10.14.2</span> Controls</a></li>
  <li><a href="#blinding" id="toc-blinding" class="nav-link" data-scroll-target="#blinding"><span class="header-section-number">10.14.3</span> Blinding</a></li>
  <li><a href="#replication" id="toc-replication" class="nav-link" data-scroll-target="#replication"><span class="header-section-number">10.14.4</span> Replication</a></li>
  <li><a href="#blocking" id="toc-blocking" class="nav-link" data-scroll-target="#blocking"><span class="header-section-number">10.14.5</span> Blocking</a></li>
  <li><a href="#sample-size-considerations" id="toc-sample-size-considerations" class="nav-link" data-scroll-target="#sample-size-considerations"><span class="header-section-number">10.14.6</span> Sample Size Considerations</a></li>
  </ul></li>
  <li><a href="#key-takeaways" id="toc-key-takeaways" class="nav-link" data-scroll-target="#key-takeaways"><span class="header-section-number">10.15</span> Key Takeaways</a></li>
  <li><a href="#additional-resources" id="toc-additional-resources" class="nav-link" data-scroll-target="#additional-resources"><span class="header-section-number">10.16</span> Additional Resources</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/07-probability-foundations.html">Probability and Distributions</a></li><li class="breadcrumb-item"><a href="../chapters/10-sampling-estimation.html"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Sampling and Parameter Estimation</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-sampling-estimation" class="quarto-section-identifier"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Sampling and Parameter Estimation</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="the-problem-of-inference" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="the-problem-of-inference"><span class="header-section-number">10.1</span> The Problem of Inference</h2>
<p>Science often works by measuring samples to learn about populations. We cannot measure every protein in a cell, every patient with a disease, or every fish in the ocean. Instead, we take samples and use statistical inference to draw conclusions about the larger populations from which they came.</p>
<p>This creates a fundamental challenge: sample statistics vary from sample to sample, even when samples come from the same population. If you take two different random samples from a population and calculate their means, you will almost certainly get two different values. How, then, can we say anything reliable about the population?</p>
<p>The answer lies in understanding the sampling distribution—the distribution of a statistic across all possible samples of a given size.</p>
</section>
<section id="parameters-and-statistics" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="parameters-and-statistics"><span class="header-section-number">10.2</span> Parameters and Statistics</h2>
<p>A <strong>parameter</strong> is a numerical characteristic of a population—the true population mean <span class="math inline">\(\mu\)</span>, the true population standard deviation <span class="math inline">\(\sigma\)</span>, the true proportion <span class="math inline">\(p\)</span>. Parameters are typically fixed but unknown.</p>
<p>A <strong>statistic</strong> is a numerical characteristic of a sample—the sample mean <span class="math inline">\(\bar{x}\)</span>, the sample standard deviation <span class="math inline">\(s\)</span>, the sample proportion <span class="math inline">\(\hat{p}\)</span>. Statistics are calculated from data and vary from sample to sample.</p>
<p>We use statistics to estimate parameters. The sample mean <span class="math inline">\(\bar{x}\)</span> estimates the population mean <span class="math inline">\(\mu\)</span>. The sample standard deviation <span class="math inline">\(s\)</span> estimates the population standard deviation <span class="math inline">\(\sigma\)</span>. These estimates will rarely equal the true parameter values exactly, but we can quantify how close they are likely to be.</p>
</section>
<section id="point-estimates" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="point-estimates"><span class="header-section-number">10.3</span> Point Estimates</h2>
<p>A <strong>point estimate</strong> is a single number used as our best guess for a parameter. The sample mean is a natural point estimate for the population mean:</p>
<p><span class="math display">\[\bar{x} = \frac{1}{n} \sum_{i=1}^{n} x_i\]</span></p>
<p>What makes a good estimator? Ideally, an estimator should be:</p>
<p><strong>Unbiased</strong>: On average, across many samples, the estimator equals the true parameter. The sample mean is an unbiased estimator of the population mean.</p>
<p><strong>Efficient</strong>: Among unbiased estimators, it has the smallest variance. The sample mean is the most efficient estimator of a normal mean.</p>
<p><strong>Consistent</strong>: As sample size increases, the estimator converges to the true parameter value.</p>
</section>
<section id="the-sampling-distribution-of-the-mean" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="the-sampling-distribution-of-the-mean"><span class="header-section-number">10.4</span> The Sampling Distribution of the Mean</h2>
<p>Imagine drawing all possible samples of size <span class="math inline">\(n\)</span> from a population and calculating the mean of each. The distribution of these means is the sampling distribution of the mean.</p>
<p>The sampling distribution has remarkable properties:</p>
<ol type="1">
<li>Its mean equals the population mean: <span class="math inline">\(E[\bar{X}] = \mu\)</span></li>
<li>Its standard deviation (the <strong>standard error</strong>) equals: <span class="math inline">\(SE = \frac{\sigma}{\sqrt{n}}\)</span></li>
<li>For large samples, it is approximately normal (Central Limit Theorem)</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstrate sampling distribution</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">32</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a population</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>true_pop <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">lambda =</span> <span class="dv">3</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>pop_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(true_pop)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>pop_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(true_pop)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Take many samples and compute their means</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">200</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> sample_sizes) {</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  sample_means <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">mean</span>(<span class="fu">sample</span>(true_pop, n)))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(sample_means, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"n ="</span>, n),</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Sample Mean"</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>))</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> pop_mean, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="10-sampling-estimation_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>As sample size increases, the sampling distribution becomes narrower (smaller standard error) and more normal in shape. This is why larger samples give more precise estimates.</p>
</section>
<section id="standard-error" class="level2" data-number="10.5">
<h2 data-number="10.5" class="anchored" data-anchor-id="standard-error"><span class="header-section-number">10.5</span> Standard Error</h2>
<p>The <strong>standard error</strong> (SE) measures the variability of a statistic across samples. For the sample mean:</p>
<p><span class="math display">\[SE_{\bar{x}} = \frac{\sigma}{\sqrt{n}}\]</span></p>
<p>Since we usually do not know <span class="math inline">\(\sigma\)</span>, we estimate the standard error using the sample standard deviation:</p>
<p><span class="math display">\[\widehat{SE}_{\bar{x}} = \frac{s}{\sqrt{n}}\]</span></p>
<p>The standard error shrinks as sample size increases, but following a square root relationship. To halve the standard error, you need to quadruple the sample size.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstrate how SE changes with sample size</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">32</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>true_pop <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">lambda =</span> <span class="dv">5</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample size of 5</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>samps_5 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="fu">sample</span>(true_pop, <span class="at">size =</span> <span class="dv">5</span>))</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>means_5 <span class="ot">&lt;-</span> <span class="fu">apply</span>(samps_5, <span class="dv">2</span>, mean)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>se_5 <span class="ot">&lt;-</span> <span class="fu">sd</span>(means_5)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample size of 50</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>samps_50 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="fu">sample</span>(true_pop, <span class="at">size =</span> <span class="dv">50</span>))</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>means_50 <span class="ot">&lt;-</span> <span class="fu">apply</span>(samps_50, <span class="dv">2</span>, mean)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>se_50 <span class="ot">&lt;-</span> <span class="fu">sd</span>(means_50)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Standard error with n=5:"</span>, <span class="fu">round</span>(se_5, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Standard error with n=5: 0.919 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Standard error with n=50:"</span>, <span class="fu">round</span>(se_50, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Standard error with n=50: 0.305 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Ratio:"</span>, <span class="fu">round</span>(se_5<span class="sc">/</span>se_50, <span class="dv">2</span>), <span class="st">"(theoretical: √10 ="</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="dv">10</span>), <span class="dv">2</span>), <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Ratio: 3.01 (theoretical: √10 = 3.16 )</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/week_2.026.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section>
<section id="confidence-intervals" class="level2" data-number="10.6">
<h2 data-number="10.6" class="anchored" data-anchor-id="confidence-intervals"><span class="header-section-number">10.6</span> Confidence Intervals</h2>
<p>A point estimate tells us our best guess, but not how uncertain we are. A <strong>confidence interval</strong> provides a range of plausible values for the parameter along with a measure of confidence.</p>
<p>A 95% confidence interval for the population mean, when the population is normally distributed or the sample is large, is:</p>
<p><span class="math display">\[\bar{x} \pm t_{\alpha/2} \times \frac{s}{\sqrt{n}}\]</span></p>
<p>where <span class="math inline">\(t_{\alpha/2}\)</span> is the critical value from the t-distribution with <span class="math inline">\(n-1\)</span> degrees of freedom.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/week_2.027.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>The interpretation requires care: a 95% confidence interval means that if we repeated this procedure many times, 95% of the resulting intervals would contain the true parameter. Any particular interval either does or does not contain the true value—we just don’t know which.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate a confidence interval</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>sample_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(sample_data)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>sample_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(sample_data) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(sample_data))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>t_crit <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> <span class="fu">length</span>(sample_data) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> sample_mean <span class="sc">-</span> t_crit <span class="sc">*</span> sample_se</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> sample_mean <span class="sc">+</span> t_crit <span class="sc">*</span> sample_se</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample mean:"</span>, <span class="fu">round</span>(sample_mean, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Sample mean: 101.03 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI: ["</span>, <span class="fu">round</span>(lower, <span class="dv">2</span>), <span class="st">","</span>, <span class="fu">round</span>(upper, <span class="dv">2</span>), <span class="st">"]</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI: [ 94 , 108.06 ]</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Or use t.test directly</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sample_data)<span class="sc">$</span>conf.int</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  93.99927 108.05833
attr(,"conf.level")
[1] 0.95</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/week_2.028.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section>
<section id="the-central-limit-theorem-in-practice" class="level2" data-number="10.7">
<h2 data-number="10.7" class="anchored" data-anchor-id="the-central-limit-theorem-in-practice"><span class="header-section-number">10.7</span> The Central Limit Theorem in Practice</h2>
<p>The Central Limit Theorem (CLT) is one of the most remarkable results in statistics. It states that the sampling distribution of the mean approaches a normal distribution as sample size increases, regardless of the shape of the underlying population distribution.</p>
<p>This is why confidence intervals work. This is why the normal distribution appears everywhere in statistics. And understanding the CLT in practice—through examples like polling and surveys—builds deep intuition for statistical inference.</p>
<section id="the-clt-demonstrated" class="level3" data-number="10.7.1">
<h3 data-number="10.7.1" class="anchored" data-anchor-id="the-clt-demonstrated"><span class="header-section-number">10.7.1</span> The CLT Demonstrated</h3>
<p>Let’s see the CLT in action with a highly non-normal distribution. We’ll sample from an exponential distribution (heavily right-skewed) and watch how the sampling distribution of the mean becomes normal:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Exponential distribution (very skewed)</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>pop_mean <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>rate  <span class="co"># True mean = 2</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Original population</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">10000</span>, <span class="at">rate =</span> rate)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">main =</span> <span class="st">"Original Distribution (Exponential)"</span>,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">col =</span> <span class="st">"gray80"</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dexp</span>(x, <span class="at">rate =</span> rate), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample means for different n</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">30</span>, <span class="dv">100</span>)) {</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  sample_means <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">5000</span>, <span class="fu">mean</span>(<span class="fu">rexp</span>(n, <span class="at">rate =</span> rate)))</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(sample_means, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Sampling Distribution (n ="</span>, n, <span class="st">")"</span>),</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Sample Mean"</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Overlay normal curve with theoretical SE</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  theoretical_se <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span>rate) <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean =</span> pop_mean, <span class="at">sd =</span> theoretical_se),</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="10-sampling-estimation_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
<p>Even with n = 30, the sampling distribution of the mean is remarkably close to normal, despite the exponential distribution being extremely skewed. By n = 100, the approximation is nearly perfect.</p>
</section>
<section id="margin-of-error-quantifying-precision" class="level3" data-number="10.7.2">
<h3 data-number="10.7.2" class="anchored" data-anchor-id="margin-of-error-quantifying-precision"><span class="header-section-number">10.7.2</span> Margin of Error: Quantifying Precision</h3>
<p>The <strong>margin of error</strong> (MOE) is a practical expression of sampling uncertainty. For a confidence interval around a proportion or mean, the margin of error is the half-width of the interval:</p>
<p><span class="math display">\[\text{Margin of Error} = z^* \times SE\]</span></p>
<p>For a 95% confidence interval, <span class="math inline">\(z^* \approx 1.96 \approx 2\)</span>, giving us the approximation:</p>
<p><span class="math display">\[\text{95% MOE} \approx 2 \times SE\]</span></p>
<p>For proportions, the standard error is <span class="math inline">\(SE = \sqrt{\frac{p(1-p)}{n}}\)</span>, so:</p>
<p><span class="math display">\[\text{95% MOE} \approx 2 \times \sqrt{\frac{p(1-p)}{n}}\]</span></p>
<p>The maximum standard error for a proportion occurs when <span class="math inline">\(p = 0.5\)</span>, giving the conservative formula used in sample size planning:</p>
<p><span class="math display">\[\text{Maximum 95% MOE} \approx \frac{1}{\sqrt{n}}\]</span></p>
</section>
<section id="polling-as-a-statistical-inference-problem" class="level3" data-number="10.7.3">
<h3 data-number="10.7.3" class="anchored" data-anchor-id="polling-as-a-statistical-inference-problem"><span class="header-section-number">10.7.3</span> Polling as a Statistical Inference Problem</h3>
<p>Political polling provides an excellent practical example of sampling and the CLT. When a poll reports “48% of voters support Candidate A, with a margin of error of ±3%,” they are making a statistical inference from a sample to a population.</p>
<p>Let’s simulate an election poll:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># True population proportion (unknown in real life)</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>true_proportion <span class="ot">&lt;-</span> <span class="fl">0.52</span>  <span class="co"># 52% actually support the candidate</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate a poll of 1000 likely voters</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>poll_sample <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">prob =</span> true_proportion) <span class="sc">/</span> n</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate margin of error</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(poll_sample <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> poll_sample) <span class="sc">/</span> n)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>moe <span class="ot">&lt;-</span> <span class="fl">1.96</span> <span class="sc">*</span> se</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Poll result:"</span>, <span class="fu">round</span>(poll_sample <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Poll result: 53.2 %</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Margin of error: ±"</span>, <span class="fu">round</span>(moe <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Margin of error: ± 3.1 %</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI: ["</span>, <span class="fu">round</span>((poll_sample <span class="sc">-</span> moe) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%, "</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>((poll_sample <span class="sc">+</span> moe) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%]</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>95% CI: [ 50.1 %,  56.3 %]</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"True proportion:"</span>, true_proportion <span class="sc">*</span> <span class="dv">100</span>, <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>True proportion: 52 %</code></pre>
</div>
</div>
</section>
<section id="how-sample-size-affects-margin-of-error" class="level3" data-number="10.7.4">
<h3 data-number="10.7.4" class="anchored" data-anchor-id="how-sample-size-affects-margin-of-error"><span class="header-section-number">10.7.4</span> How Sample Size Affects Margin of Error</h3>
<p>The margin of error is inversely proportional to <span class="math inline">\(\sqrt{n}\)</span>. This has important practical implications:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Margin of error as a function of sample size</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">400</span>, <span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">4000</span>, <span class="dv">10000</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># Conservative estimate</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>moe_values <span class="ot">&lt;-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">/</span> sample_sizes) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sample_sizes, moe_values, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Sample Size"</span>, <span class="at">ylab =</span> <span class="st">"Margin of Error (%)"</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"95% Margin of Error vs. Sample Size"</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">log =</span> <span class="st">"x"</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(sample_sizes, moe_values <span class="sc">+</span> <span class="fl">0.5</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>     <span class="fu">paste0</span>(<span class="st">"±"</span>, <span class="fu">round</span>(moe_values, <span class="dv">1</span>), <span class="st">"%"</span>),</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="10-sampling-estimation_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Notice the diminishing returns: going from n = 100 to n = 400 cuts the margin of error in half (from ±10% to ±5%). But to halve it again (to ±2.5%), you need n = 1,600—four times as many respondents. This is why most national polls use samples of 1,000–2,000: it provides reasonable precision (±2-3%) at manageable cost.</p>
</section>
<section id="interpreting-polls-uncertainty-in-action" class="level3" data-number="10.7.5">
<h3 data-number="10.7.5" class="anchored" data-anchor-id="interpreting-polls-uncertainty-in-action"><span class="header-section-number">10.7.5</span> Interpreting Polls: Uncertainty in Action</h3>
<p>When two candidates are within the margin of error of each other, the poll results are consistent with either candidate leading. This is not a flaw of polling—it reflects genuine uncertainty.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate many polls from the same population</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>true_p <span class="ot">&lt;-</span> <span class="fl">0.48</span>  <span class="co"># Candidate A's true support</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>n_poll <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>n_polls <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>polls <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_polls, {</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  sample_p <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n_poll, true_p) <span class="sc">/</span> n_poll</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sample_p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> sample_p) <span class="sc">/</span> n_poll)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">estimate =</span> sample_p, <span class="at">lower =</span> sample_p <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>se, <span class="at">upper =</span> sample_p <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>se)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>polls_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">poll =</span> <span class="dv">1</span><span class="sc">:</span>n_polls,</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> polls[<span class="st">"estimate"</span>, ],</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> polls[<span class="st">"lower"</span>, ],</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> polls[<span class="st">"upper"</span>, ]</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="co"># How many CIs contain the true value?</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>coverage <span class="ot">&lt;-</span> <span class="fu">mean</span>(polls_df<span class="sc">$</span>lower <span class="sc">&lt;=</span> true_p <span class="sc">&amp;</span> polls_df<span class="sc">$</span>upper <span class="sc">&gt;=</span> true_p)</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot first 30 polls</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(polls_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, ], <span class="fu">aes</span>(<span class="at">x =</span> poll, <span class="at">y =</span> estimate)) <span class="sc">+</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> true_p, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"95% Confidence Intervals from 30 Polls"</span>,</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"True proportion = "</span>, true_p<span class="sc">*</span><span class="dv">100</span>, <span class="st">"% | "</span>, <span class="fu">round</span>(coverage<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"% of all CIs contain true value"</span>),</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Poll Number"</span>,</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Estimated Proportion"</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="10-sampling-estimation_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>In repeated sampling, approximately 95% of confidence intervals contain the true value—but any single interval either does or does not contain it. This is the frequentist interpretation of confidence intervals.</p>
</section>
<section id="correct-language-for-confidence-intervals" class="level3" data-number="10.7.6">
<h3 data-number="10.7.6" class="anchored" data-anchor-id="correct-language-for-confidence-intervals"><span class="header-section-number">10.7.6</span> Correct Language for Confidence Intervals</h3>
<p>Confidence intervals are frequently misinterpreted. The key insight is understanding <em>what is random</em> before and after data collection:</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
What Is Random?
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Before data collection</strong>: The confidence interval is random—we don’t yet know where it will fall. The population parameter <span class="math inline">\(\mu\)</span> is fixed (though unknown).</p>
<p><strong>After data collection</strong>: The confidence interval is now fixed—it’s just two numbers like [48.2, 52.1]. It either contains the true parameter or it doesn’t. There is no probability involved anymore.</p>
</div>
</div>
<p>Consider this analogy: Before flipping a coin, there’s a 50% probability of heads. After flipping, the coin shows what it shows—there’s no longer any probability, just an outcome.</p>
<p>The correct interpretation of a 95% confidence interval is:</p>
<blockquote class="blockquote">
<p>“If we repeated this sampling procedure many times, 95% of the resulting intervals would contain the true population parameter.”</p>
</blockquote>
<p><strong>Incorrect interpretations</strong> (which are very common):</p>
<ul>
<li>❌ “There is a 95% probability that <span class="math inline">\(\mu\)</span> is in this interval”</li>
<li>❌ “We are 95% confident that <span class="math inline">\(\mu\)</span> is between these values”</li>
<li>❌ “95% of the data falls within this interval”</li>
</ul>
<p>The first two statements incorrectly assign probability to the parameter, which is fixed. The third confuses a confidence interval for a reference range.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visual demonstration: Monte Carlo simulation of CI coverage</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2024</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># True population parameters</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>true_mean <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>true_sd <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">25</span>  <span class="co"># Sample size</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>n_simulations <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Storage for confidence intervals</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>ci_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">sim =</span> <span class="dv">1</span><span class="sc">:</span>n_simulations,</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="fu">numeric</span>(n_simulations),</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> <span class="fu">numeric</span>(n_simulations),</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">contains_true =</span> <span class="fu">logical</span>(n_simulations)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate 100 confidence intervals</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_simulations) {</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> true_mean, <span class="at">sd =</span> true_sd)</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">t.test</span>(sample_data)<span class="sc">$</span>conf.int</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  ci_data<span class="sc">$</span>lower[i] <span class="ot">&lt;-</span> ci[<span class="dv">1</span>]</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  ci_data<span class="sc">$</span>upper[i] <span class="ot">&lt;-</span> ci[<span class="dv">2</span>]</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>  ci_data<span class="sc">$</span>contains_true[i] <span class="ot">&lt;-</span> (ci[<span class="dv">1</span>] <span class="sc">&lt;=</span> true_mean) <span class="sc">&amp;</span> (ci[<span class="dv">2</span>] <span class="sc">&gt;=</span> true_mean)</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Count how many contain the true mean</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>coverage <span class="ot">&lt;-</span> <span class="fu">mean</span>(ci_data<span class="sc">$</span>contains_true)</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NULL</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">42</span>, <span class="dv">58</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, n_simulations <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">ylab =</span> <span class="st">"Simulation Number"</span>,</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"100 Confidence Intervals ("</span>, <span class="fu">round</span>(coverage<span class="sc">*</span><span class="dv">100</span>), <span class="st">"% contain true mean)"</span>))</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw intervals</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_simulations) {</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>  color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(ci_data<span class="sc">$</span>contains_true[i], <span class="st">"steelblue"</span>, <span class="st">"red"</span>)</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">segments</span>(ci_data<span class="sc">$</span>lower[i], i, ci_data<span class="sc">$</span>upper[i], i, <span class="at">col =</span> color, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a><span class="co"># True mean line</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> true_mean, <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Contains true mean"</span>, <span class="st">"Misses true mean"</span>, <span class="st">"True mean (μ = 50)"</span>),</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"steelblue"</span>, <span class="st">"red"</span>, <span class="st">"darkgreen"</span>),</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="10-sampling-estimation_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
<p>In this simulation, each horizontal line represents a 95% confidence interval from a different random sample. The red intervals are the ~5% that failed to capture the true mean. Once calculated, each interval either contains the true value (blue) or doesn’t (red)—there’s no probability about it anymore.</p>
</section>
<section id="the-practical-value-of-margin-of-error" class="level3" data-number="10.7.7">
<h3 data-number="10.7.7" class="anchored" data-anchor-id="the-practical-value-of-margin-of-error"><span class="header-section-number">10.7.7</span> The Practical Value of Margin of Error</h3>
<p>Understanding margin of error helps you:</p>
<ol type="1">
<li><strong>Interpret reported results</strong>: A poll showing 52% vs.&nbsp;48% with ±3% MOE does not clearly favor either candidate</li>
<li><strong>Plan studies</strong>: Use <span class="math inline">\(n \approx \frac{1}{\text{MOE}^2}\)</span> for proportions near 0.5 to achieve a desired margin of error</li>
<li><strong>Communicate uncertainty</strong>: Always report intervals, not just point estimates</li>
<li><strong>Make decisions</strong>: Consider whether differences are within or beyond the margin of error</li>
</ol>
<p>For sample size planning, if you want a specific margin of error:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Required sample size for different margins of error (95% CI)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>desired_moe <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.05</span>, <span class="fl">0.03</span>, <span class="fl">0.02</span>, <span class="fl">0.01</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>required_n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>((<span class="fl">1.96</span> <span class="sc">/</span> desired_moe)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fl">0.25</span>)  <span class="co"># 0.25 = p(1-p) at p=0.5</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Margin of Error</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"±"</span>, desired_moe <span class="sc">*</span> <span class="dv">100</span>, <span class="st">"%"</span>),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Required n</span><span class="st">`</span> <span class="ot">=</span> required_n</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Margin.of.Error Required.n
1            ±10%         97
2             ±5%        385
3             ±3%       1068
4             ±2%       2401
5             ±1%       9604</code></pre>
</div>
</div>
<p>These calculations assume simple random sampling. Real-world surveys often use complex sampling designs that affect the effective sample size.</p>
</section>
</section>
<section id="coefficient-of-variation" class="level2" data-number="10.8">
<h2 data-number="10.8" class="anchored" data-anchor-id="coefficient-of-variation"><span class="header-section-number">10.8</span> Coefficient of Variation</h2>
<p>When comparing variability across groups with different means, the standard deviation alone can be misleading. The <strong>coefficient of variation</strong> (CV) standardizes variability relative to the mean:</p>
<p><span class="math display">\[CV = \frac{s}{\bar{x}} \times 100\%\]</span></p>
<p>A CV of 10% means the standard deviation is 10% of the mean. This allows meaningful comparisons between groups or measurements on different scales.</p>
</section>
<section id="percentiles-and-quantiles" class="level2" data-number="10.9">
<h2 data-number="10.9" class="anchored" data-anchor-id="percentiles-and-quantiles"><span class="header-section-number">10.9</span> Percentiles and Quantiles</h2>
<p><strong>Percentiles</strong> describe the relative position of values within a distribution. The <span class="math inline">\(p\)</span>th percentile is the value below which <span class="math inline">\(p\)</span>% of the data falls. The 50th percentile is the median, the 25th percentile is the first quartile, and the 75th percentile is the third quartile.</p>
<p><strong>Quantiles</strong> divide data into equal parts. Quartiles divide into four parts, deciles into ten parts, percentiles into one hundred parts.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentiles</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">22</span>, <span class="dv">25</span>, <span class="dv">28</span>, <span class="dv">32</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">45</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(data, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  25%   50%   75% 
19.00 26.50 34.25 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  12.00   19.00   26.50   27.20   34.25   45.00 </code></pre>
</div>
</div>
<p>Quantiles form the basis for many statistical procedures, including constructing confidence intervals and calculating p-values.</p>
</section>
<section id="bias-and-variability" class="level2" data-number="10.10">
<h2 data-number="10.10" class="anchored" data-anchor-id="bias-and-variability"><span class="header-section-number">10.10</span> Bias and Variability</h2>
<p>Two distinct types of error affect estimates:</p>
<p><strong>Bias</strong> is systematic error—the tendency for an estimator to consistently over- or underestimate the true parameter. An unbiased estimator has zero bias: its average value across all possible samples equals the true parameter.</p>
<p><strong>Variability</strong> is random error—the spread of estimates around their average value. Low variability means estimates cluster tightly together.</p>
<p>The ideal estimator has both low bias and low variability. Sometimes there is a tradeoff: a slightly biased estimator might have much lower variability, resulting in estimates that are closer to the truth on average.</p>
<p>The <strong>mean squared error</strong> (MSE) combines both sources of error:</p>
<p><span class="math display">\[MSE = Bias^2 + Variance\]</span></p>
</section>
<section id="the-bootstrap-resampling-for-estimation" class="level2" data-number="10.11">
<h2 data-number="10.11" class="anchored" data-anchor-id="the-bootstrap-resampling-for-estimation"><span class="header-section-number">10.11</span> The Bootstrap: Resampling for Estimation</h2>
<p>The bootstrap, introduced by Bradley Efron in 1979, is a powerful resampling method for estimating standard errors and constructing confidence intervals when analytical formulas are unavailable or assumptions are questionable <span class="citation" data-cites="efron1979bootstrap">(<a href="../references.html#ref-efron1979bootstrap" role="doc-biblioref">Efron 1979</a>)</span>.</p>
<p>The key insight is elegant: we can estimate the sampling distribution of a statistic by repeatedly resampling from our observed data. If our sample is representative of the population, then samples drawn from our sample (with replacement) should behave like samples drawn from the population.</p>
<section id="the-bootstrap-algorithm" class="level3" data-number="10.11.1">
<h3 data-number="10.11.1" class="anchored" data-anchor-id="the-bootstrap-algorithm"><span class="header-section-number">10.11.1</span> The Bootstrap Algorithm</h3>
<ol type="1">
<li>Take a random sample with replacement from your data (same size as original)</li>
<li>Calculate the statistic of interest on this resampled data</li>
<li>Repeat steps 1-2 many times (typically 1000-10000)</li>
<li>The distribution of bootstrap statistics approximates the sampling distribution</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap estimation of the sampling distribution of the mean</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Our observed sample</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>original_sample <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">23</span>, <span class="dv">31</span>, <span class="dv">28</span>, <span class="dv">35</span>, <span class="dv">42</span>, <span class="dv">29</span>, <span class="dv">33</span>, <span class="dv">27</span>, <span class="dv">38</span>, <span class="dv">31</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(original_sample)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap: resample with replacement</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>n_bootstrap <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>bootstrap_means <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_bootstrap)</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_bootstrap) {</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  boot_sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(original_sample, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  bootstrap_means[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_sample)</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare bootstrap distribution to observed statistics</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bootstrap_means, <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Bootstrap Distribution of the Mean"</span>,</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Sample Mean"</span>)</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(original_sample), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">quantile</span>(bootstrap_means, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)), <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="10-sampling-estimation_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Original sample mean:"</span>, <span class="fu">mean</span>(original_sample), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Original sample mean: 31.7 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Bootstrap SE:"</span>, <span class="fu">sd</span>(bootstrap_means), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Bootstrap SE: 1.635207 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% Bootstrap CI:"</span>, <span class="fu">quantile</span>(bootstrap_means, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>95% Bootstrap CI: 28.7 35.0025 </code></pre>
</div>
</div>
</section>
<section id="bootstrap-confidence-intervals" class="level3" data-number="10.11.2">
<h3 data-number="10.11.2" class="anchored" data-anchor-id="bootstrap-confidence-intervals"><span class="header-section-number">10.11.2</span> Bootstrap Confidence Intervals</h3>
<p>The bootstrap provides several methods for constructing confidence intervals:</p>
<p><strong>Percentile method</strong>: Use the 2.5th and 97.5th percentiles of the bootstrap distribution as the 95% CI bounds. This is the simplest approach shown above.</p>
<p><strong>Basic (reverse percentile) method</strong>: Reflects the percentiles around the original estimate to correct for certain types of bias.</p>
<p><strong>BCa (bias-corrected and accelerated)</strong>: A more sophisticated method that adjusts for both bias and skewness in the bootstrap distribution. This is often preferred when the sampling distribution is not symmetric.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the boot package for more sophisticated bootstrap CI</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define statistic function</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>mean_stat <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(data[indices])</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Run bootstrap</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>boot_result <span class="ot">&lt;-</span> <span class="fu">boot</span>(original_sample, mean_stat, <span class="at">R =</span> <span class="dv">5000</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Different CI methods</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(boot_result, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"perc"</span>, <span class="st">"basic"</span>, <span class="st">"bca"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
Based on 5000 bootstrap replicates

CALL : 
boot.ci(boot.out = boot_result, type = c("perc", "basic", "bca"))

Intervals : 
Level      Basic              Percentile            BCa          
95%   (28.3, 34.9 )   (28.5, 35.1 )   (28.5, 35.1 )  
Calculations and Intervals on Original Scale</code></pre>
</div>
</div>
</section>
<section id="when-to-use-the-bootstrap" class="level3" data-number="10.11.3">
<h3 data-number="10.11.3" class="anchored" data-anchor-id="when-to-use-the-bootstrap"><span class="header-section-number">10.11.3</span> When to Use the Bootstrap</h3>
<p>The bootstrap is particularly valuable when:</p>
<ul>
<li>The sampling distribution of your statistic is unknown or complex</li>
<li>Sample sizes are small and normality assumptions are questionable</li>
<li>You are estimating something other than a mean (e.g., median, correlation, regression coefficients)</li>
<li>Analytical formulas for standard errors do not exist</li>
</ul>
<p>However, the bootstrap has limitations. It assumes your sample is representative of the population and works poorly with very small samples (n &lt; 10-15) or when estimating extreme quantiles.</p>
</section>
</section>
<section id="maximum-likelihood-estimation" class="level2" data-number="10.12">
<h2 data-number="10.12" class="anchored" data-anchor-id="maximum-likelihood-estimation"><span class="header-section-number">10.12</span> Maximum Likelihood Estimation</h2>
<p><strong>Maximum likelihood estimation (MLE)</strong> provides a principled framework for parameter estimation. The likelihood function measures how probable the observed data would be for different parameter values. MLE finds the parameter values that make the observed data most probable.</p>
<p>For a sample <span class="math inline">\(x_1, x_2, \ldots, x_n\)</span> from a distribution with parameter <span class="math inline">\(\theta\)</span>, the likelihood function is:</p>
<p><span class="math display">\[L(\theta | x_1, \ldots, x_n) = \prod_{i=1}^{n} f(x_i | \theta)\]</span></p>
<p>where <span class="math inline">\(f(x_i | \theta)\)</span> is the probability density (or mass) function. We typically work with the log-likelihood for computational convenience:</p>
<p><span class="math display">\[\ell(\theta) = \sum_{i=1}^{n} \log f(x_i | \theta)\]</span></p>
<p>The MLE <span class="math inline">\(\hat{\theta}\)</span> is the value that maximizes <span class="math inline">\(\ell(\theta)\)</span>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MLE example: estimating the rate parameter of an exponential distribution</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>exp_data <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">100</span>, <span class="at">rate =</span> <span class="fl">0.5</span>)  <span class="co"># True rate is 0.5</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Log-likelihood function for exponential</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>log_likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(rate, data) {</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">dexp</span>(data, <span class="at">rate =</span> rate, <span class="at">log =</span> <span class="cn">TRUE</span>))</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Find MLE</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>rates <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>ll_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(rates, log_likelihood, <span class="at">data =</span> exp_data)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot likelihood surface</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rates, ll_values, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Rate parameter"</span>, <span class="at">ylab =</span> <span class="st">"Log-likelihood"</span>,</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Log-likelihood for Exponential Rate"</span>)</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(exp_data), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)  <span class="co"># MLE = 1/mean for exponential</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="10-sampling-estimation_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"True rate: 0.5</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>True rate: 0.5</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"MLE estimate:"</span>, <span class="fu">round</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(exp_data), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>MLE estimate: 0.445 </code></pre>
</div>
</div>
<p>MLEs have desirable properties: they are consistent (converge to true values as n increases) and asymptotically efficient (achieve the smallest possible variance for large samples).</p>
</section>
<section id="simulation-based-understanding-of-estimation" class="level2" data-number="10.13">
<h2 data-number="10.13" class="anchored" data-anchor-id="simulation-based-understanding-of-estimation"><span class="header-section-number">10.13</span> Simulation-Based Understanding of Estimation</h2>
<p>Simulation provides powerful intuition for statistical concepts. By repeatedly sampling from known populations, we can directly observe sampling distributions.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exploring properties of estimators through simulation</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># True population parameters</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>pop_mean <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>pop_sd <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate many samples and compute estimates</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">50</span>)</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> sample_sizes) {</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Collect sample means</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>  sample_means <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_samples, {</span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>    samp <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> pop_mean, <span class="at">sd =</span> pop_sd)</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(samp)</span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot distribution of sample means</span></span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(sample_means, <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Sample Means (n ="</span>, n, <span class="st">")"</span>),</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Sample Mean"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">35</span>, <span class="dv">65</span>))</span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> pop_mean, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate actual SE vs theoretical</span></span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>  actual_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(sample_means)</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>  theoretical_se <span class="ot">&lt;-</span> pop_sd <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">"Actual SE:"</span>, <span class="fu">round</span>(actual_se, <span class="dv">2</span>)),</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">paste</span>(<span class="st">"Theoretical:"</span>, <span class="fu">round</span>(theoretical_se, <span class="dv">2</span>))))</span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Now do the same for sample standard deviations</span></span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> sample_sizes) {</span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Collect sample SDs</span></span>
<span id="cb46-39"><a href="#cb46-39" aria-hidden="true" tabindex="-1"></a>  sample_sds <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_samples, {</span>
<span id="cb46-40"><a href="#cb46-40" aria-hidden="true" tabindex="-1"></a>    samp <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> pop_mean, <span class="at">sd =</span> pop_sd)</span>
<span id="cb46-41"><a href="#cb46-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(samp)</span>
<span id="cb46-42"><a href="#cb46-42" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb46-43"><a href="#cb46-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-44"><a href="#cb46-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(sample_sds, <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">col =</span> <span class="st">"coral"</span>,</span>
<span id="cb46-45"><a href="#cb46-45" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Sample SDs (n ="</span>, n, <span class="st">")"</span>),</span>
<span id="cb46-46"><a href="#cb46-46" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Sample SD"</span>)</span>
<span id="cb46-47"><a href="#cb46-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> pop_sd, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb46-48"><a href="#cb46-48" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="10-sampling-estimation_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="864"></p>
</figure>
</div>
</div>
</div>
<p>This simulation reveals several important facts: 1. Sample means are unbiased (centered on the population mean) 2. The spread of sample means decreases as <span class="math inline">\(\sqrt{n}\)</span> 3. Sample standard deviations are slightly biased for small samples but become unbiased as n increases</p>
</section>
<section id="principles-of-experimental-design" class="level2" data-number="10.14">
<h2 data-number="10.14" class="anchored" data-anchor-id="principles-of-experimental-design"><span class="header-section-number">10.14</span> Principles of Experimental Design</h2>
<p>Good statistical analysis cannot rescue a poorly designed study. The way you collect data fundamentally determines what conclusions you can draw. Understanding key design principles is essential for planning experiments that yield valid, interpretable results.</p>
<section id="randomization" class="level3" data-number="10.14.1">
<h3 data-number="10.14.1" class="anchored" data-anchor-id="randomization"><span class="header-section-number">10.14.1</span> Randomization</h3>
<p><strong>Randomization</strong> assigns subjects to treatment groups by chance, ensuring that treatment groups are comparable. Without randomization, systematic differences between groups (confounders) can bias results.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomly assign 20 subjects to treatment or control</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>subjects <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>treatment_group <span class="ot">&lt;-</span> <span class="fu">sample</span>(subjects, <span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>control_group <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(subjects, treatment_group)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Treatment group:"</span>, treatment_group, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Treatment group: 17 5 1 10 4 2 20 18 8 7 </code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Control group:"</span>, control_group, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Control group: 3 6 9 11 12 13 14 15 16 19 </code></pre>
</div>
</div>
<p>Randomization provides the foundation for causal inference. Without it, we can only establish associations, not causation.</p>
</section>
<section id="controls" class="level3" data-number="10.14.2">
<h3 data-number="10.14.2" class="anchored" data-anchor-id="controls"><span class="header-section-number">10.14.2</span> Controls</h3>
<p>Every experiment needs <strong>controls</strong>—groups that differ from treatment groups only in the variable of interest:</p>
<ul>
<li><strong>Negative control</strong>: Receives no treatment; establishes baseline</li>
<li><strong>Positive control</strong>: Receives a treatment known to work; confirms the experimental system is functioning</li>
<li><strong>Procedural control</strong>: Receives all procedures except the active ingredient (e.g., sham surgery, vehicle-only injection)</li>
</ul>
<p>Without proper controls, you cannot determine whether observed effects are due to your treatment or some other factor.</p>
</section>
<section id="blinding" class="level3" data-number="10.14.3">
<h3 data-number="10.14.3" class="anchored" data-anchor-id="blinding"><span class="header-section-number">10.14.3</span> Blinding</h3>
<p><strong>Blinding</strong> prevents knowledge of group assignment from influencing results:</p>
<ul>
<li><strong>Single-blind</strong>: Subjects do not know which treatment they receive</li>
<li><strong>Double-blind</strong>: Neither subjects nor experimenters know group assignments</li>
<li><strong>Triple-blind</strong>: Subjects, experimenters, and data analysts are all blinded</li>
</ul>
<p>Blinding prevents both placebo effects (subjects’ expectations influencing outcomes) and experimenter bias (conscious or unconscious influence on measurements).</p>
</section>
<section id="replication" class="level3" data-number="10.14.4">
<h3 data-number="10.14.4" class="anchored" data-anchor-id="replication"><span class="header-section-number">10.14.4</span> Replication</h3>
<p><strong>Replication</strong> means having multiple independent observations in each treatment group. Replication is essential because it:</p>
<ul>
<li>Provides estimates of variability</li>
<li>Enables statistical inference</li>
<li>Increases precision of estimates</li>
<li>Allows detection of real effects</li>
</ul>
<p>The <strong>unit of replication</strong> must match the <strong>unit of treatment</strong>. If you treat tanks with different water temperatures and measure multiple fish per tank, your replicates are tanks, not fish.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Technical vs.&nbsp;Biological Replicates
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Technical replicates</strong>: Repeated measurements of the same sample (e.g., running the same sample through a machine twice)</li>
<li><strong>Biological replicates</strong>: Independent samples from different individuals or experimental units</li>
</ul>
<p>Technical replicates measure precision of the measurement process. Biological replicates measure biological variability and enable inference to the population. Do not confuse them!</p>
</div>
</div>
</section>
<section id="blocking" class="level3" data-number="10.14.5">
<h3 data-number="10.14.5" class="anchored" data-anchor-id="blocking"><span class="header-section-number">10.14.5</span> Blocking</h3>
<p><strong>Blocking</strong> groups experimental units that are similar to each other, then applies all treatments within each block. This reduces variability by accounting for known sources of heterogeneity.</p>
<p>Common blocking factors: - Time (experimental batches, days) - Location (different incubators, growth chambers) - Individual (paired designs, repeated measures)</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomized complete block design</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 4 treatments applied within each of 3 blocks</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>blocks <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>treatments <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">Block =</span> blocks, <span class="at">Treatment =</span> treatments)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>design<span class="sc">$</span>Order <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> blocks) {</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  block_rows <span class="ot">&lt;-</span> design<span class="sc">$</span>Block <span class="sc">==</span> b</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  design<span class="sc">$</span>Order[block_rows] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>design[<span class="fu">order</span>(design<span class="sc">$</span>Block, design<span class="sc">$</span>Order), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Block Treatment Order
7      1         C     1
10     1         D     2
1      1         A     3
4      1         B     4
11     2         D     1
5      2         B     2
2      2         A     3
8      2         C     4
6      3         B     1
9      3         C     2
3      3         A     3
12     3         D     4</code></pre>
</div>
</div>
<p>Blocking is particularly valuable when blocks correspond to major sources of variation (e.g., different labs, experimental days, genetic backgrounds).</p>
</section>
<section id="sample-size-considerations" class="level3" data-number="10.14.6">
<h3 data-number="10.14.6" class="anchored" data-anchor-id="sample-size-considerations"><span class="header-section-number">10.14.6</span> Sample Size Considerations</h3>
<p>Determining appropriate sample size before collecting data is crucial. Too few samples waste resources by producing inconclusive results; too many waste resources by studying effects that were detectable with smaller samples.</p>
<p>Sample size depends on: - <strong>Effect size</strong>: The minimum meaningful difference you want to detect - <strong>Variability</strong>: The expected noise in your measurements - <strong>Significance level (<span class="math inline">\(\alpha\)</span>)</strong>: Usually 0.05 - <strong>Power</strong>: Usually 0.80 (80% chance of detecting a real effect)</p>
<p>Power analysis (covered in detail in a later chapter) formalizes these considerations.</p>
</section>
</section>
<section id="key-takeaways" class="level2" data-number="10.15">
<h2 data-number="10.15" class="anchored" data-anchor-id="key-takeaways"><span class="header-section-number">10.15</span> Key Takeaways</h2>
<p>Understanding sampling distributions and estimation is fundamental to statistical inference. Key points to remember:</p>
<ol type="1">
<li>Statistics vary from sample to sample; this variability is quantified by the standard error</li>
<li>Larger samples give more precise estimates (smaller standard errors)</li>
<li>Confidence intervals quantify uncertainty about parameter estimates</li>
<li>The Central Limit Theorem explains why the normal distribution appears so frequently</li>
<li>Both bias and variability affect the quality of estimates</li>
<li>The bootstrap provides a flexible, computer-intensive approach to estimation when analytical methods are limited</li>
<li>Maximum likelihood provides a principled framework for parameter estimation</li>
<li>Good experimental design—randomization, controls, blinding, proper replication—is essential for valid inference</li>
</ol>
<p>These concepts provide the foundation for hypothesis testing and the statistical inference methods we develop in subsequent chapters.</p>
</section>
<section id="additional-resources" class="level2" data-number="10.16">
<h2 data-number="10.16" class="anchored" data-anchor-id="additional-resources"><span class="header-section-number">10.16</span> Additional Resources</h2>
<ul>
<li><span class="citation" data-cites="efron1979bootstrap">Efron (<a href="../references.html#ref-efron1979bootstrap" role="doc-biblioref">1979</a>)</span> - The original bootstrap paper, a landmark in modern statistics</li>
<li><span class="citation" data-cites="irizarry2019introduction">Irizarry (<a href="../references.html#ref-irizarry2019introduction" role="doc-biblioref">2019</a>)</span> - Excellent chapters on sampling and estimation with R examples</li>
</ul>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-efron1979bootstrap" class="csl-entry" role="listitem">
Efron, Bradley. 1979. <span>“Bootstrap Methods: Another Look at the Jackknife.”</span> <em>The Annals of Statistics</em> 7 (1): 1–26.
</div>
<div id="ref-irizarry2019introduction" class="csl-entry" role="listitem">
Irizarry, Rafael A. 2019. <em>Introduction to Data Science</em>. Self-published. <a href="https://rafalab.github.io/dsbook/">https://rafalab.github.io/dsbook/</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/09-continuous-distributions.html" class="pagination-link" aria-label="Continuous Probability Distributions">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Continuous Probability Distributions</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/11-hypothesis-testing.html" class="pagination-link" aria-label="Hypothesis Testing">
        <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb53" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Sampling and Parameter Estimation {#sec-sampling-estimation}</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Problem of Inference</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>Science often works by measuring samples to learn about populations. We cannot measure every protein in a cell, every patient with a disease, or every fish in the ocean. Instead, we take samples and use statistical inference to draw conclusions about the larger populations from which they came.</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>This creates a fundamental challenge: sample statistics vary from sample to sample, even when samples come from the same population. If you take two different random samples from a population and calculate their means, you will almost certainly get two different values. How, then, can we say anything reliable about the population?</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>The answer lies in understanding the sampling distribution—the distribution of a statistic across all possible samples of a given size.</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="fu">## Parameters and Statistics</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>A **parameter** is a numerical characteristic of a population—the true population mean $\mu$, the true population standard deviation $\sigma$, the true proportion $p$. Parameters are typically fixed but unknown.</span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>A **statistic** is a numerical characteristic of a sample—the sample mean $\bar{x}$, the sample standard deviation $s$, the sample proportion $\hat{p}$. Statistics are calculated from data and vary from sample to sample.</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>We use statistics to estimate parameters. The sample mean $\bar{x}$ estimates the population mean $\mu$. The sample standard deviation $s$ estimates the population standard deviation $\sigma$. These estimates will rarely equal the true parameter values exactly, but we can quantify how close they are likely to be.</span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a><span class="fu">## Point Estimates</span></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>A **point estimate** is a single number used as our best guess for a parameter. The sample mean is a natural point estimate for the population mean:</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>$$\bar{x} = \frac{1}{n} \sum_{i=1}^{n} x_i$$</span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a>What makes a good estimator? Ideally, an estimator should be:</span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>**Unbiased**: On average, across many samples, the estimator equals the true parameter. The sample mean is an unbiased estimator of the population mean.</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>**Efficient**: Among unbiased estimators, it has the smallest variance. The sample mean is the most efficient estimator of a normal mean.</span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a>**Consistent**: As sample size increases, the estimator converges to the true parameter value.</span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Sampling Distribution of the Mean</span></span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a>Imagine drawing all possible samples of size $n$ from a population and calculating the mean of each. The distribution of these means is the sampling distribution of the mean.</span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a>The sampling distribution has remarkable properties:</span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Its mean equals the population mean: $E<span class="co">[</span><span class="ot">\bar{X}</span><span class="co">]</span> = \mu$</span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Its standard deviation (the **standard error**) equals: $SE = \frac{\sigma}{\sqrt{n}}$</span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>For large samples, it is approximately normal (Central Limit Theorem)</span>
<span id="cb53-51"><a href="#cb53-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-54"><a href="#cb53-54" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-55"><a href="#cb53-55" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb53-56"><a href="#cb53-56" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb53-57"><a href="#cb53-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstrate sampling distribution</span></span>
<span id="cb53-58"><a href="#cb53-58" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">32</span>)</span>
<span id="cb53-59"><a href="#cb53-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-60"><a href="#cb53-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a population</span></span>
<span id="cb53-61"><a href="#cb53-61" aria-hidden="true" tabindex="-1"></a>true_pop <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n =</span> <span class="dv">10000</span>, <span class="at">lambda =</span> <span class="dv">3</span>)</span>
<span id="cb53-62"><a href="#cb53-62" aria-hidden="true" tabindex="-1"></a>pop_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(true_pop)</span>
<span id="cb53-63"><a href="#cb53-63" aria-hidden="true" tabindex="-1"></a>pop_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(true_pop)</span>
<span id="cb53-64"><a href="#cb53-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-65"><a href="#cb53-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Take many samples and compute their means</span></span>
<span id="cb53-66"><a href="#cb53-66" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">200</span>)</span>
<span id="cb53-67"><a href="#cb53-67" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb53-68"><a href="#cb53-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-69"><a href="#cb53-69" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> sample_sizes) {</span>
<span id="cb53-70"><a href="#cb53-70" aria-hidden="true" tabindex="-1"></a>  sample_means <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">mean</span>(<span class="fu">sample</span>(true_pop, n)))</span>
<span id="cb53-71"><a href="#cb53-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(sample_means, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"n ="</span>, n),</span>
<span id="cb53-72"><a href="#cb53-72" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Sample Mean"</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb53-73"><a href="#cb53-73" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>))</span>
<span id="cb53-74"><a href="#cb53-74" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> pop_mean, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb53-75"><a href="#cb53-75" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-76"><a href="#cb53-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-77"><a href="#cb53-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-78"><a href="#cb53-78" aria-hidden="true" tabindex="-1"></a>As sample size increases, the sampling distribution becomes narrower (smaller standard error) and more normal in shape. This is why larger samples give more precise estimates.</span>
<span id="cb53-79"><a href="#cb53-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-80"><a href="#cb53-80" aria-hidden="true" tabindex="-1"></a><span class="fu">## Standard Error</span></span>
<span id="cb53-81"><a href="#cb53-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-82"><a href="#cb53-82" aria-hidden="true" tabindex="-1"></a>The **standard error** (SE) measures the variability of a statistic across samples. For the sample mean:</span>
<span id="cb53-83"><a href="#cb53-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-84"><a href="#cb53-84" aria-hidden="true" tabindex="-1"></a>$$SE_{\bar{x}} = \frac{\sigma}{\sqrt{n}}$$</span>
<span id="cb53-85"><a href="#cb53-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-86"><a href="#cb53-86" aria-hidden="true" tabindex="-1"></a>Since we usually do not know $\sigma$, we estimate the standard error using the sample standard deviation:</span>
<span id="cb53-87"><a href="#cb53-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-88"><a href="#cb53-88" aria-hidden="true" tabindex="-1"></a>$$\widehat{SE}_{\bar{x}} = \frac{s}{\sqrt{n}}$$</span>
<span id="cb53-89"><a href="#cb53-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-90"><a href="#cb53-90" aria-hidden="true" tabindex="-1"></a>The standard error shrinks as sample size increases, but following a square root relationship. To halve the standard error, you need to quadruple the sample size.</span>
<span id="cb53-91"><a href="#cb53-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-94"><a href="#cb53-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-95"><a href="#cb53-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstrate how SE changes with sample size</span></span>
<span id="cb53-96"><a href="#cb53-96" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">32</span>)</span>
<span id="cb53-97"><a href="#cb53-97" aria-hidden="true" tabindex="-1"></a>true_pop <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">lambda =</span> <span class="dv">5</span>)</span>
<span id="cb53-98"><a href="#cb53-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-99"><a href="#cb53-99" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample size of 5</span></span>
<span id="cb53-100"><a href="#cb53-100" aria-hidden="true" tabindex="-1"></a>samps_5 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="fu">sample</span>(true_pop, <span class="at">size =</span> <span class="dv">5</span>))</span>
<span id="cb53-101"><a href="#cb53-101" aria-hidden="true" tabindex="-1"></a>means_5 <span class="ot">&lt;-</span> <span class="fu">apply</span>(samps_5, <span class="dv">2</span>, mean)</span>
<span id="cb53-102"><a href="#cb53-102" aria-hidden="true" tabindex="-1"></a>se_5 <span class="ot">&lt;-</span> <span class="fu">sd</span>(means_5)</span>
<span id="cb53-103"><a href="#cb53-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-104"><a href="#cb53-104" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample size of 50</span></span>
<span id="cb53-105"><a href="#cb53-105" aria-hidden="true" tabindex="-1"></a>samps_50 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">50</span>, <span class="fu">sample</span>(true_pop, <span class="at">size =</span> <span class="dv">50</span>))</span>
<span id="cb53-106"><a href="#cb53-106" aria-hidden="true" tabindex="-1"></a>means_50 <span class="ot">&lt;-</span> <span class="fu">apply</span>(samps_50, <span class="dv">2</span>, mean)</span>
<span id="cb53-107"><a href="#cb53-107" aria-hidden="true" tabindex="-1"></a>se_50 <span class="ot">&lt;-</span> <span class="fu">sd</span>(means_50)</span>
<span id="cb53-108"><a href="#cb53-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-109"><a href="#cb53-109" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Standard error with n=5:"</span>, <span class="fu">round</span>(se_5, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-110"><a href="#cb53-110" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Standard error with n=50:"</span>, <span class="fu">round</span>(se_50, <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-111"><a href="#cb53-111" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Ratio:"</span>, <span class="fu">round</span>(se_5<span class="sc">/</span>se_50, <span class="dv">2</span>), <span class="st">"(theoretical: √10 ="</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="dv">10</span>), <span class="dv">2</span>), <span class="st">")</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-112"><a href="#cb53-112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-113"><a href="#cb53-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-114"><a href="#cb53-114" aria-hidden="true" tabindex="-1"></a><span class="al">![](../images/week_2.026.jpeg)</span>{fig-align="center"}</span>
<span id="cb53-115"><a href="#cb53-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-116"><a href="#cb53-116" aria-hidden="true" tabindex="-1"></a><span class="fu">## Confidence Intervals</span></span>
<span id="cb53-117"><a href="#cb53-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-118"><a href="#cb53-118" aria-hidden="true" tabindex="-1"></a>A point estimate tells us our best guess, but not how uncertain we are. A **confidence interval** provides a range of plausible values for the parameter along with a measure of confidence.</span>
<span id="cb53-119"><a href="#cb53-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-120"><a href="#cb53-120" aria-hidden="true" tabindex="-1"></a>A 95% confidence interval for the population mean, when the population is normally distributed or the sample is large, is:</span>
<span id="cb53-121"><a href="#cb53-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-122"><a href="#cb53-122" aria-hidden="true" tabindex="-1"></a>$$\bar{x} \pm t_{\alpha/2} \times \frac{s}{\sqrt{n}}$$</span>
<span id="cb53-123"><a href="#cb53-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-124"><a href="#cb53-124" aria-hidden="true" tabindex="-1"></a>where $t_{\alpha/2}$ is the critical value from the t-distribution with $n-1$ degrees of freedom.</span>
<span id="cb53-125"><a href="#cb53-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-126"><a href="#cb53-126" aria-hidden="true" tabindex="-1"></a><span class="al">![](../images/week_2.027.jpeg)</span>{fig-align="center"}</span>
<span id="cb53-127"><a href="#cb53-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-128"><a href="#cb53-128" aria-hidden="true" tabindex="-1"></a>The interpretation requires care: a 95% confidence interval means that if we repeated this procedure many times, 95% of the resulting intervals would contain the true parameter. Any particular interval either does or does not contain the true value—we just don't know which.</span>
<span id="cb53-129"><a href="#cb53-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-132"><a href="#cb53-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-133"><a href="#cb53-133" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate a confidence interval</span></span>
<span id="cb53-134"><a href="#cb53-134" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb53-135"><a href="#cb53-135" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>)</span>
<span id="cb53-136"><a href="#cb53-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-137"><a href="#cb53-137" aria-hidden="true" tabindex="-1"></a>sample_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(sample_data)</span>
<span id="cb53-138"><a href="#cb53-138" aria-hidden="true" tabindex="-1"></a>sample_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(sample_data) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(sample_data))</span>
<span id="cb53-139"><a href="#cb53-139" aria-hidden="true" tabindex="-1"></a>t_crit <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df =</span> <span class="fu">length</span>(sample_data) <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb53-140"><a href="#cb53-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-141"><a href="#cb53-141" aria-hidden="true" tabindex="-1"></a>lower <span class="ot">&lt;-</span> sample_mean <span class="sc">-</span> t_crit <span class="sc">*</span> sample_se</span>
<span id="cb53-142"><a href="#cb53-142" aria-hidden="true" tabindex="-1"></a>upper <span class="ot">&lt;-</span> sample_mean <span class="sc">+</span> t_crit <span class="sc">*</span> sample_se</span>
<span id="cb53-143"><a href="#cb53-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-144"><a href="#cb53-144" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Sample mean:"</span>, <span class="fu">round</span>(sample_mean, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-145"><a href="#cb53-145" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI: ["</span>, <span class="fu">round</span>(lower, <span class="dv">2</span>), <span class="st">","</span>, <span class="fu">round</span>(upper, <span class="dv">2</span>), <span class="st">"]</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-146"><a href="#cb53-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-147"><a href="#cb53-147" aria-hidden="true" tabindex="-1"></a><span class="co"># Or use t.test directly</span></span>
<span id="cb53-148"><a href="#cb53-148" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sample_data)<span class="sc">$</span>conf.int</span>
<span id="cb53-149"><a href="#cb53-149" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-150"><a href="#cb53-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-151"><a href="#cb53-151" aria-hidden="true" tabindex="-1"></a><span class="al">![](../images/week_2.028.jpeg)</span>{fig-align="center"}</span>
<span id="cb53-152"><a href="#cb53-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-153"><a href="#cb53-153" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Central Limit Theorem in Practice</span></span>
<span id="cb53-154"><a href="#cb53-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-155"><a href="#cb53-155" aria-hidden="true" tabindex="-1"></a>The Central Limit Theorem (CLT) is one of the most remarkable results in statistics. It states that the sampling distribution of the mean approaches a normal distribution as sample size increases, regardless of the shape of the underlying population distribution.</span>
<span id="cb53-156"><a href="#cb53-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-157"><a href="#cb53-157" aria-hidden="true" tabindex="-1"></a>This is why confidence intervals work. This is why the normal distribution appears everywhere in statistics. And understanding the CLT in practice—through examples like polling and surveys—builds deep intuition for statistical inference.</span>
<span id="cb53-158"><a href="#cb53-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-159"><a href="#cb53-159" aria-hidden="true" tabindex="-1"></a><span class="fu">### The CLT Demonstrated</span></span>
<span id="cb53-160"><a href="#cb53-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-161"><a href="#cb53-161" aria-hidden="true" tabindex="-1"></a>Let's see the CLT in action with a highly non-normal distribution. We'll sample from an exponential distribution (heavily right-skewed) and watch how the sampling distribution of the mean becomes normal:</span>
<span id="cb53-162"><a href="#cb53-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-165"><a href="#cb53-165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-166"><a href="#cb53-166" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb53-167"><a href="#cb53-167" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 7</span></span>
<span id="cb53-168"><a href="#cb53-168" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb53-169"><a href="#cb53-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-170"><a href="#cb53-170" aria-hidden="true" tabindex="-1"></a><span class="co"># Exponential distribution (very skewed)</span></span>
<span id="cb53-171"><a href="#cb53-171" aria-hidden="true" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb53-172"><a href="#cb53-172" aria-hidden="true" tabindex="-1"></a>pop_mean <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>rate  <span class="co"># True mean = 2</span></span>
<span id="cb53-173"><a href="#cb53-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-174"><a href="#cb53-174" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb53-175"><a href="#cb53-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-176"><a href="#cb53-176" aria-hidden="true" tabindex="-1"></a><span class="co"># Original population</span></span>
<span id="cb53-177"><a href="#cb53-177" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">10000</span>, <span class="at">rate =</span> rate)</span>
<span id="cb53-178"><a href="#cb53-178" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">main =</span> <span class="st">"Original Distribution (Exponential)"</span>,</span>
<span id="cb53-179"><a href="#cb53-179" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">col =</span> <span class="st">"gray80"</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-180"><a href="#cb53-180" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dexp</span>(x, <span class="at">rate =</span> rate), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb53-181"><a href="#cb53-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-182"><a href="#cb53-182" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample means for different n</span></span>
<span id="cb53-183"><a href="#cb53-183" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">30</span>, <span class="dv">100</span>)) {</span>
<span id="cb53-184"><a href="#cb53-184" aria-hidden="true" tabindex="-1"></a>  sample_means <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">5000</span>, <span class="fu">mean</span>(<span class="fu">rexp</span>(n, <span class="at">rate =</span> rate)))</span>
<span id="cb53-185"><a href="#cb53-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(sample_means, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>,</span>
<span id="cb53-186"><a href="#cb53-186" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Sampling Distribution (n ="</span>, n, <span class="st">")"</span>),</span>
<span id="cb53-187"><a href="#cb53-187" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Sample Mean"</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>)</span>
<span id="cb53-188"><a href="#cb53-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-189"><a href="#cb53-189" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Overlay normal curve with theoretical SE</span></span>
<span id="cb53-190"><a href="#cb53-190" aria-hidden="true" tabindex="-1"></a>  theoretical_se <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span>rate) <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb53-191"><a href="#cb53-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean =</span> pop_mean, <span class="at">sd =</span> theoretical_se),</span>
<span id="cb53-192"><a href="#cb53-192" aria-hidden="true" tabindex="-1"></a>        <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb53-193"><a href="#cb53-193" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-194"><a href="#cb53-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-195"><a href="#cb53-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-196"><a href="#cb53-196" aria-hidden="true" tabindex="-1"></a>Even with n = 30, the sampling distribution of the mean is remarkably close to normal, despite the exponential distribution being extremely skewed. By n = 100, the approximation is nearly perfect.</span>
<span id="cb53-197"><a href="#cb53-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-198"><a href="#cb53-198" aria-hidden="true" tabindex="-1"></a><span class="fu">### Margin of Error: Quantifying Precision</span></span>
<span id="cb53-199"><a href="#cb53-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-200"><a href="#cb53-200" aria-hidden="true" tabindex="-1"></a>The **margin of error** (MOE) is a practical expression of sampling uncertainty. For a confidence interval around a proportion or mean, the margin of error is the half-width of the interval:</span>
<span id="cb53-201"><a href="#cb53-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-202"><a href="#cb53-202" aria-hidden="true" tabindex="-1"></a>$$\text{Margin of Error} = z^* \times SE$$</span>
<span id="cb53-203"><a href="#cb53-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-204"><a href="#cb53-204" aria-hidden="true" tabindex="-1"></a>For a 95% confidence interval, $z^* \approx 1.96 \approx 2$, giving us the approximation:</span>
<span id="cb53-205"><a href="#cb53-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-206"><a href="#cb53-206" aria-hidden="true" tabindex="-1"></a>$$\text{95% MOE} \approx 2 \times SE$$</span>
<span id="cb53-207"><a href="#cb53-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-208"><a href="#cb53-208" aria-hidden="true" tabindex="-1"></a>For proportions, the standard error is $SE = \sqrt{\frac{p(1-p)}{n}}$, so:</span>
<span id="cb53-209"><a href="#cb53-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-210"><a href="#cb53-210" aria-hidden="true" tabindex="-1"></a>$$\text{95% MOE} \approx 2 \times \sqrt{\frac{p(1-p)}{n}}$$</span>
<span id="cb53-211"><a href="#cb53-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-212"><a href="#cb53-212" aria-hidden="true" tabindex="-1"></a>The maximum standard error for a proportion occurs when $p = 0.5$, giving the conservative formula used in sample size planning:</span>
<span id="cb53-213"><a href="#cb53-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-214"><a href="#cb53-214" aria-hidden="true" tabindex="-1"></a>$$\text{Maximum 95% MOE} \approx \frac{1}{\sqrt{n}}$$</span>
<span id="cb53-215"><a href="#cb53-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-216"><a href="#cb53-216" aria-hidden="true" tabindex="-1"></a><span class="fu">### Polling as a Statistical Inference Problem</span></span>
<span id="cb53-217"><a href="#cb53-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-218"><a href="#cb53-218" aria-hidden="true" tabindex="-1"></a>Political polling provides an excellent practical example of sampling and the CLT. When a poll reports "48% of voters support Candidate A, with a margin of error of ±3%," they are making a statistical inference from a sample to a population.</span>
<span id="cb53-219"><a href="#cb53-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-220"><a href="#cb53-220" aria-hidden="true" tabindex="-1"></a>Let's simulate an election poll:</span>
<span id="cb53-221"><a href="#cb53-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-224"><a href="#cb53-224" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-225"><a href="#cb53-225" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb53-226"><a href="#cb53-226" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb53-227"><a href="#cb53-227" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb53-228"><a href="#cb53-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-229"><a href="#cb53-229" aria-hidden="true" tabindex="-1"></a><span class="co"># True population proportion (unknown in real life)</span></span>
<span id="cb53-230"><a href="#cb53-230" aria-hidden="true" tabindex="-1"></a>true_proportion <span class="ot">&lt;-</span> <span class="fl">0.52</span>  <span class="co"># 52% actually support the candidate</span></span>
<span id="cb53-231"><a href="#cb53-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-232"><a href="#cb53-232" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate a poll of 1000 likely voters</span></span>
<span id="cb53-233"><a href="#cb53-233" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb53-234"><a href="#cb53-234" aria-hidden="true" tabindex="-1"></a>poll_sample <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">prob =</span> true_proportion) <span class="sc">/</span> n</span>
<span id="cb53-235"><a href="#cb53-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-236"><a href="#cb53-236" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate margin of error</span></span>
<span id="cb53-237"><a href="#cb53-237" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(poll_sample <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> poll_sample) <span class="sc">/</span> n)</span>
<span id="cb53-238"><a href="#cb53-238" aria-hidden="true" tabindex="-1"></a>moe <span class="ot">&lt;-</span> <span class="fl">1.96</span> <span class="sc">*</span> se</span>
<span id="cb53-239"><a href="#cb53-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-240"><a href="#cb53-240" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Poll result:"</span>, <span class="fu">round</span>(poll_sample <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-241"><a href="#cb53-241" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Margin of error: ±"</span>, <span class="fu">round</span>(moe <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-242"><a href="#cb53-242" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% CI: ["</span>, <span class="fu">round</span>((poll_sample <span class="sc">-</span> moe) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%, "</span>,</span>
<span id="cb53-243"><a href="#cb53-243" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>((poll_sample <span class="sc">+</span> moe) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>), <span class="st">"%]</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-244"><a href="#cb53-244" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"True proportion:"</span>, true_proportion <span class="sc">*</span> <span class="dv">100</span>, <span class="st">"%</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-245"><a href="#cb53-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-246"><a href="#cb53-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-247"><a href="#cb53-247" aria-hidden="true" tabindex="-1"></a><span class="fu">### How Sample Size Affects Margin of Error</span></span>
<span id="cb53-248"><a href="#cb53-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-249"><a href="#cb53-249" aria-hidden="true" tabindex="-1"></a>The margin of error is inversely proportional to $\sqrt{n}$. This has important practical implications:</span>
<span id="cb53-250"><a href="#cb53-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-253"><a href="#cb53-253" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-254"><a href="#cb53-254" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 7</span></span>
<span id="cb53-255"><a href="#cb53-255" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb53-256"><a href="#cb53-256" aria-hidden="true" tabindex="-1"></a><span class="co"># Margin of error as a function of sample size</span></span>
<span id="cb53-257"><a href="#cb53-257" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">400</span>, <span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">4000</span>, <span class="dv">10000</span>)</span>
<span id="cb53-258"><a href="#cb53-258" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.5</span>  <span class="co"># Conservative estimate</span></span>
<span id="cb53-259"><a href="#cb53-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-260"><a href="#cb53-260" aria-hidden="true" tabindex="-1"></a>moe_values <span class="ot">&lt;-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">/</span> sample_sizes) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb53-261"><a href="#cb53-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-262"><a href="#cb53-262" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sample_sizes, moe_values, <span class="at">type =</span> <span class="st">"b"</span>, <span class="at">pch =</span> <span class="dv">19</span>,</span>
<span id="cb53-263"><a href="#cb53-263" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Sample Size"</span>, <span class="at">ylab =</span> <span class="st">"Margin of Error (%)"</span>,</span>
<span id="cb53-264"><a href="#cb53-264" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"95% Margin of Error vs. Sample Size"</span>,</span>
<span id="cb53-265"><a href="#cb53-265" aria-hidden="true" tabindex="-1"></a>     <span class="at">log =</span> <span class="st">"x"</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb53-266"><a href="#cb53-266" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb53-267"><a href="#cb53-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-268"><a href="#cb53-268" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels</span></span>
<span id="cb53-269"><a href="#cb53-269" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(sample_sizes, moe_values <span class="sc">+</span> <span class="fl">0.5</span>,</span>
<span id="cb53-270"><a href="#cb53-270" aria-hidden="true" tabindex="-1"></a>     <span class="fu">paste0</span>(<span class="st">"±"</span>, <span class="fu">round</span>(moe_values, <span class="dv">1</span>), <span class="st">"%"</span>),</span>
<span id="cb53-271"><a href="#cb53-271" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb53-272"><a href="#cb53-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-273"><a href="#cb53-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-274"><a href="#cb53-274" aria-hidden="true" tabindex="-1"></a>Notice the diminishing returns: going from n = 100 to n = 400 cuts the margin of error in half (from ±10% to ±5%). But to halve it again (to ±2.5%), you need n = 1,600—four times as many respondents. This is why most national polls use samples of 1,000–2,000: it provides reasonable precision (±2-3%) at manageable cost.</span>
<span id="cb53-275"><a href="#cb53-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-276"><a href="#cb53-276" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpreting Polls: Uncertainty in Action</span></span>
<span id="cb53-277"><a href="#cb53-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-278"><a href="#cb53-278" aria-hidden="true" tabindex="-1"></a>When two candidates are within the margin of error of each other, the poll results are consistent with either candidate leading. This is not a flaw of polling—it reflects genuine uncertainty.</span>
<span id="cb53-279"><a href="#cb53-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-282"><a href="#cb53-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-283"><a href="#cb53-283" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb53-284"><a href="#cb53-284" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb53-285"><a href="#cb53-285" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb53-286"><a href="#cb53-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-287"><a href="#cb53-287" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate many polls from the same population</span></span>
<span id="cb53-288"><a href="#cb53-288" aria-hidden="true" tabindex="-1"></a>true_p <span class="ot">&lt;-</span> <span class="fl">0.48</span>  <span class="co"># Candidate A's true support</span></span>
<span id="cb53-289"><a href="#cb53-289" aria-hidden="true" tabindex="-1"></a>n_poll <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb53-290"><a href="#cb53-290" aria-hidden="true" tabindex="-1"></a>n_polls <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb53-291"><a href="#cb53-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-292"><a href="#cb53-292" aria-hidden="true" tabindex="-1"></a>polls <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_polls, {</span>
<span id="cb53-293"><a href="#cb53-293" aria-hidden="true" tabindex="-1"></a>  sample_p <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n_poll, true_p) <span class="sc">/</span> n_poll</span>
<span id="cb53-294"><a href="#cb53-294" aria-hidden="true" tabindex="-1"></a>  se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sample_p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> sample_p) <span class="sc">/</span> n_poll)</span>
<span id="cb53-295"><a href="#cb53-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="at">estimate =</span> sample_p, <span class="at">lower =</span> sample_p <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>se, <span class="at">upper =</span> sample_p <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>se)</span>
<span id="cb53-296"><a href="#cb53-296" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb53-297"><a href="#cb53-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-298"><a href="#cb53-298" aria-hidden="true" tabindex="-1"></a>polls_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb53-299"><a href="#cb53-299" aria-hidden="true" tabindex="-1"></a>  <span class="at">poll =</span> <span class="dv">1</span><span class="sc">:</span>n_polls,</span>
<span id="cb53-300"><a href="#cb53-300" aria-hidden="true" tabindex="-1"></a>  <span class="at">estimate =</span> polls[<span class="st">"estimate"</span>, ],</span>
<span id="cb53-301"><a href="#cb53-301" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> polls[<span class="st">"lower"</span>, ],</span>
<span id="cb53-302"><a href="#cb53-302" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> polls[<span class="st">"upper"</span>, ]</span>
<span id="cb53-303"><a href="#cb53-303" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-304"><a href="#cb53-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-305"><a href="#cb53-305" aria-hidden="true" tabindex="-1"></a><span class="co"># How many CIs contain the true value?</span></span>
<span id="cb53-306"><a href="#cb53-306" aria-hidden="true" tabindex="-1"></a>coverage <span class="ot">&lt;-</span> <span class="fu">mean</span>(polls_df<span class="sc">$</span>lower <span class="sc">&lt;=</span> true_p <span class="sc">&amp;</span> polls_df<span class="sc">$</span>upper <span class="sc">&gt;=</span> true_p)</span>
<span id="cb53-307"><a href="#cb53-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-308"><a href="#cb53-308" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot first 30 polls</span></span>
<span id="cb53-309"><a href="#cb53-309" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(polls_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>, ], <span class="fu">aes</span>(<span class="at">x =</span> poll, <span class="at">y =</span> estimate)) <span class="sc">+</span></span>
<span id="cb53-310"><a href="#cb53-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> true_p, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb53-311"><a href="#cb53-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"gray50"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb53-312"><a href="#cb53-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper), <span class="at">width =</span> <span class="fl">0.3</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb53-313"><a href="#cb53-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb53-314"><a href="#cb53-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb53-315"><a href="#cb53-315" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"95% Confidence Intervals from 30 Polls"</span>,</span>
<span id="cb53-316"><a href="#cb53-316" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"True proportion = "</span>, true_p<span class="sc">*</span><span class="dv">100</span>, <span class="st">"% | "</span>, <span class="fu">round</span>(coverage<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb53-317"><a href="#cb53-317" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"% of all CIs contain true value"</span>),</span>
<span id="cb53-318"><a href="#cb53-318" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Poll Number"</span>,</span>
<span id="cb53-319"><a href="#cb53-319" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Estimated Proportion"</span></span>
<span id="cb53-320"><a href="#cb53-320" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb53-321"><a href="#cb53-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()) <span class="sc">+</span></span>
<span id="cb53-322"><a href="#cb53-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb53-323"><a href="#cb53-323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-324"><a href="#cb53-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-325"><a href="#cb53-325" aria-hidden="true" tabindex="-1"></a>In repeated sampling, approximately 95% of confidence intervals contain the true value—but any single interval either does or does not contain it. This is the frequentist interpretation of confidence intervals.</span>
<span id="cb53-326"><a href="#cb53-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-327"><a href="#cb53-327" aria-hidden="true" tabindex="-1"></a><span class="fu">### Correct Language for Confidence Intervals</span></span>
<span id="cb53-328"><a href="#cb53-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-329"><a href="#cb53-329" aria-hidden="true" tabindex="-1"></a>Confidence intervals are frequently misinterpreted. The key insight is understanding *what is random* before and after data collection:</span>
<span id="cb53-330"><a href="#cb53-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-331"><a href="#cb53-331" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb53-332"><a href="#cb53-332" aria-hidden="true" tabindex="-1"></a><span class="fu">## What Is Random?</span></span>
<span id="cb53-333"><a href="#cb53-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-334"><a href="#cb53-334" aria-hidden="true" tabindex="-1"></a>**Before data collection**: The confidence interval is random—we don't yet know where it will fall. The population parameter $\mu$ is fixed (though unknown).</span>
<span id="cb53-335"><a href="#cb53-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-336"><a href="#cb53-336" aria-hidden="true" tabindex="-1"></a>**After data collection**: The confidence interval is now fixed—it's just two numbers like <span class="co">[</span><span class="ot">48.2, 52.1</span><span class="co">]</span>. It either contains the true parameter or it doesn't. There is no probability involved anymore.</span>
<span id="cb53-337"><a href="#cb53-337" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-338"><a href="#cb53-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-339"><a href="#cb53-339" aria-hidden="true" tabindex="-1"></a>Consider this analogy: Before flipping a coin, there's a 50% probability of heads. After flipping, the coin shows what it shows—there's no longer any probability, just an outcome.</span>
<span id="cb53-340"><a href="#cb53-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-341"><a href="#cb53-341" aria-hidden="true" tabindex="-1"></a>The correct interpretation of a 95% confidence interval is:</span>
<span id="cb53-342"><a href="#cb53-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-343"><a href="#cb53-343" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; "If we repeated this sampling procedure many times, 95% of the resulting intervals would contain the true population parameter."</span></span>
<span id="cb53-344"><a href="#cb53-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-345"><a href="#cb53-345" aria-hidden="true" tabindex="-1"></a>**Incorrect interpretations** (which are very common):</span>
<span id="cb53-346"><a href="#cb53-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-347"><a href="#cb53-347" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>❌ "There is a 95% probability that $\mu$ is in this interval"</span>
<span id="cb53-348"><a href="#cb53-348" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>❌ "We are 95% confident that $\mu$ is between these values"</span>
<span id="cb53-349"><a href="#cb53-349" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>❌ "95% of the data falls within this interval"</span>
<span id="cb53-350"><a href="#cb53-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-351"><a href="#cb53-351" aria-hidden="true" tabindex="-1"></a>The first two statements incorrectly assign probability to the parameter, which is fixed. The third confuses a confidence interval for a reference range.</span>
<span id="cb53-352"><a href="#cb53-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-355"><a href="#cb53-355" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-356"><a href="#cb53-356" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb53-357"><a href="#cb53-357" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb53-358"><a href="#cb53-358" aria-hidden="true" tabindex="-1"></a><span class="co"># Visual demonstration: Monte Carlo simulation of CI coverage</span></span>
<span id="cb53-359"><a href="#cb53-359" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2024</span>)</span>
<span id="cb53-360"><a href="#cb53-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-361"><a href="#cb53-361" aria-hidden="true" tabindex="-1"></a><span class="co"># True population parameters</span></span>
<span id="cb53-362"><a href="#cb53-362" aria-hidden="true" tabindex="-1"></a>true_mean <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb53-363"><a href="#cb53-363" aria-hidden="true" tabindex="-1"></a>true_sd <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb53-364"><a href="#cb53-364" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">25</span>  <span class="co"># Sample size</span></span>
<span id="cb53-365"><a href="#cb53-365" aria-hidden="true" tabindex="-1"></a>n_simulations <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb53-366"><a href="#cb53-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-367"><a href="#cb53-367" aria-hidden="true" tabindex="-1"></a><span class="co"># Storage for confidence intervals</span></span>
<span id="cb53-368"><a href="#cb53-368" aria-hidden="true" tabindex="-1"></a>ci_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb53-369"><a href="#cb53-369" aria-hidden="true" tabindex="-1"></a>  <span class="at">sim =</span> <span class="dv">1</span><span class="sc">:</span>n_simulations,</span>
<span id="cb53-370"><a href="#cb53-370" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> <span class="fu">numeric</span>(n_simulations),</span>
<span id="cb53-371"><a href="#cb53-371" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> <span class="fu">numeric</span>(n_simulations),</span>
<span id="cb53-372"><a href="#cb53-372" aria-hidden="true" tabindex="-1"></a>  <span class="at">contains_true =</span> <span class="fu">logical</span>(n_simulations)</span>
<span id="cb53-373"><a href="#cb53-373" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-374"><a href="#cb53-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-375"><a href="#cb53-375" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate 100 confidence intervals</span></span>
<span id="cb53-376"><a href="#cb53-376" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_simulations) {</span>
<span id="cb53-377"><a href="#cb53-377" aria-hidden="true" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> true_mean, <span class="at">sd =</span> true_sd)</span>
<span id="cb53-378"><a href="#cb53-378" aria-hidden="true" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">t.test</span>(sample_data)<span class="sc">$</span>conf.int</span>
<span id="cb53-379"><a href="#cb53-379" aria-hidden="true" tabindex="-1"></a>  ci_data<span class="sc">$</span>lower[i] <span class="ot">&lt;-</span> ci[<span class="dv">1</span>]</span>
<span id="cb53-380"><a href="#cb53-380" aria-hidden="true" tabindex="-1"></a>  ci_data<span class="sc">$</span>upper[i] <span class="ot">&lt;-</span> ci[<span class="dv">2</span>]</span>
<span id="cb53-381"><a href="#cb53-381" aria-hidden="true" tabindex="-1"></a>  ci_data<span class="sc">$</span>contains_true[i] <span class="ot">&lt;-</span> (ci[<span class="dv">1</span>] <span class="sc">&lt;=</span> true_mean) <span class="sc">&amp;</span> (ci[<span class="dv">2</span>] <span class="sc">&gt;=</span> true_mean)</span>
<span id="cb53-382"><a href="#cb53-382" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-383"><a href="#cb53-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-384"><a href="#cb53-384" aria-hidden="true" tabindex="-1"></a><span class="co"># Count how many contain the true mean</span></span>
<span id="cb53-385"><a href="#cb53-385" aria-hidden="true" tabindex="-1"></a>coverage <span class="ot">&lt;-</span> <span class="fu">mean</span>(ci_data<span class="sc">$</span>contains_true)</span>
<span id="cb53-386"><a href="#cb53-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-387"><a href="#cb53-387" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb53-388"><a href="#cb53-388" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NULL</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">42</span>, <span class="dv">58</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, n_simulations <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb53-389"><a href="#cb53-389" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Value"</span>, <span class="at">ylab =</span> <span class="st">"Simulation Number"</span>,</span>
<span id="cb53-390"><a href="#cb53-390" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">"100 Confidence Intervals ("</span>, <span class="fu">round</span>(coverage<span class="sc">*</span><span class="dv">100</span>), <span class="st">"% contain true mean)"</span>))</span>
<span id="cb53-391"><a href="#cb53-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-392"><a href="#cb53-392" aria-hidden="true" tabindex="-1"></a><span class="co"># Draw intervals</span></span>
<span id="cb53-393"><a href="#cb53-393" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_simulations) {</span>
<span id="cb53-394"><a href="#cb53-394" aria-hidden="true" tabindex="-1"></a>  color <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(ci_data<span class="sc">$</span>contains_true[i], <span class="st">"steelblue"</span>, <span class="st">"red"</span>)</span>
<span id="cb53-395"><a href="#cb53-395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">segments</span>(ci_data<span class="sc">$</span>lower[i], i, ci_data<span class="sc">$</span>upper[i], i, <span class="at">col =</span> color, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb53-396"><a href="#cb53-396" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-397"><a href="#cb53-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-398"><a href="#cb53-398" aria-hidden="true" tabindex="-1"></a><span class="co"># True mean line</span></span>
<span id="cb53-399"><a href="#cb53-399" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> true_mean, <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb53-400"><a href="#cb53-400" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>,</span>
<span id="cb53-401"><a href="#cb53-401" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Contains true mean"</span>, <span class="st">"Misses true mean"</span>, <span class="st">"True mean (μ = 50)"</span>),</span>
<span id="cb53-402"><a href="#cb53-402" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"steelblue"</span>, <span class="st">"red"</span>, <span class="st">"darkgreen"</span>),</span>
<span id="cb53-403"><a href="#cb53-403" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb53-404"><a href="#cb53-404" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-405"><a href="#cb53-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-406"><a href="#cb53-406" aria-hidden="true" tabindex="-1"></a>In this simulation, each horizontal line represents a 95% confidence interval from a different random sample. The red intervals are the ~5% that failed to capture the true mean. Once calculated, each interval either contains the true value (blue) or doesn't (red)—there's no probability about it anymore.</span>
<span id="cb53-407"><a href="#cb53-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-408"><a href="#cb53-408" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Practical Value of Margin of Error</span></span>
<span id="cb53-409"><a href="#cb53-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-410"><a href="#cb53-410" aria-hidden="true" tabindex="-1"></a>Understanding margin of error helps you:</span>
<span id="cb53-411"><a href="#cb53-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-412"><a href="#cb53-412" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Interpret reported results**: A poll showing 52% vs. 48% with ±3% MOE does not clearly favor either candidate</span>
<span id="cb53-413"><a href="#cb53-413" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Plan studies**: Use $n \approx \frac{1}{\text{MOE}^2}$ for proportions near 0.5 to achieve a desired margin of error</span>
<span id="cb53-414"><a href="#cb53-414" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Communicate uncertainty**: Always report intervals, not just point estimates</span>
<span id="cb53-415"><a href="#cb53-415" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Make decisions**: Consider whether differences are within or beyond the margin of error</span>
<span id="cb53-416"><a href="#cb53-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-417"><a href="#cb53-417" aria-hidden="true" tabindex="-1"></a>For sample size planning, if you want a specific margin of error:</span>
<span id="cb53-418"><a href="#cb53-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-421"><a href="#cb53-421" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-422"><a href="#cb53-422" aria-hidden="true" tabindex="-1"></a><span class="co"># Required sample size for different margins of error (95% CI)</span></span>
<span id="cb53-423"><a href="#cb53-423" aria-hidden="true" tabindex="-1"></a>desired_moe <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.05</span>, <span class="fl">0.03</span>, <span class="fl">0.02</span>, <span class="fl">0.01</span>)</span>
<span id="cb53-424"><a href="#cb53-424" aria-hidden="true" tabindex="-1"></a>required_n <span class="ot">&lt;-</span> <span class="fu">ceiling</span>((<span class="fl">1.96</span> <span class="sc">/</span> desired_moe)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fl">0.25</span>)  <span class="co"># 0.25 = p(1-p) at p=0.5</span></span>
<span id="cb53-425"><a href="#cb53-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-426"><a href="#cb53-426" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb53-427"><a href="#cb53-427" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Margin of Error</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">"±"</span>, desired_moe <span class="sc">*</span> <span class="dv">100</span>, <span class="st">"%"</span>),</span>
<span id="cb53-428"><a href="#cb53-428" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Required n</span><span class="st">`</span> <span class="ot">=</span> required_n</span>
<span id="cb53-429"><a href="#cb53-429" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-430"><a href="#cb53-430" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-431"><a href="#cb53-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-432"><a href="#cb53-432" aria-hidden="true" tabindex="-1"></a>These calculations assume simple random sampling. Real-world surveys often use complex sampling designs that affect the effective sample size.</span>
<span id="cb53-433"><a href="#cb53-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-434"><a href="#cb53-434" aria-hidden="true" tabindex="-1"></a><span class="fu">## Coefficient of Variation</span></span>
<span id="cb53-435"><a href="#cb53-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-436"><a href="#cb53-436" aria-hidden="true" tabindex="-1"></a>When comparing variability across groups with different means, the standard deviation alone can be misleading. The **coefficient of variation** (CV) standardizes variability relative to the mean:</span>
<span id="cb53-437"><a href="#cb53-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-438"><a href="#cb53-438" aria-hidden="true" tabindex="-1"></a>$$CV = \frac{s}{\bar{x}} \times 100\%$$</span>
<span id="cb53-439"><a href="#cb53-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-440"><a href="#cb53-440" aria-hidden="true" tabindex="-1"></a>A CV of 10% means the standard deviation is 10% of the mean. This allows meaningful comparisons between groups or measurements on different scales.</span>
<span id="cb53-441"><a href="#cb53-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-442"><a href="#cb53-442" aria-hidden="true" tabindex="-1"></a><span class="fu">## Percentiles and Quantiles</span></span>
<span id="cb53-443"><a href="#cb53-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-444"><a href="#cb53-444" aria-hidden="true" tabindex="-1"></a>**Percentiles** describe the relative position of values within a distribution. The $p$th percentile is the value below which $p$% of the data falls. The 50th percentile is the median, the 25th percentile is the first quartile, and the 75th percentile is the third quartile.</span>
<span id="cb53-445"><a href="#cb53-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-446"><a href="#cb53-446" aria-hidden="true" tabindex="-1"></a>**Quantiles** divide data into equal parts. Quartiles divide into four parts, deciles into ten parts, percentiles into one hundred parts.</span>
<span id="cb53-447"><a href="#cb53-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-450"><a href="#cb53-450" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-451"><a href="#cb53-451" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentiles</span></span>
<span id="cb53-452"><a href="#cb53-452" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">22</span>, <span class="dv">25</span>, <span class="dv">28</span>, <span class="dv">32</span>, <span class="dv">35</span>, <span class="dv">40</span>, <span class="dv">45</span>)</span>
<span id="cb53-453"><a href="#cb53-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-454"><a href="#cb53-454" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(data, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>))</span>
<span id="cb53-455"><a href="#cb53-455" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span>
<span id="cb53-456"><a href="#cb53-456" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-457"><a href="#cb53-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-458"><a href="#cb53-458" aria-hidden="true" tabindex="-1"></a>Quantiles form the basis for many statistical procedures, including constructing confidence intervals and calculating p-values.</span>
<span id="cb53-459"><a href="#cb53-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-460"><a href="#cb53-460" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bias and Variability</span></span>
<span id="cb53-461"><a href="#cb53-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-462"><a href="#cb53-462" aria-hidden="true" tabindex="-1"></a>Two distinct types of error affect estimates:</span>
<span id="cb53-463"><a href="#cb53-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-464"><a href="#cb53-464" aria-hidden="true" tabindex="-1"></a>**Bias** is systematic error—the tendency for an estimator to consistently over- or underestimate the true parameter. An unbiased estimator has zero bias: its average value across all possible samples equals the true parameter.</span>
<span id="cb53-465"><a href="#cb53-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-466"><a href="#cb53-466" aria-hidden="true" tabindex="-1"></a>**Variability** is random error—the spread of estimates around their average value. Low variability means estimates cluster tightly together.</span>
<span id="cb53-467"><a href="#cb53-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-468"><a href="#cb53-468" aria-hidden="true" tabindex="-1"></a>The ideal estimator has both low bias and low variability. Sometimes there is a tradeoff: a slightly biased estimator might have much lower variability, resulting in estimates that are closer to the truth on average.</span>
<span id="cb53-469"><a href="#cb53-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-470"><a href="#cb53-470" aria-hidden="true" tabindex="-1"></a>The **mean squared error** (MSE) combines both sources of error:</span>
<span id="cb53-471"><a href="#cb53-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-472"><a href="#cb53-472" aria-hidden="true" tabindex="-1"></a>$$MSE = Bias^2 + Variance$$</span>
<span id="cb53-473"><a href="#cb53-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-474"><a href="#cb53-474" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Bootstrap: Resampling for Estimation</span></span>
<span id="cb53-475"><a href="#cb53-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-476"><a href="#cb53-476" aria-hidden="true" tabindex="-1"></a>The bootstrap, introduced by Bradley Efron in 1979, is a powerful resampling method for estimating standard errors and constructing confidence intervals when analytical formulas are unavailable or assumptions are questionable <span class="co">[</span><span class="ot">@efron1979bootstrap</span><span class="co">]</span>.</span>
<span id="cb53-477"><a href="#cb53-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-478"><a href="#cb53-478" aria-hidden="true" tabindex="-1"></a>The key insight is elegant: we can estimate the sampling distribution of a statistic by repeatedly resampling from our observed data. If our sample is representative of the population, then samples drawn from our sample (with replacement) should behave like samples drawn from the population.</span>
<span id="cb53-479"><a href="#cb53-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-480"><a href="#cb53-480" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Bootstrap Algorithm</span></span>
<span id="cb53-481"><a href="#cb53-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-482"><a href="#cb53-482" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Take a random sample with replacement from your data (same size as original)</span>
<span id="cb53-483"><a href="#cb53-483" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Calculate the statistic of interest on this resampled data</span>
<span id="cb53-484"><a href="#cb53-484" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Repeat steps 1-2 many times (typically 1000-10000)</span>
<span id="cb53-485"><a href="#cb53-485" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>The distribution of bootstrap statistics approximates the sampling distribution</span>
<span id="cb53-486"><a href="#cb53-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-489"><a href="#cb53-489" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-490"><a href="#cb53-490" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb53-491"><a href="#cb53-491" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 5</span></span>
<span id="cb53-492"><a href="#cb53-492" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap estimation of the sampling distribution of the mean</span></span>
<span id="cb53-493"><a href="#cb53-493" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb53-494"><a href="#cb53-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-495"><a href="#cb53-495" aria-hidden="true" tabindex="-1"></a><span class="co"># Our observed sample</span></span>
<span id="cb53-496"><a href="#cb53-496" aria-hidden="true" tabindex="-1"></a>original_sample <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">23</span>, <span class="dv">31</span>, <span class="dv">28</span>, <span class="dv">35</span>, <span class="dv">42</span>, <span class="dv">29</span>, <span class="dv">33</span>, <span class="dv">27</span>, <span class="dv">38</span>, <span class="dv">31</span>)</span>
<span id="cb53-497"><a href="#cb53-497" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(original_sample)</span>
<span id="cb53-498"><a href="#cb53-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-499"><a href="#cb53-499" aria-hidden="true" tabindex="-1"></a><span class="co"># Bootstrap: resample with replacement</span></span>
<span id="cb53-500"><a href="#cb53-500" aria-hidden="true" tabindex="-1"></a>n_bootstrap <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb53-501"><a href="#cb53-501" aria-hidden="true" tabindex="-1"></a>bootstrap_means <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_bootstrap)</span>
<span id="cb53-502"><a href="#cb53-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-503"><a href="#cb53-503" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_bootstrap) {</span>
<span id="cb53-504"><a href="#cb53-504" aria-hidden="true" tabindex="-1"></a>  boot_sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(original_sample, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb53-505"><a href="#cb53-505" aria-hidden="true" tabindex="-1"></a>  bootstrap_means[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(boot_sample)</span>
<span id="cb53-506"><a href="#cb53-506" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-507"><a href="#cb53-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-508"><a href="#cb53-508" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare bootstrap distribution to observed statistics</span></span>
<span id="cb53-509"><a href="#cb53-509" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bootstrap_means, <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb53-510"><a href="#cb53-510" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Bootstrap Distribution of the Mean"</span>,</span>
<span id="cb53-511"><a href="#cb53-511" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Sample Mean"</span>)</span>
<span id="cb53-512"><a href="#cb53-512" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">mean</span>(original_sample), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb53-513"><a href="#cb53-513" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="fu">quantile</span>(bootstrap_means, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)), <span class="at">col =</span> <span class="st">"darkgreen"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb53-514"><a href="#cb53-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-515"><a href="#cb53-515" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Original sample mean:"</span>, <span class="fu">mean</span>(original_sample), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-516"><a href="#cb53-516" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Bootstrap SE:"</span>, <span class="fu">sd</span>(bootstrap_means), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-517"><a href="#cb53-517" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"95% Bootstrap CI:"</span>, <span class="fu">quantile</span>(bootstrap_means, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-518"><a href="#cb53-518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-519"><a href="#cb53-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-520"><a href="#cb53-520" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bootstrap Confidence Intervals</span></span>
<span id="cb53-521"><a href="#cb53-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-522"><a href="#cb53-522" aria-hidden="true" tabindex="-1"></a>The bootstrap provides several methods for constructing confidence intervals:</span>
<span id="cb53-523"><a href="#cb53-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-524"><a href="#cb53-524" aria-hidden="true" tabindex="-1"></a>**Percentile method**: Use the 2.5th and 97.5th percentiles of the bootstrap distribution as the 95% CI bounds. This is the simplest approach shown above.</span>
<span id="cb53-525"><a href="#cb53-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-526"><a href="#cb53-526" aria-hidden="true" tabindex="-1"></a>**Basic (reverse percentile) method**: Reflects the percentiles around the original estimate to correct for certain types of bias.</span>
<span id="cb53-527"><a href="#cb53-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-528"><a href="#cb53-528" aria-hidden="true" tabindex="-1"></a>**BCa (bias-corrected and accelerated)**: A more sophisticated method that adjusts for both bias and skewness in the bootstrap distribution. This is often preferred when the sampling distribution is not symmetric.</span>
<span id="cb53-529"><a href="#cb53-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-532"><a href="#cb53-532" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-533"><a href="#cb53-533" aria-hidden="true" tabindex="-1"></a><span class="co"># Using the boot package for more sophisticated bootstrap CI</span></span>
<span id="cb53-534"><a href="#cb53-534" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb53-535"><a href="#cb53-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-536"><a href="#cb53-536" aria-hidden="true" tabindex="-1"></a><span class="co"># Define statistic function</span></span>
<span id="cb53-537"><a href="#cb53-537" aria-hidden="true" tabindex="-1"></a>mean_stat <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb53-538"><a href="#cb53-538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(data[indices])</span>
<span id="cb53-539"><a href="#cb53-539" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-540"><a href="#cb53-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-541"><a href="#cb53-541" aria-hidden="true" tabindex="-1"></a><span class="co"># Run bootstrap</span></span>
<span id="cb53-542"><a href="#cb53-542" aria-hidden="true" tabindex="-1"></a>boot_result <span class="ot">&lt;-</span> <span class="fu">boot</span>(original_sample, mean_stat, <span class="at">R =</span> <span class="dv">5000</span>)</span>
<span id="cb53-543"><a href="#cb53-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-544"><a href="#cb53-544" aria-hidden="true" tabindex="-1"></a><span class="co"># Different CI methods</span></span>
<span id="cb53-545"><a href="#cb53-545" aria-hidden="true" tabindex="-1"></a><span class="fu">boot.ci</span>(boot_result, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"perc"</span>, <span class="st">"basic"</span>, <span class="st">"bca"</span>))</span>
<span id="cb53-546"><a href="#cb53-546" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-547"><a href="#cb53-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-548"><a href="#cb53-548" aria-hidden="true" tabindex="-1"></a><span class="fu">### When to Use the Bootstrap</span></span>
<span id="cb53-549"><a href="#cb53-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-550"><a href="#cb53-550" aria-hidden="true" tabindex="-1"></a>The bootstrap is particularly valuable when:</span>
<span id="cb53-551"><a href="#cb53-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-552"><a href="#cb53-552" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The sampling distribution of your statistic is unknown or complex</span>
<span id="cb53-553"><a href="#cb53-553" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Sample sizes are small and normality assumptions are questionable</span>
<span id="cb53-554"><a href="#cb53-554" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You are estimating something other than a mean (e.g., median, correlation, regression coefficients)</span>
<span id="cb53-555"><a href="#cb53-555" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Analytical formulas for standard errors do not exist</span>
<span id="cb53-556"><a href="#cb53-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-557"><a href="#cb53-557" aria-hidden="true" tabindex="-1"></a>However, the bootstrap has limitations. It assumes your sample is representative of the population and works poorly with very small samples (n &lt; 10-15) or when estimating extreme quantiles.</span>
<span id="cb53-558"><a href="#cb53-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-559"><a href="#cb53-559" aria-hidden="true" tabindex="-1"></a><span class="fu">## Maximum Likelihood Estimation</span></span>
<span id="cb53-560"><a href="#cb53-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-561"><a href="#cb53-561" aria-hidden="true" tabindex="-1"></a>**Maximum likelihood estimation (MLE)** provides a principled framework for parameter estimation. The likelihood function measures how probable the observed data would be for different parameter values. MLE finds the parameter values that make the observed data most probable.</span>
<span id="cb53-562"><a href="#cb53-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-563"><a href="#cb53-563" aria-hidden="true" tabindex="-1"></a>For a sample $x_1, x_2, \ldots, x_n$ from a distribution with parameter $\theta$, the likelihood function is:</span>
<span id="cb53-564"><a href="#cb53-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-565"><a href="#cb53-565" aria-hidden="true" tabindex="-1"></a>$$L(\theta | x_1, \ldots, x_n) = \prod_{i=1}^{n} f(x_i | \theta)$$</span>
<span id="cb53-566"><a href="#cb53-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-567"><a href="#cb53-567" aria-hidden="true" tabindex="-1"></a>where $f(x_i | \theta)$ is the probability density (or mass) function. We typically work with the log-likelihood for computational convenience:</span>
<span id="cb53-568"><a href="#cb53-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-569"><a href="#cb53-569" aria-hidden="true" tabindex="-1"></a>$$\ell(\theta) = \sum_{i=1}^{n} \log f(x_i | \theta)$$</span>
<span id="cb53-570"><a href="#cb53-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-571"><a href="#cb53-571" aria-hidden="true" tabindex="-1"></a>The MLE $\hat{\theta}$ is the value that maximizes $\ell(\theta)$.</span>
<span id="cb53-572"><a href="#cb53-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-575"><a href="#cb53-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-576"><a href="#cb53-576" aria-hidden="true" tabindex="-1"></a><span class="co"># MLE example: estimating the rate parameter of an exponential distribution</span></span>
<span id="cb53-577"><a href="#cb53-577" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb53-578"><a href="#cb53-578" aria-hidden="true" tabindex="-1"></a>exp_data <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">100</span>, <span class="at">rate =</span> <span class="fl">0.5</span>)  <span class="co"># True rate is 0.5</span></span>
<span id="cb53-579"><a href="#cb53-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-580"><a href="#cb53-580" aria-hidden="true" tabindex="-1"></a><span class="co"># Log-likelihood function for exponential</span></span>
<span id="cb53-581"><a href="#cb53-581" aria-hidden="true" tabindex="-1"></a>log_likelihood <span class="ot">&lt;-</span> <span class="cf">function</span>(rate, data) {</span>
<span id="cb53-582"><a href="#cb53-582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">dexp</span>(data, <span class="at">rate =</span> rate, <span class="at">log =</span> <span class="cn">TRUE</span>))</span>
<span id="cb53-583"><a href="#cb53-583" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-584"><a href="#cb53-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-585"><a href="#cb53-585" aria-hidden="true" tabindex="-1"></a><span class="co"># Find MLE</span></span>
<span id="cb53-586"><a href="#cb53-586" aria-hidden="true" tabindex="-1"></a>rates <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb53-587"><a href="#cb53-587" aria-hidden="true" tabindex="-1"></a>ll_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(rates, log_likelihood, <span class="at">data =</span> exp_data)</span>
<span id="cb53-588"><a href="#cb53-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-589"><a href="#cb53-589" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot likelihood surface</span></span>
<span id="cb53-590"><a href="#cb53-590" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rates, ll_values, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb53-591"><a href="#cb53-591" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Rate parameter"</span>, <span class="at">ylab =</span> <span class="st">"Log-likelihood"</span>,</span>
<span id="cb53-592"><a href="#cb53-592" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Log-likelihood for Exponential Rate"</span>)</span>
<span id="cb53-593"><a href="#cb53-593" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(exp_data), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)  <span class="co"># MLE = 1/mean for exponential</span></span>
<span id="cb53-594"><a href="#cb53-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-595"><a href="#cb53-595" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"True rate: 0.5</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-596"><a href="#cb53-596" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"MLE estimate:"</span>, <span class="fu">round</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(exp_data), <span class="dv">3</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-597"><a href="#cb53-597" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-598"><a href="#cb53-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-599"><a href="#cb53-599" aria-hidden="true" tabindex="-1"></a>MLEs have desirable properties: they are consistent (converge to true values as n increases) and asymptotically efficient (achieve the smallest possible variance for large samples).</span>
<span id="cb53-600"><a href="#cb53-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-601"><a href="#cb53-601" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulation-Based Understanding of Estimation</span></span>
<span id="cb53-602"><a href="#cb53-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-603"><a href="#cb53-603" aria-hidden="true" tabindex="-1"></a>Simulation provides powerful intuition for statistical concepts. By repeatedly sampling from known populations, we can directly observe sampling distributions.</span>
<span id="cb53-604"><a href="#cb53-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-607"><a href="#cb53-607" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-608"><a href="#cb53-608" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 9</span></span>
<span id="cb53-609"><a href="#cb53-609" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb53-610"><a href="#cb53-610" aria-hidden="true" tabindex="-1"></a><span class="co"># Exploring properties of estimators through simulation</span></span>
<span id="cb53-611"><a href="#cb53-611" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb53-612"><a href="#cb53-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-613"><a href="#cb53-613" aria-hidden="true" tabindex="-1"></a><span class="co"># True population parameters</span></span>
<span id="cb53-614"><a href="#cb53-614" aria-hidden="true" tabindex="-1"></a>pop_mean <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb53-615"><a href="#cb53-615" aria-hidden="true" tabindex="-1"></a>pop_sd <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb53-616"><a href="#cb53-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-617"><a href="#cb53-617" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulate many samples and compute estimates</span></span>
<span id="cb53-618"><a href="#cb53-618" aria-hidden="true" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb53-619"><a href="#cb53-619" aria-hidden="true" tabindex="-1"></a>sample_sizes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">50</span>)</span>
<span id="cb53-620"><a href="#cb53-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-621"><a href="#cb53-621" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb53-622"><a href="#cb53-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-623"><a href="#cb53-623" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> sample_sizes) {</span>
<span id="cb53-624"><a href="#cb53-624" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Collect sample means</span></span>
<span id="cb53-625"><a href="#cb53-625" aria-hidden="true" tabindex="-1"></a>  sample_means <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_samples, {</span>
<span id="cb53-626"><a href="#cb53-626" aria-hidden="true" tabindex="-1"></a>    samp <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> pop_mean, <span class="at">sd =</span> pop_sd)</span>
<span id="cb53-627"><a href="#cb53-627" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(samp)</span>
<span id="cb53-628"><a href="#cb53-628" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb53-629"><a href="#cb53-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-630"><a href="#cb53-630" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot distribution of sample means</span></span>
<span id="cb53-631"><a href="#cb53-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(sample_means, <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">col =</span> <span class="st">"steelblue"</span>,</span>
<span id="cb53-632"><a href="#cb53-632" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Sample Means (n ="</span>, n, <span class="st">")"</span>),</span>
<span id="cb53-633"><a href="#cb53-633" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Sample Mean"</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">35</span>, <span class="dv">65</span>))</span>
<span id="cb53-634"><a href="#cb53-634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> pop_mean, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb53-635"><a href="#cb53-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-636"><a href="#cb53-636" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate actual SE vs theoretical</span></span>
<span id="cb53-637"><a href="#cb53-637" aria-hidden="true" tabindex="-1"></a>  actual_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(sample_means)</span>
<span id="cb53-638"><a href="#cb53-638" aria-hidden="true" tabindex="-1"></a>  theoretical_se <span class="ot">&lt;-</span> pop_sd <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb53-639"><a href="#cb53-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-640"><a href="#cb53-640" aria-hidden="true" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">bty =</span> <span class="st">"n"</span>, <span class="at">cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb53-641"><a href="#cb53-641" aria-hidden="true" tabindex="-1"></a>         <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="st">"Actual SE:"</span>, <span class="fu">round</span>(actual_se, <span class="dv">2</span>)),</span>
<span id="cb53-642"><a href="#cb53-642" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">paste</span>(<span class="st">"Theoretical:"</span>, <span class="fu">round</span>(theoretical_se, <span class="dv">2</span>))))</span>
<span id="cb53-643"><a href="#cb53-643" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-644"><a href="#cb53-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-645"><a href="#cb53-645" aria-hidden="true" tabindex="-1"></a><span class="co"># Now do the same for sample standard deviations</span></span>
<span id="cb53-646"><a href="#cb53-646" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> sample_sizes) {</span>
<span id="cb53-647"><a href="#cb53-647" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Collect sample SDs</span></span>
<span id="cb53-648"><a href="#cb53-648" aria-hidden="true" tabindex="-1"></a>  sample_sds <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_samples, {</span>
<span id="cb53-649"><a href="#cb53-649" aria-hidden="true" tabindex="-1"></a>    samp <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> pop_mean, <span class="at">sd =</span> pop_sd)</span>
<span id="cb53-650"><a href="#cb53-650" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(samp)</span>
<span id="cb53-651"><a href="#cb53-651" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb53-652"><a href="#cb53-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-653"><a href="#cb53-653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(sample_sds, <span class="at">breaks =</span> <span class="dv">40</span>, <span class="at">col =</span> <span class="st">"coral"</span>,</span>
<span id="cb53-654"><a href="#cb53-654" aria-hidden="true" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"Sample SDs (n ="</span>, n, <span class="st">")"</span>),</span>
<span id="cb53-655"><a href="#cb53-655" aria-hidden="true" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">"Sample SD"</span>)</span>
<span id="cb53-656"><a href="#cb53-656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v =</span> pop_sd, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb53-657"><a href="#cb53-657" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-658"><a href="#cb53-658" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-659"><a href="#cb53-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-660"><a href="#cb53-660" aria-hidden="true" tabindex="-1"></a>This simulation reveals several important facts:</span>
<span id="cb53-661"><a href="#cb53-661" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Sample means are unbiased (centered on the population mean)</span>
<span id="cb53-662"><a href="#cb53-662" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>The spread of sample means decreases as $\sqrt{n}$</span>
<span id="cb53-663"><a href="#cb53-663" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Sample standard deviations are slightly biased for small samples but become unbiased as n increases</span>
<span id="cb53-664"><a href="#cb53-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-665"><a href="#cb53-665" aria-hidden="true" tabindex="-1"></a><span class="fu">## Principles of Experimental Design</span></span>
<span id="cb53-666"><a href="#cb53-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-667"><a href="#cb53-667" aria-hidden="true" tabindex="-1"></a>Good statistical analysis cannot rescue a poorly designed study. The way you collect data fundamentally determines what conclusions you can draw. Understanding key design principles is essential for planning experiments that yield valid, interpretable results.</span>
<span id="cb53-668"><a href="#cb53-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-669"><a href="#cb53-669" aria-hidden="true" tabindex="-1"></a><span class="fu">### Randomization</span></span>
<span id="cb53-670"><a href="#cb53-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-671"><a href="#cb53-671" aria-hidden="true" tabindex="-1"></a>**Randomization** assigns subjects to treatment groups by chance, ensuring that treatment groups are comparable. Without randomization, systematic differences between groups (confounders) can bias results.</span>
<span id="cb53-672"><a href="#cb53-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-675"><a href="#cb53-675" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-676"><a href="#cb53-676" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomly assign 20 subjects to treatment or control</span></span>
<span id="cb53-677"><a href="#cb53-677" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb53-678"><a href="#cb53-678" aria-hidden="true" tabindex="-1"></a>subjects <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb53-679"><a href="#cb53-679" aria-hidden="true" tabindex="-1"></a>treatment_group <span class="ot">&lt;-</span> <span class="fu">sample</span>(subjects, <span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb53-680"><a href="#cb53-680" aria-hidden="true" tabindex="-1"></a>control_group <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(subjects, treatment_group)</span>
<span id="cb53-681"><a href="#cb53-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-682"><a href="#cb53-682" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Treatment group:"</span>, treatment_group, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-683"><a href="#cb53-683" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Control group:"</span>, control_group, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb53-684"><a href="#cb53-684" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-685"><a href="#cb53-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-686"><a href="#cb53-686" aria-hidden="true" tabindex="-1"></a>Randomization provides the foundation for causal inference. Without it, we can only establish associations, not causation.</span>
<span id="cb53-687"><a href="#cb53-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-688"><a href="#cb53-688" aria-hidden="true" tabindex="-1"></a><span class="fu">### Controls</span></span>
<span id="cb53-689"><a href="#cb53-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-690"><a href="#cb53-690" aria-hidden="true" tabindex="-1"></a>Every experiment needs **controls**—groups that differ from treatment groups only in the variable of interest:</span>
<span id="cb53-691"><a href="#cb53-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-692"><a href="#cb53-692" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Negative control**: Receives no treatment; establishes baseline</span>
<span id="cb53-693"><a href="#cb53-693" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Positive control**: Receives a treatment known to work; confirms the experimental system is functioning</span>
<span id="cb53-694"><a href="#cb53-694" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Procedural control**: Receives all procedures except the active ingredient (e.g., sham surgery, vehicle-only injection)</span>
<span id="cb53-695"><a href="#cb53-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-696"><a href="#cb53-696" aria-hidden="true" tabindex="-1"></a>Without proper controls, you cannot determine whether observed effects are due to your treatment or some other factor.</span>
<span id="cb53-697"><a href="#cb53-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-698"><a href="#cb53-698" aria-hidden="true" tabindex="-1"></a><span class="fu">### Blinding</span></span>
<span id="cb53-699"><a href="#cb53-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-700"><a href="#cb53-700" aria-hidden="true" tabindex="-1"></a>**Blinding** prevents knowledge of group assignment from influencing results:</span>
<span id="cb53-701"><a href="#cb53-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-702"><a href="#cb53-702" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Single-blind**: Subjects do not know which treatment they receive</span>
<span id="cb53-703"><a href="#cb53-703" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Double-blind**: Neither subjects nor experimenters know group assignments</span>
<span id="cb53-704"><a href="#cb53-704" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Triple-blind**: Subjects, experimenters, and data analysts are all blinded</span>
<span id="cb53-705"><a href="#cb53-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-706"><a href="#cb53-706" aria-hidden="true" tabindex="-1"></a>Blinding prevents both placebo effects (subjects' expectations influencing outcomes) and experimenter bias (conscious or unconscious influence on measurements).</span>
<span id="cb53-707"><a href="#cb53-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-708"><a href="#cb53-708" aria-hidden="true" tabindex="-1"></a><span class="fu">### Replication</span></span>
<span id="cb53-709"><a href="#cb53-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-710"><a href="#cb53-710" aria-hidden="true" tabindex="-1"></a>**Replication** means having multiple independent observations in each treatment group. Replication is essential because it:</span>
<span id="cb53-711"><a href="#cb53-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-712"><a href="#cb53-712" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Provides estimates of variability</span>
<span id="cb53-713"><a href="#cb53-713" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Enables statistical inference</span>
<span id="cb53-714"><a href="#cb53-714" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Increases precision of estimates</span>
<span id="cb53-715"><a href="#cb53-715" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Allows detection of real effects</span>
<span id="cb53-716"><a href="#cb53-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-717"><a href="#cb53-717" aria-hidden="true" tabindex="-1"></a>The **unit of replication** must match the **unit of treatment**. If you treat tanks with different water temperatures and measure multiple fish per tank, your replicates are tanks, not fish.</span>
<span id="cb53-718"><a href="#cb53-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-719"><a href="#cb53-719" aria-hidden="true" tabindex="-1"></a>::: {.callout-warning}</span>
<span id="cb53-720"><a href="#cb53-720" aria-hidden="true" tabindex="-1"></a><span class="fu">## Technical vs. Biological Replicates</span></span>
<span id="cb53-721"><a href="#cb53-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-722"><a href="#cb53-722" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Technical replicates**: Repeated measurements of the same sample (e.g., running the same sample through a machine twice)</span>
<span id="cb53-723"><a href="#cb53-723" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Biological replicates**: Independent samples from different individuals or experimental units</span>
<span id="cb53-724"><a href="#cb53-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-725"><a href="#cb53-725" aria-hidden="true" tabindex="-1"></a>Technical replicates measure precision of the measurement process. Biological replicates measure biological variability and enable inference to the population. Do not confuse them!</span>
<span id="cb53-726"><a href="#cb53-726" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb53-727"><a href="#cb53-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-728"><a href="#cb53-728" aria-hidden="true" tabindex="-1"></a><span class="fu">### Blocking</span></span>
<span id="cb53-729"><a href="#cb53-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-730"><a href="#cb53-730" aria-hidden="true" tabindex="-1"></a>**Blocking** groups experimental units that are similar to each other, then applies all treatments within each block. This reduces variability by accounting for known sources of heterogeneity.</span>
<span id="cb53-731"><a href="#cb53-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-732"><a href="#cb53-732" aria-hidden="true" tabindex="-1"></a>Common blocking factors:</span>
<span id="cb53-733"><a href="#cb53-733" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Time (experimental batches, days)</span>
<span id="cb53-734"><a href="#cb53-734" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Location (different incubators, growth chambers)</span>
<span id="cb53-735"><a href="#cb53-735" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Individual (paired designs, repeated measures)</span>
<span id="cb53-736"><a href="#cb53-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-739"><a href="#cb53-739" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb53-740"><a href="#cb53-740" aria-hidden="true" tabindex="-1"></a><span class="co"># Randomized complete block design</span></span>
<span id="cb53-741"><a href="#cb53-741" aria-hidden="true" tabindex="-1"></a><span class="co"># 4 treatments applied within each of 3 blocks</span></span>
<span id="cb53-742"><a href="#cb53-742" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb53-743"><a href="#cb53-743" aria-hidden="true" tabindex="-1"></a>blocks <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb53-744"><a href="#cb53-744" aria-hidden="true" tabindex="-1"></a>treatments <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>)</span>
<span id="cb53-745"><a href="#cb53-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-746"><a href="#cb53-746" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">Block =</span> blocks, <span class="at">Treatment =</span> treatments)</span>
<span id="cb53-747"><a href="#cb53-747" aria-hidden="true" tabindex="-1"></a>design<span class="sc">$</span>Order <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb53-748"><a href="#cb53-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-749"><a href="#cb53-749" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> blocks) {</span>
<span id="cb53-750"><a href="#cb53-750" aria-hidden="true" tabindex="-1"></a>  block_rows <span class="ot">&lt;-</span> design<span class="sc">$</span>Block <span class="sc">==</span> b</span>
<span id="cb53-751"><a href="#cb53-751" aria-hidden="true" tabindex="-1"></a>  design<span class="sc">$</span>Order[block_rows] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb53-752"><a href="#cb53-752" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-753"><a href="#cb53-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-754"><a href="#cb53-754" aria-hidden="true" tabindex="-1"></a>design[<span class="fu">order</span>(design<span class="sc">$</span>Block, design<span class="sc">$</span>Order), ]</span>
<span id="cb53-755"><a href="#cb53-755" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb53-756"><a href="#cb53-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-757"><a href="#cb53-757" aria-hidden="true" tabindex="-1"></a>Blocking is particularly valuable when blocks correspond to major sources of variation (e.g., different labs, experimental days, genetic backgrounds).</span>
<span id="cb53-758"><a href="#cb53-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-759"><a href="#cb53-759" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sample Size Considerations</span></span>
<span id="cb53-760"><a href="#cb53-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-761"><a href="#cb53-761" aria-hidden="true" tabindex="-1"></a>Determining appropriate sample size before collecting data is crucial. Too few samples waste resources by producing inconclusive results; too many waste resources by studying effects that were detectable with smaller samples.</span>
<span id="cb53-762"><a href="#cb53-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-763"><a href="#cb53-763" aria-hidden="true" tabindex="-1"></a>Sample size depends on:</span>
<span id="cb53-764"><a href="#cb53-764" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Effect size**: The minimum meaningful difference you want to detect</span>
<span id="cb53-765"><a href="#cb53-765" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Variability**: The expected noise in your measurements</span>
<span id="cb53-766"><a href="#cb53-766" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Significance level ($\alpha$)**: Usually 0.05</span>
<span id="cb53-767"><a href="#cb53-767" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Power**: Usually 0.80 (80% chance of detecting a real effect)</span>
<span id="cb53-768"><a href="#cb53-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-769"><a href="#cb53-769" aria-hidden="true" tabindex="-1"></a>Power analysis (covered in detail in a later chapter) formalizes these considerations.</span>
<span id="cb53-770"><a href="#cb53-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-771"><a href="#cb53-771" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key Takeaways</span></span>
<span id="cb53-772"><a href="#cb53-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-773"><a href="#cb53-773" aria-hidden="true" tabindex="-1"></a>Understanding sampling distributions and estimation is fundamental to statistical inference. Key points to remember:</span>
<span id="cb53-774"><a href="#cb53-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-775"><a href="#cb53-775" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Statistics vary from sample to sample; this variability is quantified by the standard error</span>
<span id="cb53-776"><a href="#cb53-776" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Larger samples give more precise estimates (smaller standard errors)</span>
<span id="cb53-777"><a href="#cb53-777" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Confidence intervals quantify uncertainty about parameter estimates</span>
<span id="cb53-778"><a href="#cb53-778" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>The Central Limit Theorem explains why the normal distribution appears so frequently</span>
<span id="cb53-779"><a href="#cb53-779" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Both bias and variability affect the quality of estimates</span>
<span id="cb53-780"><a href="#cb53-780" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>The bootstrap provides a flexible, computer-intensive approach to estimation when analytical methods are limited</span>
<span id="cb53-781"><a href="#cb53-781" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Maximum likelihood provides a principled framework for parameter estimation</span>
<span id="cb53-782"><a href="#cb53-782" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Good experimental design—randomization, controls, blinding, proper replication—is essential for valid inference</span>
<span id="cb53-783"><a href="#cb53-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-784"><a href="#cb53-784" aria-hidden="true" tabindex="-1"></a>These concepts provide the foundation for hypothesis testing and the statistical inference methods we develop in subsequent chapters.</span>
<span id="cb53-785"><a href="#cb53-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-786"><a href="#cb53-786" aria-hidden="true" tabindex="-1"></a><span class="fu">## Additional Resources</span></span>
<span id="cb53-787"><a href="#cb53-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-788"><a href="#cb53-788" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@efron1979bootstrap - The original bootstrap paper, a landmark in modern statistics</span>
<span id="cb53-789"><a href="#cb53-789" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>@irizarry2019introduction - Excellent chapters on sampling and estimation with R examples</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Statistics for Bioengineering by William Cresko</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>