<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.30">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Tidy Data and Data Wrangling – Statistics for Bioengineering</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/06-data-visualization.html" rel="next">
<link href="../chapters/04-markdown-latex.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-de070a7b0ab54f8780927367ac907214.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-485d01fc63b59abcd3ee1bf1e8e2748d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/01-introduction.html">Foundations of Data Science</a></li><li class="breadcrumb-item"><a href="../chapters/05-tidy-data.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Tidy Data and Data Wrangling</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Statistics for Bioengineering</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Foundations of Data Science</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02-unix-command-line.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Unix and the Command Line</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03-r-rstudio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">R and RStudio</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04-markdown-latex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Markdown and LaTeX</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05-tidy-data.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Tidy Data and Data Wrangling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06-data-visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Visualization</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Probability and Distributions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07-probability-foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Foundations of Probability</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/08-discrete-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Discrete Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/09-continuous-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Continuous Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/10-sampling-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Sampling and Parameter Estimation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Statistical Inference</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/11-hypothesis-testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/12-t-tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">T-Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/13-nonparametric-tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Nonparametric Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/14-bootstrapping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Bootstrapping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/14b-what-are-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">What are Models?</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Linear Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/15-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Correlation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/16-simple-linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Simple Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/17-residual-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Residual Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/18-statistical-power.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Statistical Power</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Topics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/19-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/20-multiple-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Multiple Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/21-glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Generalized Linear Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/22-statistical-learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Statistical Learning</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/23-dimensionality-reduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Dimensionality Reduction and Multivariate Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/24-high-performance-computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">High Performance Computing</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Scientific Communication</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/25-presenting-results.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Presenting Statistical Results</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true">
 <span class="menu-text">Historical Context</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A1-eugenics-history.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">The Eugenics History of Statistics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A2-r-reference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">R Command Reference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A3-probability-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Common Probability Distributions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A4-greek-letters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Greek Letters in Mathematics and Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A5-sampling-distributions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Sampling Distributions in Hypothesis Testing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A6-unix-reference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Unix Command Reference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A7-latex-reference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">LaTeX Command Reference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/A8-keyboard-shortcuts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Keyboard Shortcuts Reference</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#what-is-tidy-data" id="toc-what-is-tidy-data" class="nav-link active" data-scroll-target="#what-is-tidy-data"><span class="header-section-number">5.1</span> What is Tidy Data?</a></li>
  <li><a href="#rules-of-thumb-for-data-organization" id="toc-rules-of-thumb-for-data-organization" class="nav-link" data-scroll-target="#rules-of-thumb-for-data-organization"><span class="header-section-number">5.2</span> Rules of Thumb for Data Organization</a></li>
  <li><a href="#types-of-data" id="toc-types-of-data" class="nav-link" data-scroll-target="#types-of-data"><span class="header-section-number">5.3</span> Types of Data</a></li>
  <li><a href="#the-tidyverse" id="toc-the-tidyverse" class="nav-link" data-scroll-target="#the-tidyverse"><span class="header-section-number">5.4</span> The Tidyverse</a></li>
  <li><a href="#tibbles" id="toc-tibbles" class="nav-link" data-scroll-target="#tibbles"><span class="header-section-number">5.5</span> Tibbles</a></li>
  <li><a href="#key-dplyr-verbs" id="toc-key-dplyr-verbs" class="nav-link" data-scroll-target="#key-dplyr-verbs"><span class="header-section-number">5.6</span> Key dplyr Verbs</a>
  <ul class="collapse">
  <li><a href="#filter-subset-rows" id="toc-filter-subset-rows" class="nav-link" data-scroll-target="#filter-subset-rows"><span class="header-section-number">5.6.1</span> filter(): Subset Rows</a></li>
  <li><a href="#select-choose-columns" id="toc-select-choose-columns" class="nav-link" data-scroll-target="#select-choose-columns"><span class="header-section-number">5.6.2</span> select(): Choose Columns</a></li>
  <li><a href="#arrange-sort-rows" id="toc-arrange-sort-rows" class="nav-link" data-scroll-target="#arrange-sort-rows"><span class="header-section-number">5.6.3</span> arrange(): Sort Rows</a></li>
  <li><a href="#mutate-create-new-columns" id="toc-mutate-create-new-columns" class="nav-link" data-scroll-target="#mutate-create-new-columns"><span class="header-section-number">5.6.4</span> mutate(): Create New Columns</a></li>
  <li><a href="#summarize-aggregate-data" id="toc-summarize-aggregate-data" class="nav-link" data-scroll-target="#summarize-aggregate-data"><span class="header-section-number">5.6.5</span> summarize(): Aggregate Data</a></li>
  </ul></li>
  <li><a href="#grouping-with-group_by" id="toc-grouping-with-group_by" class="nav-link" data-scroll-target="#grouping-with-group_by"><span class="header-section-number">5.7</span> Grouping with group_by()</a></li>
  <li><a href="#the-pipe-operator" id="toc-the-pipe-operator" class="nav-link" data-scroll-target="#the-pipe-operator"><span class="header-section-number">5.8</span> The Pipe Operator</a></li>
  <li><a href="#handling-missing-values" id="toc-handling-missing-values" class="nav-link" data-scroll-target="#handling-missing-values"><span class="header-section-number">5.9</span> Handling Missing Values</a></li>
  <li><a href="#reshaping-data" id="toc-reshaping-data" class="nav-link" data-scroll-target="#reshaping-data"><span class="header-section-number">5.10</span> Reshaping Data</a></li>
  <li><a href="#joining-data" id="toc-joining-data" class="nav-link" data-scroll-target="#joining-data"><span class="header-section-number">5.11</span> Joining Data</a>
  <ul class="collapse">
  <li><a href="#types-of-joins" id="toc-types-of-joins" class="nav-link" data-scroll-target="#types-of-joins"><span class="header-section-number">5.11.1</span> Types of Joins</a></li>
  </ul></li>
  <li><a href="#additional-dplyr-functions" id="toc-additional-dplyr-functions" class="nav-link" data-scroll-target="#additional-dplyr-functions"><span class="header-section-number">5.12</span> Additional dplyr Functions</a>
  <ul class="collapse">
  <li><a href="#conditional-logic-with-case_when" id="toc-conditional-logic-with-case_when" class="nav-link" data-scroll-target="#conditional-logic-with-case_when"><span class="header-section-number">5.12.1</span> Conditional Logic with case_when()</a></li>
  <li><a href="#counting-with-count-and-n_distinct" id="toc-counting-with-count-and-n_distinct" class="nav-link" data-scroll-target="#counting-with-count-and-n_distinct"><span class="header-section-number">5.12.2</span> Counting with count() and n_distinct()</a></li>
  <li><a href="#selecting-rows-by-position-with-slice" id="toc-selecting-rows-by-position-with-slice" class="nav-link" data-scroll-target="#selecting-rows-by-position-with-slice"><span class="header-section-number">5.12.3</span> Selecting Rows by Position with slice()</a></li>
  <li><a href="#extracting-columns-with-pull" id="toc-extracting-columns-with-pull" class="nav-link" data-scroll-target="#extracting-columns-with-pull"><span class="header-section-number">5.12.4</span> Extracting Columns with pull()</a></li>
  <li><a href="#distinct-values-with-distinct" id="toc-distinct-values-with-distinct" class="nav-link" data-scroll-target="#distinct-values-with-distinct"><span class="header-section-number">5.12.5</span> Distinct Values with distinct()</a></li>
  </ul></li>
  <li><a href="#working-with-factors" id="toc-working-with-factors" class="nav-link" data-scroll-target="#working-with-factors"><span class="header-section-number">5.13</span> Working with Factors</a>
  <ul class="collapse">
  <li><a href="#reordering-factor-levels" id="toc-reordering-factor-levels" class="nav-link" data-scroll-target="#reordering-factor-levels"><span class="header-section-number">5.13.1</span> Reordering Factor Levels</a></li>
  <li><a href="#recoding-factor-levels" id="toc-recoding-factor-levels" class="nav-link" data-scroll-target="#recoding-factor-levels"><span class="header-section-number">5.13.2</span> Recoding Factor Levels</a></li>
  <li><a href="#collapsing-rare-levels" id="toc-collapsing-rare-levels" class="nav-link" data-scroll-target="#collapsing-rare-levels"><span class="header-section-number">5.13.3</span> Collapsing Rare Levels</a></li>
  </ul></li>
  <li><a href="#additional-tidyr-functions" id="toc-additional-tidyr-functions" class="nav-link" data-scroll-target="#additional-tidyr-functions"><span class="header-section-number">5.14</span> Additional tidyr Functions</a>
  <ul class="collapse">
  <li><a href="#separating-and-combining-columns" id="toc-separating-and-combining-columns" class="nav-link" data-scroll-target="#separating-and-combining-columns"><span class="header-section-number">5.14.1</span> Separating and Combining Columns</a></li>
  <li><a href="#handling-implicit-missing-values-with-complete" id="toc-handling-implicit-missing-values-with-complete" class="nav-link" data-scroll-target="#handling-implicit-missing-values-with-complete"><span class="header-section-number">5.14.2</span> Handling Implicit Missing Values with complete()</a></li>
  </ul></li>
  <li><a href="#practice-exercises" id="toc-practice-exercises" class="nav-link" data-scroll-target="#practice-exercises"><span class="header-section-number">5.15</span> Practice Exercises</a>
  <ul class="collapse">
  <li><a href="#exercise-t.1-tidyverse-basics" id="toc-exercise-t.1-tidyverse-basics" class="nav-link" data-scroll-target="#exercise-t.1-tidyverse-basics"><span class="header-section-number">5.15.1</span> Exercise T.1: Tidyverse Basics</a></li>
  <li><a href="#exercise-t.2-the-five-dplyr-verbs" id="toc-exercise-t.2-the-five-dplyr-verbs" class="nav-link" data-scroll-target="#exercise-t.2-the-five-dplyr-verbs"><span class="header-section-number">5.15.2</span> Exercise T.2: The Five dplyr Verbs</a></li>
  <li><a href="#exercise-t.3-grouping-and-summarizing" id="toc-exercise-t.3-grouping-and-summarizing" class="nav-link" data-scroll-target="#exercise-t.3-grouping-and-summarizing"><span class="header-section-number">5.15.3</span> Exercise T.3: Grouping and Summarizing</a></li>
  <li><a href="#exercise-t.4-data-wrangling-pipeline" id="toc-exercise-t.4-data-wrangling-pipeline" class="nav-link" data-scroll-target="#exercise-t.4-data-wrangling-pipeline"><span class="header-section-number">5.15.4</span> Exercise T.4: Data Wrangling Pipeline</a></li>
  <li><a href="#exercise-t.5-reshaping-data" id="toc-exercise-t.5-reshaping-data" class="nav-link" data-scroll-target="#exercise-t.5-reshaping-data"><span class="header-section-number">5.15.5</span> Exercise T.5: Reshaping Data</a></li>
  <li><a href="#exercise-t.6-joining-data" id="toc-exercise-t.6-joining-data" class="nav-link" data-scroll-target="#exercise-t.6-joining-data"><span class="header-section-number">5.15.6</span> Exercise T.6: Joining Data</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/01-introduction.html">Foundations of Data Science</a></li><li class="breadcrumb-item"><a href="../chapters/05-tidy-data.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Tidy Data and Data Wrangling</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span id="sec-tidy-data" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Tidy Data and Data Wrangling</span></span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/week_01.005.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<section id="what-is-tidy-data" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="what-is-tidy-data"><span class="header-section-number">5.1</span> What is Tidy Data?</h2>
<p>Data comes in many shapes, and not all shapes are equally convenient for analysis. The concept of “tidy data” provides a standard way to organize data that works well with R and makes many analyses straightforward. In tidy data, each variable forms a column, each observation forms a row, and each type of observational unit forms a table.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/week_01.006.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>This structure might seem obvious, but real-world data rarely arrives in tidy form. Spreadsheets often encode information in column names, spread a single variable across multiple columns, or combine multiple variables in a single column. Data wrangling is the process of transforming messy data into tidy data.</p>
</section>
<section id="rules-of-thumb-for-data-organization" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="rules-of-thumb-for-data-organization"><span class="header-section-number">5.2</span> Rules of Thumb for Data Organization</h2>
<p>Whether you are creating a new dataset or cleaning an existing one, following these principles will save you time and frustration.</p>
<p>Store a copy of your data in nonproprietary formats like plain text CSV files. Proprietary formats can become unreadable as software changes. Keep an uncorrected copy of your original data separate from any cleaned or processed versions. Use descriptive names for files and variables that convey meaning without requiring external documentation. Include a header row with variable names. Maintain metadata—a data dictionary explaining what each variable means, how it was measured, and what units it uses.</p>
<p>When you add new observations, add rows. When you add new variables, add columns. A column should contain only one data type—don’t mix numbers and text in the same column. Dates should be in a consistent format. Missing values should be represented consistently, typically as empty cells or <code>NA</code> in R.</p>
</section>
<section id="types-of-data" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="types-of-data"><span class="header-section-number">5.3</span> Types of Data</h2>
<p>Understanding the types of data you are working with guides how you analyze them.</p>
<p><strong>Categorical data</strong> classify observations into groups. Nominal categorical data have no inherent order—for example, species names, treatment groups, or colors. Ordinal categorical data have a meaningful order—ratings like “low,” “medium,” and “high,” or educational levels. In R, categorical data are often represented as factors, which store both the values and the set of possible levels.</p>
<p><strong>Quantitative data</strong> are numerical measurements. Interval data have meaningful differences between values but no true zero point—temperature in Celsius, where 0° does not mean “no temperature.” Ratio data have a true zero and meaningful ratios—mass, length, counts, where zero means “none” and twice as much is twice as much.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Categorical</th>
<th style="text-align: center;"></th>
<th style="text-align: center;">Quantitative</th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Ordinal</td>
<td style="text-align: center;">Nominal</td>
<td style="text-align: center;">Ratio</td>
<td style="text-align: center;">Interval</td>
</tr>
<tr class="even">
<td style="text-align: center;">small, medium, large</td>
<td style="text-align: center;">apples, oranges</td>
<td style="text-align: center;">kilograms, dollars</td>
<td style="text-align: center;">temperature, calendar year</td>
</tr>
<tr class="odd">
<td style="text-align: center;">ordered character</td>
<td style="text-align: center;">character</td>
<td style="text-align: center;">numeric</td>
<td style="text-align: center;">integer</td>
</tr>
</tbody>
</table>
</section>
<section id="the-tidyverse" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="the-tidyverse"><span class="header-section-number">5.4</span> The Tidyverse</h2>
<p>The tidyverse is a collection of R packages designed for data science. These packages share a common philosophy and are designed to work together seamlessly. The core tidyverse packages include <code>ggplot2</code> for visualization, <code>dplyr</code> for data manipulation, <code>tidyr</code> for reshaping data, <code>readr</code> for reading data files, and several others.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Loading the tidyverse loads all core packages at once. The message shows which packages are attached and notes any functions that conflict with base R or other packages.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/week_3.011.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section>
<section id="tibbles" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="tibbles"><span class="header-section-number">5.5</span> Tibbles</h2>
<p>Tibbles are the tidyverse’s enhanced data frames. They print more informatively, showing only the first few rows and as many columns as fit on screen, along with the dimensions and column types.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/week_3.012.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a tibble</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>my_tibble <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"Alice"</span>, <span class="st">"Bob"</span>, <span class="st">"Carol"</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">score =</span> <span class="fu">c</span>(<span class="dv">85</span>, <span class="dv">92</span>, <span class="dv">78</span>),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">passed =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>my_tibble</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  name  score passed
  &lt;chr&gt; &lt;dbl&gt; &lt;lgl&gt; 
1 Alice    85 TRUE  
2 Bob      92 TRUE  
3 Carol    78 TRUE  </code></pre>
</div>
</div>
<p>The column types are shown below the column names: <code>&lt;chr&gt;</code> for character, <code>&lt;dbl&gt;</code> for double (numeric), and <code>&lt;lgl&gt;</code> for logical.</p>
</section>
<section id="key-dplyr-verbs" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="key-dplyr-verbs"><span class="header-section-number">5.6</span> Key dplyr Verbs</h2>
<p>The <code>dplyr</code> package provides a grammar for data manipulation. Five key verbs handle most data manipulation tasks.</p>
<section id="filter-subset-rows" class="level3" data-number="5.6.1">
<h3 data-number="5.6.1" class="anchored" data-anchor-id="filter-subset-rows"><span class="header-section-number">5.6.1</span> filter(): Subset Rows</h3>
<p><code>filter()</code> selects rows that meet specified conditions.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Flights in November or December</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(flights, month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> month <span class="sc">==</span> <span class="dv">12</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Flights with arrival delay greater than 2 hours</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(flights, arr_delay <span class="sc">&gt;</span> <span class="dv">120</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Conditions use comparison operators: <code>==</code> (equals), <code>!=</code> (not equals), <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>. Combine conditions with <code>&amp;</code> (and) and <code>|</code> (or). The <code>%in%</code> operator checks membership in a set.</p>
</section>
<section id="select-choose-columns" class="level3" data-number="5.6.2">
<h3 data-number="5.6.2" class="anchored" data-anchor-id="select-choose-columns"><span class="header-section-number">5.6.2</span> select(): Choose Columns</h3>
<p><code>select()</code> picks columns by name.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select specific columns</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, year, month, day)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Select a range of columns</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, year<span class="sc">:</span>day)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop columns</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, <span class="sc">-</span>year, <span class="sc">-</span>month)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="arrange-sort-rows" class="level3" data-number="5.6.3">
<h3 data-number="5.6.3" class="anchored" data-anchor-id="arrange-sort-rows"><span class="header-section-number">5.6.3</span> arrange(): Sort Rows</h3>
<p><code>arrange()</code> reorders rows by column values.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by year, then month, then day</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(flights, year, month, day)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort in descending order</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(flights, <span class="fu">desc</span>(dep_delay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="mutate-create-new-columns" class="level3" data-number="5.6.4">
<h3 data-number="5.6.4" class="anchored" data-anchor-id="mutate-create-new-columns"><span class="header-section-number">5.6.4</span> mutate(): Create New Columns</h3>
<p><code>mutate()</code> adds new columns that are functions of existing columns.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(flights,</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">gain =</span> arr_delay <span class="sc">-</span> dep_delay,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">hours =</span> air_time <span class="sc">/</span> <span class="dv">60</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">gain_per_hour =</span> gain <span class="sc">/</span> hours</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="summarize-aggregate-data" class="level3" data-number="5.6.5">
<h3 data-number="5.6.5" class="anchored" data-anchor-id="summarize-aggregate-data"><span class="header-section-number">5.6.5</span> summarize(): Aggregate Data</h3>
<p><code>summarize()</code> collapses multiple rows into summary values.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(flights, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean_delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The <code>na.rm = TRUE</code> argument tells <code>mean()</code> to ignore missing values. The <code>n()</code> function counts rows.</p>
</section>
</section>
<section id="grouping-with-group_by" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="grouping-with-group_by"><span class="header-section-number">5.7</span> Grouping with group_by()</h2>
<p>The real power of <code>summarize()</code> emerges when combined with <code>group_by()</code>, which splits data into groups for separate analysis.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by destination, then summarize</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>by_dest <span class="ot">&lt;-</span> <span class="fu">group_by</span>(flights, dest)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(by_dest, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean_delay =</span> <span class="fu">mean</span>(arr_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This calculates summary statistics separately for each destination.</p>
</section>
<section id="the-pipe-operator" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="the-pipe-operator"><span class="header-section-number">5.8</span> The Pipe Operator</h2>
<p>Chaining multiple operations together can become unwieldy with nested function calls. The pipe operator <code>|&gt;</code> (or the tidyverse’s <code>%&gt;%</code>) passes the result of one operation as the first argument of the next, allowing you to read operations left-to-right, top-to-bottom.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Without pipe: nested and hard to read</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="fu">group_by</span>(<span class="fu">filter</span>(flights, <span class="sc">!</span><span class="fu">is.na</span>(arr_delay)), dest), </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean_delay =</span> <span class="fu">mean</span>(arr_delay))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># With pipe: clear sequence of operations</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(arr_delay)) <span class="sc">|&gt;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dest) <span class="sc">|&gt;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_delay =</span> <span class="fu">mean</span>(arr_delay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Read the pipe as “then”—take flights, then filter, then group, then summarize.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/week_3.015.jpeg" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
</section>
<section id="handling-missing-values" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="handling-missing-values"><span class="header-section-number">5.9</span> Handling Missing Values</h2>
<p>Missing values are a fact of life in real data. In R, missing values are represented as <code>NA</code>. Most operations involving <code>NA</code> return <code>NA</code>, which can cause problems if you are not careful.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">4</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.333333</code></pre>
</div>
</div>
<p>Check for missing values with <code>is.na()</code>:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE FALSE  TRUE FALSE</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(x))  <span class="co"># count missing values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p>Filter out missing values:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>x[<span class="sc">!</span><span class="fu">is.na</span>(x)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 4</code></pre>
</div>
</div>
<p>Or use tidyr functions:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows with any missing values</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">drop_na</span>(data)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows with missing values in specific columns</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">drop_na</span>(data, column_name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="reshaping-data" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="reshaping-data"><span class="header-section-number">5.10</span> Reshaping Data</h2>
<p>Sometimes data is not in the right shape for your analysis. The <code>tidyr</code> package provides functions to reshape data.</p>
<p><code>pivot_longer()</code> takes wide data (variables spread across columns) and makes it long (variables stacked in rows). <code>pivot_wider()</code> does the reverse.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: wide data</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>wide_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment_1 =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">12</span>),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment_2 =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">14</span>, <span class="dv">11</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>wide_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  sample treatment_1 treatment_2
  &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt;
1 A               10           8
2 B               15          14
3 C               12          11</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>long_data <span class="ot">&lt;-</span> wide_data <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"treatment"</span>),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"treatment"</span>,</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"response"</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>long_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  sample treatment   response
  &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;
1 A      treatment_1       10
2 A      treatment_2        8
3 B      treatment_1       15
4 B      treatment_2       14
5 C      treatment_1       12
6 C      treatment_2       11</code></pre>
</div>
</div>
</section>
<section id="joining-data" class="level2" data-number="5.11">
<h2 data-number="5.11" class="anchored" data-anchor-id="joining-data"><span class="header-section-number">5.11</span> Joining Data</h2>
<p>Often data comes in multiple tables that need to be combined. Join operations merge tables based on matching values in key columns.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example tables</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_id =</span> <span class="fu">c</span>(<span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span>),</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">concentration =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>measurements <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_id =</span> <span class="fu">c</span>(<span class="st">"S1"</span>, <span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span>, <span class="st">"S3"</span>),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">replicate =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(<span class="fl">2.3</span>, <span class="fl">2.1</span>, <span class="fl">5.4</span>, <span class="fl">5.6</span>, <span class="fl">10.2</span>, <span class="fl">10.8</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Join tables</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(measurements, samples, <span class="at">by =</span> <span class="st">"sample_id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  sample_id replicate value concentration
  &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;         &lt;dbl&gt;
1 S1                1   2.3           0.1
2 S1                2   2.1           0.1
3 S2                1   5.4           0.5
4 S2                2   5.6           0.5
5 S3                1  10.2           1  
6 S3                2  10.8           1  </code></pre>
</div>
</div>
<section id="types-of-joins" class="level3" data-number="5.11.1">
<h3 data-number="5.11.1" class="anchored" data-anchor-id="types-of-joins"><span class="header-section-number">5.11.1</span> Types of Joins</h3>
<p>Different joins handle non-matching rows differently. Understanding when to use each type is important for correct data analysis:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 57%">
<col style="width: 42%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Join Type</th>
<th style="text-align: left;">Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>left_join()</code></td>
<td style="text-align: left;">Keep all rows from left table, add matching data from right</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>right_join()</code></td>
<td style="text-align: left;">Keep all rows from right table, add matching data from left</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>inner_join()</code></td>
<td style="text-align: left;">Keep only rows with matches in both tables</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>full_join()</code></td>
<td style="text-align: left;">Keep all rows from both tables</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>semi_join()</code></td>
<td style="text-align: left;">Keep rows from left table that have matches in right</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>anti_join()</code></td>
<td style="text-align: left;">Keep rows from left table with NO matches in right</td>
</tr>
</tbody>
</table>
<p>The <code>anti_join()</code> is particularly useful for finding data quality issues—rows that should have matches but don’t:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Which measurements have no sample information?</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anti_join</span>(measurements, samples, <span class="at">by =</span> <span class="st">"sample_id"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="additional-dplyr-functions" class="level2" data-number="5.12">
<h2 data-number="5.12" class="anchored" data-anchor-id="additional-dplyr-functions"><span class="header-section-number">5.12</span> Additional dplyr Functions</h2>
<p>Beyond the five core verbs, dplyr provides many useful functions for common data manipulation tasks.</p>
<section id="conditional-logic-with-case_when" class="level3" data-number="5.12.1">
<h3 data-number="5.12.1" class="anchored" data-anchor-id="conditional-logic-with-case_when"><span class="header-section-number">5.12.1</span> Conditional Logic with case_when()</h3>
<p>The <code>case_when()</code> function is a vectorized if-else that handles multiple conditions:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>expression_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">gene =</span> <span class="fu">c</span>(<span class="st">"gene_A"</span>, <span class="st">"gene_B"</span>, <span class="st">"gene_C"</span>, <span class="st">"gene_D"</span>),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">fold_change =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.2</span>, <span class="fl">3.5</span>, <span class="sc">-</span><span class="fl">2.1</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>expression_data <span class="sc">|&gt;</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">regulation =</span> <span class="fu">case_when</span>(</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>      fold_change <span class="sc">&gt;</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"strongly up"</span>,</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>      fold_change <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"up"</span>,</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>      fold_change <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">~</span> <span class="st">"down"</span>,</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"unchanged"</span>  <span class="co"># default case</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  gene   fold_change regulation 
  &lt;chr&gt;        &lt;dbl&gt; &lt;chr&gt;      
1 gene_A         0.5 unchanged  
2 gene_B         1.2 up         
3 gene_C         3.5 strongly up
4 gene_D        -2.1 down       </code></pre>
</div>
</div>
</section>
<section id="counting-with-count-and-n_distinct" class="level3" data-number="5.12.2">
<h3 data-number="5.12.2" class="anchored" data-anchor-id="counting-with-count-and-n_distinct"><span class="header-section-number">5.12.2</span> Counting with count() and n_distinct()</h3>
<p>The <code>count()</code> function is a shortcut for grouping and counting:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Equivalent to: group_by(x) |&gt; summarize(n = n())</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> <span class="fu">count</span>(treatment)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by count</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> <span class="fu">count</span>(treatment, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Use <code>n_distinct()</code> inside <code>summarize()</code> to count unique values:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count unique samples per treatment group</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">|&gt;</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_samples =</span> <span class="fu">n_distinct</span>(sample_id))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="selecting-rows-by-position-with-slice" class="level3" data-number="5.12.3">
<h3 data-number="5.12.3" class="anchored" data-anchor-id="selecting-rows-by-position-with-slice"><span class="header-section-number">5.12.3</span> Selecting Rows by Position with slice()</h3>
<p>While <code>filter()</code> selects rows by condition, <code>slice()</code> selects by position:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First 3 rows</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using slice variants</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>)    <span class="co"># First 3 rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">slice_tail</span>(<span class="at">n =</span> <span class="dv">3</span>)    <span class="co"># Last 3 rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
1          6.5         3.0          5.2         2.0 virginica
2          6.2         3.4          5.4         2.3 virginica
3          5.9         3.0          5.1         1.8 virginica</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">5</span>)  <span class="co"># Random 5 rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
1          5.7         4.4          1.5         0.4     setosa
2          5.1         3.7          1.5         0.4     setosa
3          6.6         2.9          4.6         1.3 versicolor
4          6.5         3.0          5.5         1.8  virginica
5          6.9         3.1          5.1         2.3  virginica</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">slice_max</span>(Sepal.Length, <span class="at">n =</span> <span class="dv">3</span>)  <span class="co"># Top 3 by value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
1          7.9         3.8          6.4         2.0 virginica
2          7.7         3.8          6.7         2.2 virginica
3          7.7         2.6          6.9         2.3 virginica
4          7.7         2.8          6.7         2.0 virginica
5          7.7         3.0          6.1         2.3 virginica</code></pre>
</div>
</div>
</section>
<section id="extracting-columns-with-pull" class="level3" data-number="5.12.4">
<h3 data-number="5.12.4" class="anchored" data-anchor-id="extracting-columns-with-pull"><span class="header-section-number">5.12.4</span> Extracting Columns with pull()</h3>
<p>To extract a single column as a vector (rather than a data frame), use <code>pull()</code>:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Returns a vector, not a data frame</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Species <span class="sc">==</span> <span class="st">"setosa"</span>) <span class="sc">|&gt;</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Sepal.Length) <span class="sc">|&gt;</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.006</code></pre>
</div>
</div>
</section>
<section id="distinct-values-with-distinct" class="level3" data-number="5.12.5">
<h3 data-number="5.12.5" class="anchored" data-anchor-id="distinct-values-with-distinct"><span class="header-section-number">5.12.5</span> Distinct Values with distinct()</h3>
<p>Remove duplicate rows based on specified columns:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Unique values in one column</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> <span class="fu">distinct</span>(treatment)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Unique combinations of multiple columns</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> <span class="fu">distinct</span>(treatment, time_point)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="working-with-factors" class="level2" data-number="5.13">
<h2 data-number="5.13" class="anchored" data-anchor-id="working-with-factors"><span class="header-section-number">5.13</span> Working with Factors</h2>
<p>Factors are R’s way of representing categorical data with a fixed set of possible values (called levels). The <strong>forcats</strong> package (part of tidyverse) provides tools for working with factors.</p>
<section id="reordering-factor-levels" class="level3" data-number="5.13.1">
<h3 data-number="5.13.1" class="anchored" data-anchor-id="reordering-factor-levels"><span class="header-section-number">5.13.1</span> Reordering Factor Levels</h3>
<p>For visualization, you often want factor levels ordered by a value rather than alphabetically:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>gene_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">gene =</span> <span class="fu">c</span>(<span class="st">"BRCA1"</span>, <span class="st">"TP53"</span>, <span class="st">"EGFR"</span>, <span class="st">"KRAS"</span>, <span class="st">"MYC"</span>),</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">expression =</span> <span class="fu">c</span>(<span class="fl">5.2</span>, <span class="fl">8.1</span>, <span class="fl">3.4</span>, <span class="fl">6.7</span>, <span class="fl">9.2</span>)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Default: alphabetical order</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gene_data, <span class="fu">aes</span>(<span class="at">x =</span> gene, <span class="at">y =</span> expression)) <span class="sc">+</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Default (Alphabetical) Order"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-tidy-data_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder by expression value</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>gene_data <span class="sc">|&gt;</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gene =</span> <span class="fu">fct_reorder</span>(gene, expression)) <span class="sc">|&gt;</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gene, <span class="at">y =</span> expression)) <span class="sc">+</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Ordered by Expression"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="05-tidy-data_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="recoding-factor-levels" class="level3" data-number="5.13.2">
<h3 data-number="5.13.2" class="anchored" data-anchor-id="recoding-factor-levels"><span class="header-section-number">5.13.2</span> Recoding Factor Levels</h3>
<p>Use <code>fct_recode()</code> to change level names:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Original factor</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>status <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"WT"</span>, <span class="st">"KO"</span>, <span class="st">"HET"</span>, <span class="st">"KO"</span>))</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode to more descriptive names</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">fct_recode</span>(status,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Wild Type"</span> <span class="ot">=</span> <span class="st">"WT"</span>,</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Knockout"</span> <span class="ot">=</span> <span class="st">"KO"</span>,</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Heterozygous"</span> <span class="ot">=</span> <span class="st">"HET"</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Wild Type    Wild Type    Knockout     Heterozygous Knockout    
Levels: Heterozygous Knockout Wild Type</code></pre>
</div>
</div>
</section>
<section id="collapsing-rare-levels" class="level3" data-number="5.13.3">
<h3 data-number="5.13.3" class="anchored" data-anchor-id="collapsing-rare-levels"><span class="header-section-number">5.13.3</span> Collapsing Rare Levels</h3>
<p>Use <code>fct_lump_n()</code> to combine infrequent categories into “Other”:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample with many categories</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>many_categories <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>),</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">30</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">2</span>)))</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only the top 3 most common</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="fu">fct_lump_n</span>(many_categories, <span class="at">n =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] A     A     A     A     A     A     A     A     A     A     A     A    
 [13] A     A     A     A     A     A     A     A     A     A     A     A    
 [25] A     A     A     A     A     A     A     A     A     A     A     A    
 [37] A     A     A     A     A     A     A     A     A     A     A     A    
 [49] A     A     B     B     B     B     B     B     B     B     B     B    
 [61] B     B     B     B     B     B     B     B     B     B     B     B    
 [73] B     B     B     B     B     B     B     B     C     C     C     C    
 [85] C     C     C     C     C     C     Other Other Other Other Other Other
 [97] Other Other Other Other
Levels: A B C Other</code></pre>
</div>
</div>
</section>
</section>
<section id="additional-tidyr-functions" class="level2" data-number="5.14">
<h2 data-number="5.14" class="anchored" data-anchor-id="additional-tidyr-functions"><span class="header-section-number">5.14</span> Additional tidyr Functions</h2>
<section id="separating-and-combining-columns" class="level3" data-number="5.14.1">
<h3 data-number="5.14.1" class="anchored" data-anchor-id="separating-and-combining-columns"><span class="header-section-number">5.14.1</span> Separating and Combining Columns</h3>
<p><code>separate()</code> splits one column into multiple columns; <code>unite()</code> combines columns:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data with combined values</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample =</span> <span class="fu">c</span>(<span class="st">"control_rep1"</span>, <span class="st">"control_rep2"</span>, <span class="st">"treatment_rep1"</span>),</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">25</span>)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate into treatment and replicate</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>combined_data <span class="sc">|&gt;</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(sample, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"treatment"</span>, <span class="st">"replicate"</span>), <span class="at">sep =</span> <span class="st">"_"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
  treatment replicate value
  &lt;chr&gt;     &lt;chr&gt;     &lt;dbl&gt;
1 control   rep1         10
2 control   rep2         12
3 treatment rep1         25</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine columns</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">year =</span> <span class="dv">2024</span>, <span class="at">month =</span> <span class="dv">3</span>, <span class="at">day =</span> <span class="dv">15</span>) <span class="sc">|&gt;</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(date, year, month, day, <span class="at">sep =</span> <span class="st">"-"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  date     
  &lt;chr&gt;    
1 2024-3-15</code></pre>
</div>
</div>
</section>
<section id="handling-implicit-missing-values-with-complete" class="level3" data-number="5.14.2">
<h3 data-number="5.14.2" class="anchored" data-anchor-id="handling-implicit-missing-values-with-complete"><span class="header-section-number">5.14.2</span> Handling Implicit Missing Values with complete()</h3>
<p>Sometimes data has implicit missing values—combinations that should exist but don’t appear. <code>complete()</code> makes them explicit:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Implicit missing: no observation for site B in year 2021</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>observations <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">site =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>),</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">2021</span>, <span class="dv">2020</span>),</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">count =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">8</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Make all combinations explicit</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>observations <span class="sc">|&gt;</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(site, year, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">count =</span> <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 3
  site   year count
  &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
1 A      2020    10
2 A      2021    15
3 B      2020     8
4 B      2021     0</code></pre>
</div>
</div>
</section>
</section>
<section id="practice-exercises" class="level2" data-number="5.15">
<h2 data-number="5.15" class="anchored" data-anchor-id="practice-exercises"><span class="header-section-number">5.15</span> Practice Exercises</h2>
<section id="exercise-t.1-tidyverse-basics" class="level3" data-number="5.15.1">
<h3 data-number="5.15.1" class="anchored" data-anchor-id="exercise-t.1-tidyverse-basics"><span class="header-section-number">5.15.1</span> Exercise T.1: Tidyverse Basics</h3>
<p>Load the tidyverse and practice with a dataset:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol type="1">
<li>Convert the <code>mpg</code> data frame to a tibble using <code>as_tibble()</code></li>
<li>What differences do you notice in how it prints?</li>
<li>Use <code>glimpse()</code> to get an overview of the data</li>
</ol>
</section>
<section id="exercise-t.2-the-five-dplyr-verbs" class="level3" data-number="5.15.2">
<h3 data-number="5.15.2" class="anchored" data-anchor-id="exercise-t.2-the-five-dplyr-verbs"><span class="header-section-number">5.15.2</span> Exercise T.2: The Five dplyr Verbs</h3>
<p>Using the <code>mpg</code> dataset, practice each core verb:</p>
<ol type="1">
<li><strong>filter()</strong>: Select only cars with highway mpg greater than 30</li>
<li><strong>select()</strong>: Choose only the manufacturer, model, and highway mpg columns</li>
<li><strong>arrange()</strong>: Sort by highway mpg in descending order</li>
<li><strong>mutate()</strong>: Create a new column that calculates the ratio of highway to city mpg</li>
<li><strong>summarize()</strong>: Calculate the mean highway mpg for the entire dataset</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example solutions:</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> <span class="fu">filter</span>(hwy <span class="sc">&gt;</span> <span class="dv">30</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> <span class="fu">select</span>(manufacturer, model, hwy)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(hwy))</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">hwy_city_ratio =</span> hwy <span class="sc">/</span> cty)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">mean_hwy =</span> <span class="fu">mean</span>(hwy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exercise-t.3-grouping-and-summarizing" class="level3" data-number="5.15.3">
<h3 data-number="5.15.3" class="anchored" data-anchor-id="exercise-t.3-grouping-and-summarizing"><span class="header-section-number">5.15.3</span> Exercise T.3: Grouping and Summarizing</h3>
<ol type="1">
<li>Group the <code>mpg</code> data by manufacturer and calculate the mean highway mpg for each</li>
<li>Find the manufacturer with the highest average highway mpg</li>
<li>Count how many models each manufacturer has in the dataset</li>
<li>Calculate both mean and standard deviation of highway mpg by vehicle class</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">|&gt;</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(manufacturer) <span class="sc">|&gt;</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_hwy =</span> <span class="fu">mean</span>(hwy),</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_models =</span> <span class="fu">n</span>()</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mean_hwy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exercise-t.4-data-wrangling-pipeline" class="level3" data-number="5.15.4">
<h3 data-number="5.15.4" class="anchored" data-anchor-id="exercise-t.4-data-wrangling-pipeline"><span class="header-section-number">5.15.4</span> Exercise T.4: Data Wrangling Pipeline</h3>
<p>Construct a pipeline that:</p>
<ol type="1">
<li>Filters for a subset of manufacturers (e.g., “audi”, “toyota”, “honda”)</li>
<li>Selects relevant columns</li>
<li>Creates a new calculated column</li>
<li>Groups by a categorical variable</li>
<li>Summarizes with multiple statistics</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">|&gt;</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(manufacturer <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"audi"</span>, <span class="st">"toyota"</span>, <span class="st">"honda"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(manufacturer, model, year, cty, hwy) <span class="sc">|&gt;</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">avg_mpg =</span> (cty <span class="sc">+</span> hwy) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(manufacturer) <span class="sc">|&gt;</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_mpg =</span> <span class="fu">mean</span>(avg_mpg),</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_mpg =</span> <span class="fu">sd</span>(avg_mpg),</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="exercise-t.5-reshaping-data" class="level3" data-number="5.15.5">
<h3 data-number="5.15.5" class="anchored" data-anchor-id="exercise-t.5-reshaping-data"><span class="header-section-number">5.15.5</span> Exercise T.5: Reshaping Data</h3>
<p>Practice with <code>pivot_longer()</code> and <code>pivot_wider()</code>:</p>
<ol type="1">
<li>Create a wide dataset with measurements across multiple time points</li>
<li>Convert it to long format using <code>pivot_longer()</code></li>
<li>Convert it back to wide format using <code>pivot_wider()</code></li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example wide data</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>wide_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_0 =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">8</span>),</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_1 =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">12</span>),</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_2 =</span> <span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">25</span>, <span class="dv">18</span>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>long_data <span class="ot">&lt;-</span> wide_data <span class="sc">|&gt;</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"time"</span>),</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"timepoint"</span>,</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"measurement"</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(long_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 3
  sample timepoint measurement
  &lt;chr&gt;  &lt;chr&gt;           &lt;dbl&gt;
1 A      time_0             10
2 A      time_1             15
3 A      time_2             22
4 B      time_0             12
5 B      time_1             18
6 B      time_2             25
7 C      time_0              8
8 C      time_1             12
9 C      time_2             18</code></pre>
</div>
</div>
</section>
<section id="exercise-t.6-joining-data" class="level3" data-number="5.15.6">
<h3 data-number="5.15.6" class="anchored" data-anchor-id="exercise-t.6-joining-data"><span class="header-section-number">5.15.6</span> Exercise T.6: Joining Data</h3>
<p>Create two related tibbles and practice joins:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>experiments <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_id =</span> <span class="fu">c</span>(<span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span>, <span class="st">"S4"</span>),</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span>)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>measurements <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_id =</span> <span class="fu">c</span>(<span class="st">"S1"</span>, <span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span>),</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">replicate =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(<span class="fl">10.2</span>, <span class="fl">9.8</span>, <span class="fl">15.3</span>, <span class="fl">18.7</span>)</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ol type="1">
<li>Perform a <code>left_join()</code> to add treatment information to measurements</li>
<li>Use <code>anti_join()</code> to find samples that have no measurements</li>
<li>Explain the difference between <code>inner_join()</code> and <code>full_join()</code></li>
</ol>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/04-markdown-latex.html" class="pagination-link" aria-label="Markdown and LaTeX">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Markdown and LaTeX</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/06-data-visualization.html" class="pagination-link" aria-label="Data Visualization">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Data Visualization</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb65" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Tidy Data and Data Wrangling {#sec-tidy-data}</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>())</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="al">![](../images/week_01.005.jpeg)</span>{fig-align="center"}</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a><span class="fu">## What is Tidy Data?</span></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>Data comes in many shapes, and not all shapes are equally convenient for analysis. The concept of "tidy data" provides a standard way to organize data that works well with R and makes many analyses straightforward. In tidy data, each variable forms a column, each observation forms a row, and each type of observational unit forms a table.</span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a><span class="al">![](../images/week_01.006.jpeg)</span>{fig-align="center"}</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a>This structure might seem obvious, but real-world data rarely arrives in tidy form. Spreadsheets often encode information in column names, spread a single variable across multiple columns, or combine multiple variables in a single column. Data wrangling is the process of transforming messy data into tidy data.</span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rules of Thumb for Data Organization</span></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>Whether you are creating a new dataset or cleaning an existing one, following these principles will save you time and frustration.</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a>Store a copy of your data in nonproprietary formats like plain text CSV files. Proprietary formats can become unreadable as software changes. Keep an uncorrected copy of your original data separate from any cleaned or processed versions. Use descriptive names for files and variables that convey meaning without requiring external documentation. Include a header row with variable names. Maintain metadata—a data dictionary explaining what each variable means, how it was measured, and what units it uses.</span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a>When you add new observations, add rows. When you add new variables, add columns. A column should contain only one data type—don't mix numbers and text in the same column. Dates should be in a consistent format. Missing values should be represented consistently, typically as empty cells or <span class="in">`NA`</span> in R.</span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a><span class="fu">## Types of Data</span></span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a>Understanding the types of data you are working with guides how you analyze them.</span>
<span id="cb65-33"><a href="#cb65-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-34"><a href="#cb65-34" aria-hidden="true" tabindex="-1"></a>**Categorical data** classify observations into groups. Nominal categorical data have no inherent order—for example, species names, treatment groups, or colors. Ordinal categorical data have a meaningful order—ratings like "low," "medium," and "high," or educational levels. In R, categorical data are often represented as factors, which store both the values and the set of possible levels.</span>
<span id="cb65-35"><a href="#cb65-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-36"><a href="#cb65-36" aria-hidden="true" tabindex="-1"></a>**Quantitative data** are numerical measurements. Interval data have meaningful differences between values but no true zero point—temperature in Celsius, where 0° does not mean "no temperature." Ratio data have a true zero and meaningful ratios—mass, length, counts, where zero means "none" and twice as much is twice as much.</span>
<span id="cb65-37"><a href="#cb65-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-38"><a href="#cb65-38" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Categorical <span class="pp">|</span> <span class="pp">|</span> Quantitative <span class="pp">|</span> <span class="pp">|</span></span>
<span id="cb65-39"><a href="#cb65-39" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>:--:<span class="pp">|</span>:--:<span class="pp">|</span>:--:<span class="pp">|</span>:--:<span class="pp">|</span></span>
<span id="cb65-40"><a href="#cb65-40" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Ordinal <span class="pp">|</span> Nominal <span class="pp">|</span> Ratio <span class="pp">|</span> Interval <span class="pp">|</span></span>
<span id="cb65-41"><a href="#cb65-41" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> small, medium, large <span class="pp">|</span> apples, oranges <span class="pp">|</span> kilograms, dollars <span class="pp">|</span> temperature, calendar year <span class="pp">|</span></span>
<span id="cb65-42"><a href="#cb65-42" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> ordered character <span class="pp">|</span> character <span class="pp">|</span> numeric <span class="pp">|</span> integer <span class="pp">|</span></span>
<span id="cb65-43"><a href="#cb65-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-44"><a href="#cb65-44" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Tidyverse</span></span>
<span id="cb65-45"><a href="#cb65-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-46"><a href="#cb65-46" aria-hidden="true" tabindex="-1"></a>The tidyverse is a collection of R packages designed for data science. These packages share a common philosophy and are designed to work together seamlessly. The core tidyverse packages include <span class="in">`ggplot2`</span> for visualization, <span class="in">`dplyr`</span> for data manipulation, <span class="in">`tidyr`</span> for reshaping data, <span class="in">`readr`</span> for reading data files, and several others.</span>
<span id="cb65-47"><a href="#cb65-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-50"><a href="#cb65-50" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-51"><a href="#cb65-51" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: true</span></span>
<span id="cb65-52"><a href="#cb65-52" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb65-53"><a href="#cb65-53" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-54"><a href="#cb65-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-55"><a href="#cb65-55" aria-hidden="true" tabindex="-1"></a>Loading the tidyverse loads all core packages at once. The message shows which packages are attached and notes any functions that conflict with base R or other packages.</span>
<span id="cb65-56"><a href="#cb65-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-57"><a href="#cb65-57" aria-hidden="true" tabindex="-1"></a><span class="al">![](../images/week_3.011.jpeg)</span>{fig-align="center"}</span>
<span id="cb65-58"><a href="#cb65-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-59"><a href="#cb65-59" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tibbles</span></span>
<span id="cb65-60"><a href="#cb65-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-61"><a href="#cb65-61" aria-hidden="true" tabindex="-1"></a>Tibbles are the tidyverse's enhanced data frames. They print more informatively, showing only the first few rows and as many columns as fit on screen, along with the dimensions and column types.</span>
<span id="cb65-62"><a href="#cb65-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-63"><a href="#cb65-63" aria-hidden="true" tabindex="-1"></a><span class="al">![](../images/week_3.012.jpeg)</span>{fig-align="center"}</span>
<span id="cb65-64"><a href="#cb65-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-67"><a href="#cb65-67" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-68"><a href="#cb65-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a tibble</span></span>
<span id="cb65-69"><a href="#cb65-69" aria-hidden="true" tabindex="-1"></a>my_tibble <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb65-70"><a href="#cb65-70" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"Alice"</span>, <span class="st">"Bob"</span>, <span class="st">"Carol"</span>),</span>
<span id="cb65-71"><a href="#cb65-71" aria-hidden="true" tabindex="-1"></a>  <span class="at">score =</span> <span class="fu">c</span>(<span class="dv">85</span>, <span class="dv">92</span>, <span class="dv">78</span>),</span>
<span id="cb65-72"><a href="#cb65-72" aria-hidden="true" tabindex="-1"></a>  <span class="at">passed =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span>)</span>
<span id="cb65-73"><a href="#cb65-73" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-74"><a href="#cb65-74" aria-hidden="true" tabindex="-1"></a>my_tibble</span>
<span id="cb65-75"><a href="#cb65-75" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-76"><a href="#cb65-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-77"><a href="#cb65-77" aria-hidden="true" tabindex="-1"></a>The column types are shown below the column names: <span class="in">`&lt;chr&gt;`</span> for character, <span class="in">`&lt;dbl&gt;`</span> for double (numeric), and <span class="in">`&lt;lgl&gt;`</span> for logical.</span>
<span id="cb65-78"><a href="#cb65-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-79"><a href="#cb65-79" aria-hidden="true" tabindex="-1"></a><span class="fu">## Key dplyr Verbs</span></span>
<span id="cb65-80"><a href="#cb65-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-81"><a href="#cb65-81" aria-hidden="true" tabindex="-1"></a>The <span class="in">`dplyr`</span> package provides a grammar for data manipulation. Five key verbs handle most data manipulation tasks.</span>
<span id="cb65-82"><a href="#cb65-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-83"><a href="#cb65-83" aria-hidden="true" tabindex="-1"></a><span class="fu">### filter(): Subset Rows</span></span>
<span id="cb65-84"><a href="#cb65-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-85"><a href="#cb65-85" aria-hidden="true" tabindex="-1"></a><span class="in">`filter()`</span> selects rows that meet specified conditions.</span>
<span id="cb65-86"><a href="#cb65-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-89"><a href="#cb65-89" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-90"><a href="#cb65-90" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb65-91"><a href="#cb65-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Flights in November or December</span></span>
<span id="cb65-92"><a href="#cb65-92" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(flights, month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> month <span class="sc">==</span> <span class="dv">12</span>)</span>
<span id="cb65-93"><a href="#cb65-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-94"><a href="#cb65-94" aria-hidden="true" tabindex="-1"></a><span class="co"># Flights with arrival delay greater than 2 hours</span></span>
<span id="cb65-95"><a href="#cb65-95" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(flights, arr_delay <span class="sc">&gt;</span> <span class="dv">120</span>)</span>
<span id="cb65-96"><a href="#cb65-96" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-97"><a href="#cb65-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-98"><a href="#cb65-98" aria-hidden="true" tabindex="-1"></a>Conditions use comparison operators: <span class="in">`==`</span> (equals), <span class="in">`!=`</span> (not equals), <span class="in">`&lt;`</span>, <span class="in">`&gt;`</span>, <span class="in">`&lt;=`</span>, <span class="in">`&gt;=`</span>. Combine conditions with <span class="in">`&amp;`</span> (and) and <span class="in">`|`</span> (or). The <span class="in">`%in%`</span> operator checks membership in a set.</span>
<span id="cb65-99"><a href="#cb65-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-100"><a href="#cb65-100" aria-hidden="true" tabindex="-1"></a><span class="fu">### select(): Choose Columns</span></span>
<span id="cb65-101"><a href="#cb65-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-102"><a href="#cb65-102" aria-hidden="true" tabindex="-1"></a><span class="in">`select()`</span> picks columns by name.</span>
<span id="cb65-103"><a href="#cb65-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-106"><a href="#cb65-106" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-107"><a href="#cb65-107" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb65-108"><a href="#cb65-108" aria-hidden="true" tabindex="-1"></a><span class="co"># Select specific columns</span></span>
<span id="cb65-109"><a href="#cb65-109" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, year, month, day)</span>
<span id="cb65-110"><a href="#cb65-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-111"><a href="#cb65-111" aria-hidden="true" tabindex="-1"></a><span class="co"># Select a range of columns</span></span>
<span id="cb65-112"><a href="#cb65-112" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, year<span class="sc">:</span>day)</span>
<span id="cb65-113"><a href="#cb65-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-114"><a href="#cb65-114" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop columns</span></span>
<span id="cb65-115"><a href="#cb65-115" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(flights, <span class="sc">-</span>year, <span class="sc">-</span>month)</span>
<span id="cb65-116"><a href="#cb65-116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-117"><a href="#cb65-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-118"><a href="#cb65-118" aria-hidden="true" tabindex="-1"></a><span class="fu">### arrange(): Sort Rows</span></span>
<span id="cb65-119"><a href="#cb65-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-120"><a href="#cb65-120" aria-hidden="true" tabindex="-1"></a><span class="in">`arrange()`</span> reorders rows by column values.</span>
<span id="cb65-121"><a href="#cb65-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-124"><a href="#cb65-124" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-125"><a href="#cb65-125" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb65-126"><a href="#cb65-126" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by year, then month, then day</span></span>
<span id="cb65-127"><a href="#cb65-127" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(flights, year, month, day)</span>
<span id="cb65-128"><a href="#cb65-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-129"><a href="#cb65-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort in descending order</span></span>
<span id="cb65-130"><a href="#cb65-130" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(flights, <span class="fu">desc</span>(dep_delay))</span>
<span id="cb65-131"><a href="#cb65-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-132"><a href="#cb65-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-133"><a href="#cb65-133" aria-hidden="true" tabindex="-1"></a><span class="fu">### mutate(): Create New Columns</span></span>
<span id="cb65-134"><a href="#cb65-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-135"><a href="#cb65-135" aria-hidden="true" tabindex="-1"></a><span class="in">`mutate()`</span> adds new columns that are functions of existing columns.</span>
<span id="cb65-136"><a href="#cb65-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-139"><a href="#cb65-139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-140"><a href="#cb65-140" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb65-141"><a href="#cb65-141" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(flights,</span>
<span id="cb65-142"><a href="#cb65-142" aria-hidden="true" tabindex="-1"></a>  <span class="at">gain =</span> arr_delay <span class="sc">-</span> dep_delay,</span>
<span id="cb65-143"><a href="#cb65-143" aria-hidden="true" tabindex="-1"></a>  <span class="at">hours =</span> air_time <span class="sc">/</span> <span class="dv">60</span>,</span>
<span id="cb65-144"><a href="#cb65-144" aria-hidden="true" tabindex="-1"></a>  <span class="at">gain_per_hour =</span> gain <span class="sc">/</span> hours</span>
<span id="cb65-145"><a href="#cb65-145" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-146"><a href="#cb65-146" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-147"><a href="#cb65-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-148"><a href="#cb65-148" aria-hidden="true" tabindex="-1"></a><span class="fu">### summarize(): Aggregate Data</span></span>
<span id="cb65-149"><a href="#cb65-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-150"><a href="#cb65-150" aria-hidden="true" tabindex="-1"></a><span class="in">`summarize()`</span> collapses multiple rows into summary values.</span>
<span id="cb65-151"><a href="#cb65-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-154"><a href="#cb65-154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-155"><a href="#cb65-155" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb65-156"><a href="#cb65-156" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(flights, </span>
<span id="cb65-157"><a href="#cb65-157" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean_delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb65-158"><a href="#cb65-158" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb65-159"><a href="#cb65-159" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-160"><a href="#cb65-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-161"><a href="#cb65-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-162"><a href="#cb65-162" aria-hidden="true" tabindex="-1"></a>The <span class="in">`na.rm = TRUE`</span> argument tells <span class="in">`mean()`</span> to ignore missing values. The <span class="in">`n()`</span> function counts rows.</span>
<span id="cb65-163"><a href="#cb65-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-164"><a href="#cb65-164" aria-hidden="true" tabindex="-1"></a><span class="fu">## Grouping with group_by()</span></span>
<span id="cb65-165"><a href="#cb65-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-166"><a href="#cb65-166" aria-hidden="true" tabindex="-1"></a>The real power of <span class="in">`summarize()`</span> emerges when combined with <span class="in">`group_by()`</span>, which splits data into groups for separate analysis.</span>
<span id="cb65-167"><a href="#cb65-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-170"><a href="#cb65-170" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-171"><a href="#cb65-171" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb65-172"><a href="#cb65-172" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by destination, then summarize</span></span>
<span id="cb65-173"><a href="#cb65-173" aria-hidden="true" tabindex="-1"></a>by_dest <span class="ot">&lt;-</span> <span class="fu">group_by</span>(flights, dest)</span>
<span id="cb65-174"><a href="#cb65-174" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(by_dest, </span>
<span id="cb65-175"><a href="#cb65-175" aria-hidden="true" tabindex="-1"></a>  <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb65-176"><a href="#cb65-176" aria-hidden="true" tabindex="-1"></a>  <span class="at">mean_delay =</span> <span class="fu">mean</span>(arr_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-177"><a href="#cb65-177" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-178"><a href="#cb65-178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-179"><a href="#cb65-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-180"><a href="#cb65-180" aria-hidden="true" tabindex="-1"></a>This calculates summary statistics separately for each destination.</span>
<span id="cb65-181"><a href="#cb65-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-182"><a href="#cb65-182" aria-hidden="true" tabindex="-1"></a><span class="fu">## The Pipe Operator</span></span>
<span id="cb65-183"><a href="#cb65-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-184"><a href="#cb65-184" aria-hidden="true" tabindex="-1"></a>Chaining multiple operations together can become unwieldy with nested function calls. The pipe operator <span class="in">`|&gt;`</span> (or the tidyverse's <span class="in">`%&gt;%`</span>) passes the result of one operation as the first argument of the next, allowing you to read operations left-to-right, top-to-bottom.</span>
<span id="cb65-185"><a href="#cb65-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-188"><a href="#cb65-188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-189"><a href="#cb65-189" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb65-190"><a href="#cb65-190" aria-hidden="true" tabindex="-1"></a><span class="co"># Without pipe: nested and hard to read</span></span>
<span id="cb65-191"><a href="#cb65-191" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(<span class="fu">group_by</span>(<span class="fu">filter</span>(flights, <span class="sc">!</span><span class="fu">is.na</span>(arr_delay)), dest), </span>
<span id="cb65-192"><a href="#cb65-192" aria-hidden="true" tabindex="-1"></a>          <span class="at">mean_delay =</span> <span class="fu">mean</span>(arr_delay))</span>
<span id="cb65-193"><a href="#cb65-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-194"><a href="#cb65-194" aria-hidden="true" tabindex="-1"></a><span class="co"># With pipe: clear sequence of operations</span></span>
<span id="cb65-195"><a href="#cb65-195" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">|&gt;</span></span>
<span id="cb65-196"><a href="#cb65-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(arr_delay)) <span class="sc">|&gt;</span></span>
<span id="cb65-197"><a href="#cb65-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(dest) <span class="sc">|&gt;</span></span>
<span id="cb65-198"><a href="#cb65-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mean_delay =</span> <span class="fu">mean</span>(arr_delay))</span>
<span id="cb65-199"><a href="#cb65-199" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-200"><a href="#cb65-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-201"><a href="#cb65-201" aria-hidden="true" tabindex="-1"></a>Read the pipe as "then"—take flights, then filter, then group, then summarize.</span>
<span id="cb65-202"><a href="#cb65-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-203"><a href="#cb65-203" aria-hidden="true" tabindex="-1"></a><span class="al">![](../images/week_3.015.jpeg)</span>{fig-align="center"}</span>
<span id="cb65-204"><a href="#cb65-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-205"><a href="#cb65-205" aria-hidden="true" tabindex="-1"></a><span class="fu">## Handling Missing Values</span></span>
<span id="cb65-206"><a href="#cb65-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-207"><a href="#cb65-207" aria-hidden="true" tabindex="-1"></a>Missing values are a fact of life in real data. In R, missing values are represented as <span class="in">`NA`</span>. Most operations involving <span class="in">`NA`</span> return <span class="in">`NA`</span>, which can cause problems if you are not careful.</span>
<span id="cb65-208"><a href="#cb65-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-211"><a href="#cb65-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-212"><a href="#cb65-212" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="cn">NA</span>, <span class="dv">4</span>)</span>
<span id="cb65-213"><a href="#cb65-213" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span>
<span id="cb65-214"><a href="#cb65-214" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-215"><a href="#cb65-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-216"><a href="#cb65-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-217"><a href="#cb65-217" aria-hidden="true" tabindex="-1"></a>Check for missing values with <span class="in">`is.na()`</span>:</span>
<span id="cb65-218"><a href="#cb65-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-221"><a href="#cb65-221" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-222"><a href="#cb65-222" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(x)</span>
<span id="cb65-223"><a href="#cb65-223" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(x))  <span class="co"># count missing values</span></span>
<span id="cb65-224"><a href="#cb65-224" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-225"><a href="#cb65-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-226"><a href="#cb65-226" aria-hidden="true" tabindex="-1"></a>Filter out missing values:</span>
<span id="cb65-227"><a href="#cb65-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-230"><a href="#cb65-230" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-231"><a href="#cb65-231" aria-hidden="true" tabindex="-1"></a>x[<span class="sc">!</span><span class="fu">is.na</span>(x)]</span>
<span id="cb65-232"><a href="#cb65-232" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-233"><a href="#cb65-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-234"><a href="#cb65-234" aria-hidden="true" tabindex="-1"></a>Or use tidyr functions:</span>
<span id="cb65-235"><a href="#cb65-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-238"><a href="#cb65-238" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-239"><a href="#cb65-239" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb65-240"><a href="#cb65-240" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows with any missing values</span></span>
<span id="cb65-241"><a href="#cb65-241" aria-hidden="true" tabindex="-1"></a><span class="fu">drop_na</span>(data)</span>
<span id="cb65-242"><a href="#cb65-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-243"><a href="#cb65-243" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove rows with missing values in specific columns</span></span>
<span id="cb65-244"><a href="#cb65-244" aria-hidden="true" tabindex="-1"></a><span class="fu">drop_na</span>(data, column_name)</span>
<span id="cb65-245"><a href="#cb65-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-246"><a href="#cb65-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-247"><a href="#cb65-247" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reshaping Data</span></span>
<span id="cb65-248"><a href="#cb65-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-249"><a href="#cb65-249" aria-hidden="true" tabindex="-1"></a>Sometimes data is not in the right shape for your analysis. The <span class="in">`tidyr`</span> package provides functions to reshape data.</span>
<span id="cb65-250"><a href="#cb65-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-251"><a href="#cb65-251" aria-hidden="true" tabindex="-1"></a><span class="in">`pivot_longer()`</span> takes wide data (variables spread across columns) and makes it long (variables stacked in rows). <span class="in">`pivot_wider()`</span> does the reverse.</span>
<span id="cb65-252"><a href="#cb65-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-255"><a href="#cb65-255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-256"><a href="#cb65-256" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: wide data</span></span>
<span id="cb65-257"><a href="#cb65-257" aria-hidden="true" tabindex="-1"></a>wide_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb65-258"><a href="#cb65-258" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),</span>
<span id="cb65-259"><a href="#cb65-259" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment_1 =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">12</span>),</span>
<span id="cb65-260"><a href="#cb65-260" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment_2 =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">14</span>, <span class="dv">11</span>)</span>
<span id="cb65-261"><a href="#cb65-261" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-262"><a href="#cb65-262" aria-hidden="true" tabindex="-1"></a>wide_data</span>
<span id="cb65-263"><a href="#cb65-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-264"><a href="#cb65-264" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format</span></span>
<span id="cb65-265"><a href="#cb65-265" aria-hidden="true" tabindex="-1"></a>long_data <span class="ot">&lt;-</span> wide_data <span class="sc">|&gt;</span></span>
<span id="cb65-266"><a href="#cb65-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb65-267"><a href="#cb65-267" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"treatment"</span>),</span>
<span id="cb65-268"><a href="#cb65-268" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"treatment"</span>,</span>
<span id="cb65-269"><a href="#cb65-269" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"response"</span></span>
<span id="cb65-270"><a href="#cb65-270" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb65-271"><a href="#cb65-271" aria-hidden="true" tabindex="-1"></a>long_data</span>
<span id="cb65-272"><a href="#cb65-272" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-273"><a href="#cb65-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-274"><a href="#cb65-274" aria-hidden="true" tabindex="-1"></a><span class="fu">## Joining Data</span></span>
<span id="cb65-275"><a href="#cb65-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-276"><a href="#cb65-276" aria-hidden="true" tabindex="-1"></a>Often data comes in multiple tables that need to be combined. Join operations merge tables based on matching values in key columns.</span>
<span id="cb65-277"><a href="#cb65-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-280"><a href="#cb65-280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-281"><a href="#cb65-281" aria-hidden="true" tabindex="-1"></a><span class="co"># Example tables</span></span>
<span id="cb65-282"><a href="#cb65-282" aria-hidden="true" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb65-283"><a href="#cb65-283" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_id =</span> <span class="fu">c</span>(<span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span>),</span>
<span id="cb65-284"><a href="#cb65-284" aria-hidden="true" tabindex="-1"></a>  <span class="at">concentration =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span>)</span>
<span id="cb65-285"><a href="#cb65-285" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-286"><a href="#cb65-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-287"><a href="#cb65-287" aria-hidden="true" tabindex="-1"></a>measurements <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb65-288"><a href="#cb65-288" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_id =</span> <span class="fu">c</span>(<span class="st">"S1"</span>, <span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span>, <span class="st">"S3"</span>),</span>
<span id="cb65-289"><a href="#cb65-289" aria-hidden="true" tabindex="-1"></a>  <span class="at">replicate =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb65-290"><a href="#cb65-290" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(<span class="fl">2.3</span>, <span class="fl">2.1</span>, <span class="fl">5.4</span>, <span class="fl">5.6</span>, <span class="fl">10.2</span>, <span class="fl">10.8</span>)</span>
<span id="cb65-291"><a href="#cb65-291" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-292"><a href="#cb65-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-293"><a href="#cb65-293" aria-hidden="true" tabindex="-1"></a><span class="co"># Join tables</span></span>
<span id="cb65-294"><a href="#cb65-294" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(measurements, samples, <span class="at">by =</span> <span class="st">"sample_id"</span>)</span>
<span id="cb65-295"><a href="#cb65-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-296"><a href="#cb65-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-297"><a href="#cb65-297" aria-hidden="true" tabindex="-1"></a><span class="fu">### Types of Joins</span></span>
<span id="cb65-298"><a href="#cb65-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-299"><a href="#cb65-299" aria-hidden="true" tabindex="-1"></a>Different joins handle non-matching rows differently. Understanding when to use each type is important for correct data analysis:</span>
<span id="cb65-300"><a href="#cb65-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-301"><a href="#cb65-301" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Join Type <span class="pp">|</span> Result <span class="pp">|</span></span>
<span id="cb65-302"><a href="#cb65-302" aria-hidden="true" tabindex="-1"></a><span class="pp">|:----------|:-------|</span></span>
<span id="cb65-303"><a href="#cb65-303" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`left_join()`</span> <span class="pp">|</span> Keep all rows from left table, add matching data from right <span class="pp">|</span></span>
<span id="cb65-304"><a href="#cb65-304" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`right_join()`</span> <span class="pp">|</span> Keep all rows from right table, add matching data from left <span class="pp">|</span></span>
<span id="cb65-305"><a href="#cb65-305" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`inner_join()`</span> <span class="pp">|</span> Keep only rows with matches in both tables <span class="pp">|</span></span>
<span id="cb65-306"><a href="#cb65-306" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`full_join()`</span> <span class="pp">|</span> Keep all rows from both tables <span class="pp">|</span></span>
<span id="cb65-307"><a href="#cb65-307" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`semi_join()`</span> <span class="pp">|</span> Keep rows from left table that have matches in right <span class="pp">|</span></span>
<span id="cb65-308"><a href="#cb65-308" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`anti_join()`</span> <span class="pp">|</span> Keep rows from left table with NO matches in right <span class="pp">|</span></span>
<span id="cb65-309"><a href="#cb65-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-310"><a href="#cb65-310" aria-hidden="true" tabindex="-1"></a>The <span class="in">`anti_join()`</span> is particularly useful for finding data quality issues—rows that should have matches but don't:</span>
<span id="cb65-311"><a href="#cb65-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-314"><a href="#cb65-314" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-315"><a href="#cb65-315" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb65-316"><a href="#cb65-316" aria-hidden="true" tabindex="-1"></a><span class="co"># Which measurements have no sample information?</span></span>
<span id="cb65-317"><a href="#cb65-317" aria-hidden="true" tabindex="-1"></a><span class="fu">anti_join</span>(measurements, samples, <span class="at">by =</span> <span class="st">"sample_id"</span>)</span>
<span id="cb65-318"><a href="#cb65-318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-319"><a href="#cb65-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-320"><a href="#cb65-320" aria-hidden="true" tabindex="-1"></a><span class="fu">## Additional dplyr Functions</span></span>
<span id="cb65-321"><a href="#cb65-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-322"><a href="#cb65-322" aria-hidden="true" tabindex="-1"></a>Beyond the five core verbs, dplyr provides many useful functions for common data manipulation tasks.</span>
<span id="cb65-323"><a href="#cb65-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-324"><a href="#cb65-324" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conditional Logic with case_when()</span></span>
<span id="cb65-325"><a href="#cb65-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-326"><a href="#cb65-326" aria-hidden="true" tabindex="-1"></a>The <span class="in">`case_when()`</span> function is a vectorized if-else that handles multiple conditions:</span>
<span id="cb65-327"><a href="#cb65-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-330"><a href="#cb65-330" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-331"><a href="#cb65-331" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample data</span></span>
<span id="cb65-332"><a href="#cb65-332" aria-hidden="true" tabindex="-1"></a>expression_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb65-333"><a href="#cb65-333" aria-hidden="true" tabindex="-1"></a>  <span class="at">gene =</span> <span class="fu">c</span>(<span class="st">"gene_A"</span>, <span class="st">"gene_B"</span>, <span class="st">"gene_C"</span>, <span class="st">"gene_D"</span>),</span>
<span id="cb65-334"><a href="#cb65-334" aria-hidden="true" tabindex="-1"></a>  <span class="at">fold_change =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.2</span>, <span class="fl">3.5</span>, <span class="sc">-</span><span class="fl">2.1</span>)</span>
<span id="cb65-335"><a href="#cb65-335" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-336"><a href="#cb65-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-337"><a href="#cb65-337" aria-hidden="true" tabindex="-1"></a>expression_data <span class="sc">|&gt;</span></span>
<span id="cb65-338"><a href="#cb65-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb65-339"><a href="#cb65-339" aria-hidden="true" tabindex="-1"></a>    <span class="at">regulation =</span> <span class="fu">case_when</span>(</span>
<span id="cb65-340"><a href="#cb65-340" aria-hidden="true" tabindex="-1"></a>      fold_change <span class="sc">&gt;</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"strongly up"</span>,</span>
<span id="cb65-341"><a href="#cb65-341" aria-hidden="true" tabindex="-1"></a>      fold_change <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"up"</span>,</span>
<span id="cb65-342"><a href="#cb65-342" aria-hidden="true" tabindex="-1"></a>      fold_change <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">~</span> <span class="st">"down"</span>,</span>
<span id="cb65-343"><a href="#cb65-343" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"unchanged"</span>  <span class="co"># default case</span></span>
<span id="cb65-344"><a href="#cb65-344" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb65-345"><a href="#cb65-345" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb65-346"><a href="#cb65-346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-347"><a href="#cb65-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-348"><a href="#cb65-348" aria-hidden="true" tabindex="-1"></a><span class="fu">### Counting with count() and n_distinct()</span></span>
<span id="cb65-349"><a href="#cb65-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-350"><a href="#cb65-350" aria-hidden="true" tabindex="-1"></a>The <span class="in">`count()`</span> function is a shortcut for grouping and counting:</span>
<span id="cb65-351"><a href="#cb65-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-354"><a href="#cb65-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-355"><a href="#cb65-355" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb65-356"><a href="#cb65-356" aria-hidden="true" tabindex="-1"></a><span class="co"># Equivalent to: group_by(x) |&gt; summarize(n = n())</span></span>
<span id="cb65-357"><a href="#cb65-357" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> <span class="fu">count</span>(treatment)</span>
<span id="cb65-358"><a href="#cb65-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-359"><a href="#cb65-359" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort by count</span></span>
<span id="cb65-360"><a href="#cb65-360" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> <span class="fu">count</span>(treatment, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span>
<span id="cb65-361"><a href="#cb65-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-362"><a href="#cb65-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-363"><a href="#cb65-363" aria-hidden="true" tabindex="-1"></a>Use <span class="in">`n_distinct()`</span> inside <span class="in">`summarize()`</span> to count unique values:</span>
<span id="cb65-364"><a href="#cb65-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-367"><a href="#cb65-367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-368"><a href="#cb65-368" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb65-369"><a href="#cb65-369" aria-hidden="true" tabindex="-1"></a><span class="co"># Count unique samples per treatment group</span></span>
<span id="cb65-370"><a href="#cb65-370" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb65-371"><a href="#cb65-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">|&gt;</span></span>
<span id="cb65-372"><a href="#cb65-372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n_samples =</span> <span class="fu">n_distinct</span>(sample_id))</span>
<span id="cb65-373"><a href="#cb65-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-374"><a href="#cb65-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-375"><a href="#cb65-375" aria-hidden="true" tabindex="-1"></a><span class="fu">### Selecting Rows by Position with slice()</span></span>
<span id="cb65-376"><a href="#cb65-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-377"><a href="#cb65-377" aria-hidden="true" tabindex="-1"></a>While <span class="in">`filter()`</span> selects rows by condition, <span class="in">`slice()`</span> selects by position:</span>
<span id="cb65-378"><a href="#cb65-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-381"><a href="#cb65-381" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-382"><a href="#cb65-382" aria-hidden="true" tabindex="-1"></a><span class="co"># First 3 rows</span></span>
<span id="cb65-383"><a href="#cb65-383" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris, <span class="dv">3</span>)</span>
<span id="cb65-384"><a href="#cb65-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-385"><a href="#cb65-385" aria-hidden="true" tabindex="-1"></a><span class="co"># Using slice variants</span></span>
<span id="cb65-386"><a href="#cb65-386" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">3</span>)    <span class="co"># First 3 rows</span></span>
<span id="cb65-387"><a href="#cb65-387" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">slice_tail</span>(<span class="at">n =</span> <span class="dv">3</span>)    <span class="co"># Last 3 rows</span></span>
<span id="cb65-388"><a href="#cb65-388" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">5</span>)  <span class="co"># Random 5 rows</span></span>
<span id="cb65-389"><a href="#cb65-389" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">slice_max</span>(Sepal.Length, <span class="at">n =</span> <span class="dv">3</span>)  <span class="co"># Top 3 by value</span></span>
<span id="cb65-390"><a href="#cb65-390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-391"><a href="#cb65-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-392"><a href="#cb65-392" aria-hidden="true" tabindex="-1"></a><span class="fu">### Extracting Columns with pull()</span></span>
<span id="cb65-393"><a href="#cb65-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-394"><a href="#cb65-394" aria-hidden="true" tabindex="-1"></a>To extract a single column as a vector (rather than a data frame), use <span class="in">`pull()`</span>:</span>
<span id="cb65-395"><a href="#cb65-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-398"><a href="#cb65-398" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-399"><a href="#cb65-399" aria-hidden="true" tabindex="-1"></a><span class="co"># Returns a vector, not a data frame</span></span>
<span id="cb65-400"><a href="#cb65-400" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span></span>
<span id="cb65-401"><a href="#cb65-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Species <span class="sc">==</span> <span class="st">"setosa"</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-402"><a href="#cb65-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(Sepal.Length) <span class="sc">|&gt;</span></span>
<span id="cb65-403"><a href="#cb65-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>()</span>
<span id="cb65-404"><a href="#cb65-404" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-405"><a href="#cb65-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-406"><a href="#cb65-406" aria-hidden="true" tabindex="-1"></a><span class="fu">### Distinct Values with distinct()</span></span>
<span id="cb65-407"><a href="#cb65-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-408"><a href="#cb65-408" aria-hidden="true" tabindex="-1"></a>Remove duplicate rows based on specified columns:</span>
<span id="cb65-409"><a href="#cb65-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-412"><a href="#cb65-412" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-413"><a href="#cb65-413" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb65-414"><a href="#cb65-414" aria-hidden="true" tabindex="-1"></a><span class="co"># Unique values in one column</span></span>
<span id="cb65-415"><a href="#cb65-415" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> <span class="fu">distinct</span>(treatment)</span>
<span id="cb65-416"><a href="#cb65-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-417"><a href="#cb65-417" aria-hidden="true" tabindex="-1"></a><span class="co"># Unique combinations of multiple columns</span></span>
<span id="cb65-418"><a href="#cb65-418" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span> <span class="fu">distinct</span>(treatment, time_point)</span>
<span id="cb65-419"><a href="#cb65-419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-420"><a href="#cb65-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-421"><a href="#cb65-421" aria-hidden="true" tabindex="-1"></a><span class="fu">## Working with Factors</span></span>
<span id="cb65-422"><a href="#cb65-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-423"><a href="#cb65-423" aria-hidden="true" tabindex="-1"></a>Factors are R's way of representing categorical data with a fixed set of possible values (called levels). The **forcats** package (part of tidyverse) provides tools for working with factors.</span>
<span id="cb65-424"><a href="#cb65-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-425"><a href="#cb65-425" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reordering Factor Levels</span></span>
<span id="cb65-426"><a href="#cb65-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-427"><a href="#cb65-427" aria-hidden="true" tabindex="-1"></a>For visualization, you often want factor levels ordered by a value rather than alphabetically:</span>
<span id="cb65-428"><a href="#cb65-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-431"><a href="#cb65-431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-432"><a href="#cb65-432" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb65-433"><a href="#cb65-433" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb65-434"><a href="#cb65-434" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb65-435"><a href="#cb65-435" aria-hidden="true" tabindex="-1"></a>gene_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb65-436"><a href="#cb65-436" aria-hidden="true" tabindex="-1"></a>  <span class="at">gene =</span> <span class="fu">c</span>(<span class="st">"BRCA1"</span>, <span class="st">"TP53"</span>, <span class="st">"EGFR"</span>, <span class="st">"KRAS"</span>, <span class="st">"MYC"</span>),</span>
<span id="cb65-437"><a href="#cb65-437" aria-hidden="true" tabindex="-1"></a>  <span class="at">expression =</span> <span class="fu">c</span>(<span class="fl">5.2</span>, <span class="fl">8.1</span>, <span class="fl">3.4</span>, <span class="fl">6.7</span>, <span class="fl">9.2</span>)</span>
<span id="cb65-438"><a href="#cb65-438" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-439"><a href="#cb65-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-440"><a href="#cb65-440" aria-hidden="true" tabindex="-1"></a><span class="co"># Default: alphabetical order</span></span>
<span id="cb65-441"><a href="#cb65-441" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(gene_data, <span class="fu">aes</span>(<span class="at">x =</span> gene, <span class="at">y =</span> expression)) <span class="sc">+</span></span>
<span id="cb65-442"><a href="#cb65-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb65-443"><a href="#cb65-443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Default (Alphabetical) Order"</span>)</span>
<span id="cb65-444"><a href="#cb65-444" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-445"><a href="#cb65-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-448"><a href="#cb65-448" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-449"><a href="#cb65-449" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 6</span></span>
<span id="cb65-450"><a href="#cb65-450" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 4</span></span>
<span id="cb65-451"><a href="#cb65-451" aria-hidden="true" tabindex="-1"></a><span class="co"># Reorder by expression value</span></span>
<span id="cb65-452"><a href="#cb65-452" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb65-453"><a href="#cb65-453" aria-hidden="true" tabindex="-1"></a>gene_data <span class="sc">|&gt;</span></span>
<span id="cb65-454"><a href="#cb65-454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gene =</span> <span class="fu">fct_reorder</span>(gene, expression)) <span class="sc">|&gt;</span></span>
<span id="cb65-455"><a href="#cb65-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gene, <span class="at">y =</span> expression)) <span class="sc">+</span></span>
<span id="cb65-456"><a href="#cb65-456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb65-457"><a href="#cb65-457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Ordered by Expression"</span>)</span>
<span id="cb65-458"><a href="#cb65-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-459"><a href="#cb65-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-460"><a href="#cb65-460" aria-hidden="true" tabindex="-1"></a><span class="fu">### Recoding Factor Levels</span></span>
<span id="cb65-461"><a href="#cb65-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-462"><a href="#cb65-462" aria-hidden="true" tabindex="-1"></a>Use <span class="in">`fct_recode()`</span> to change level names:</span>
<span id="cb65-463"><a href="#cb65-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-466"><a href="#cb65-466" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-467"><a href="#cb65-467" aria-hidden="true" tabindex="-1"></a><span class="co"># Original factor</span></span>
<span id="cb65-468"><a href="#cb65-468" aria-hidden="true" tabindex="-1"></a>status <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"WT"</span>, <span class="st">"WT"</span>, <span class="st">"KO"</span>, <span class="st">"HET"</span>, <span class="st">"KO"</span>))</span>
<span id="cb65-469"><a href="#cb65-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-470"><a href="#cb65-470" aria-hidden="true" tabindex="-1"></a><span class="co"># Recode to more descriptive names</span></span>
<span id="cb65-471"><a href="#cb65-471" aria-hidden="true" tabindex="-1"></a><span class="fu">fct_recode</span>(status,</span>
<span id="cb65-472"><a href="#cb65-472" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Wild Type"</span> <span class="ot">=</span> <span class="st">"WT"</span>,</span>
<span id="cb65-473"><a href="#cb65-473" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Knockout"</span> <span class="ot">=</span> <span class="st">"KO"</span>,</span>
<span id="cb65-474"><a href="#cb65-474" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Heterozygous"</span> <span class="ot">=</span> <span class="st">"HET"</span></span>
<span id="cb65-475"><a href="#cb65-475" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-476"><a href="#cb65-476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-477"><a href="#cb65-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-478"><a href="#cb65-478" aria-hidden="true" tabindex="-1"></a><span class="fu">### Collapsing Rare Levels</span></span>
<span id="cb65-479"><a href="#cb65-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-480"><a href="#cb65-480" aria-hidden="true" tabindex="-1"></a>Use <span class="in">`fct_lump_n()`</span> to combine infrequent categories into "Other":</span>
<span id="cb65-481"><a href="#cb65-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-484"><a href="#cb65-484" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-485"><a href="#cb65-485" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample with many categories</span></span>
<span id="cb65-486"><a href="#cb65-486" aria-hidden="true" tabindex="-1"></a>many_categories <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>, <span class="st">"F"</span>),</span>
<span id="cb65-487"><a href="#cb65-487" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">30</span>, <span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">2</span>)))</span>
<span id="cb65-488"><a href="#cb65-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-489"><a href="#cb65-489" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only the top 3 most common</span></span>
<span id="cb65-490"><a href="#cb65-490" aria-hidden="true" tabindex="-1"></a><span class="fu">fct_lump_n</span>(many_categories, <span class="at">n =</span> <span class="dv">3</span>)</span>
<span id="cb65-491"><a href="#cb65-491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-492"><a href="#cb65-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-493"><a href="#cb65-493" aria-hidden="true" tabindex="-1"></a><span class="fu">## Additional tidyr Functions</span></span>
<span id="cb65-494"><a href="#cb65-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-495"><a href="#cb65-495" aria-hidden="true" tabindex="-1"></a><span class="fu">### Separating and Combining Columns</span></span>
<span id="cb65-496"><a href="#cb65-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-497"><a href="#cb65-497" aria-hidden="true" tabindex="-1"></a><span class="in">`separate()`</span> splits one column into multiple columns; <span class="in">`unite()`</span> combines columns:</span>
<span id="cb65-498"><a href="#cb65-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-501"><a href="#cb65-501" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-502"><a href="#cb65-502" aria-hidden="true" tabindex="-1"></a><span class="co"># Data with combined values</span></span>
<span id="cb65-503"><a href="#cb65-503" aria-hidden="true" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb65-504"><a href="#cb65-504" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample =</span> <span class="fu">c</span>(<span class="st">"control_rep1"</span>, <span class="st">"control_rep2"</span>, <span class="st">"treatment_rep1"</span>),</span>
<span id="cb65-505"><a href="#cb65-505" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">25</span>)</span>
<span id="cb65-506"><a href="#cb65-506" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-507"><a href="#cb65-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-508"><a href="#cb65-508" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate into treatment and replicate</span></span>
<span id="cb65-509"><a href="#cb65-509" aria-hidden="true" tabindex="-1"></a>combined_data <span class="sc">|&gt;</span></span>
<span id="cb65-510"><a href="#cb65-510" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(sample, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"treatment"</span>, <span class="st">"replicate"</span>), <span class="at">sep =</span> <span class="st">"_"</span>)</span>
<span id="cb65-511"><a href="#cb65-511" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-512"><a href="#cb65-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-515"><a href="#cb65-515" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-516"><a href="#cb65-516" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine columns</span></span>
<span id="cb65-517"><a href="#cb65-517" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">year =</span> <span class="dv">2024</span>, <span class="at">month =</span> <span class="dv">3</span>, <span class="at">day =</span> <span class="dv">15</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-518"><a href="#cb65-518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unite</span>(date, year, month, day, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb65-519"><a href="#cb65-519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-520"><a href="#cb65-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-521"><a href="#cb65-521" aria-hidden="true" tabindex="-1"></a><span class="fu">### Handling Implicit Missing Values with complete()</span></span>
<span id="cb65-522"><a href="#cb65-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-523"><a href="#cb65-523" aria-hidden="true" tabindex="-1"></a>Sometimes data has implicit missing values—combinations that should exist but don't appear. <span class="in">`complete()`</span> makes them explicit:</span>
<span id="cb65-524"><a href="#cb65-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-527"><a href="#cb65-527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-528"><a href="#cb65-528" aria-hidden="true" tabindex="-1"></a><span class="co"># Implicit missing: no observation for site B in year 2021</span></span>
<span id="cb65-529"><a href="#cb65-529" aria-hidden="true" tabindex="-1"></a>observations <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb65-530"><a href="#cb65-530" aria-hidden="true" tabindex="-1"></a>  <span class="at">site =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>),</span>
<span id="cb65-531"><a href="#cb65-531" aria-hidden="true" tabindex="-1"></a>  <span class="at">year =</span> <span class="fu">c</span>(<span class="dv">2020</span>, <span class="dv">2021</span>, <span class="dv">2020</span>),</span>
<span id="cb65-532"><a href="#cb65-532" aria-hidden="true" tabindex="-1"></a>  <span class="at">count =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">8</span>)</span>
<span id="cb65-533"><a href="#cb65-533" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-534"><a href="#cb65-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-535"><a href="#cb65-535" aria-hidden="true" tabindex="-1"></a><span class="co"># Make all combinations explicit</span></span>
<span id="cb65-536"><a href="#cb65-536" aria-hidden="true" tabindex="-1"></a>observations <span class="sc">|&gt;</span></span>
<span id="cb65-537"><a href="#cb65-537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">complete</span>(site, year, <span class="at">fill =</span> <span class="fu">list</span>(<span class="at">count =</span> <span class="dv">0</span>))</span>
<span id="cb65-538"><a href="#cb65-538" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-539"><a href="#cb65-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-540"><a href="#cb65-540" aria-hidden="true" tabindex="-1"></a><span class="fu">## Practice Exercises</span></span>
<span id="cb65-541"><a href="#cb65-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-542"><a href="#cb65-542" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercise T.1: Tidyverse Basics</span></span>
<span id="cb65-543"><a href="#cb65-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-544"><a href="#cb65-544" aria-hidden="true" tabindex="-1"></a>Load the tidyverse and practice with a dataset:</span>
<span id="cb65-545"><a href="#cb65-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-548"><a href="#cb65-548" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-549"><a href="#cb65-549" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb65-550"><a href="#cb65-550" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb65-551"><a href="#cb65-551" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mpg)</span>
<span id="cb65-552"><a href="#cb65-552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-553"><a href="#cb65-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-554"><a href="#cb65-554" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Convert the <span class="in">`mpg`</span> data frame to a tibble using <span class="in">`as_tibble()`</span></span>
<span id="cb65-555"><a href="#cb65-555" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>What differences do you notice in how it prints?</span>
<span id="cb65-556"><a href="#cb65-556" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Use <span class="in">`glimpse()`</span> to get an overview of the data</span>
<span id="cb65-557"><a href="#cb65-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-558"><a href="#cb65-558" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercise T.2: The Five dplyr Verbs</span></span>
<span id="cb65-559"><a href="#cb65-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-560"><a href="#cb65-560" aria-hidden="true" tabindex="-1"></a>Using the <span class="in">`mpg`</span> dataset, practice each core verb:</span>
<span id="cb65-561"><a href="#cb65-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-562"><a href="#cb65-562" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**filter()**: Select only cars with highway mpg greater than 30</span>
<span id="cb65-563"><a href="#cb65-563" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**select()**: Choose only the manufacturer, model, and highway mpg columns</span>
<span id="cb65-564"><a href="#cb65-564" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**arrange()**: Sort by highway mpg in descending order</span>
<span id="cb65-565"><a href="#cb65-565" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**mutate()**: Create a new column that calculates the ratio of highway to city mpg</span>
<span id="cb65-566"><a href="#cb65-566" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**summarize()**: Calculate the mean highway mpg for the entire dataset</span>
<span id="cb65-567"><a href="#cb65-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-570"><a href="#cb65-570" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-571"><a href="#cb65-571" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb65-572"><a href="#cb65-572" aria-hidden="true" tabindex="-1"></a><span class="co"># Example solutions:</span></span>
<span id="cb65-573"><a href="#cb65-573" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> <span class="fu">filter</span>(hwy <span class="sc">&gt;</span> <span class="dv">30</span>)</span>
<span id="cb65-574"><a href="#cb65-574" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> <span class="fu">select</span>(manufacturer, model, hwy)</span>
<span id="cb65-575"><a href="#cb65-575" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(hwy))</span>
<span id="cb65-576"><a href="#cb65-576" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">hwy_city_ratio =</span> hwy <span class="sc">/</span> cty)</span>
<span id="cb65-577"><a href="#cb65-577" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">mean_hwy =</span> <span class="fu">mean</span>(hwy))</span>
<span id="cb65-578"><a href="#cb65-578" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-579"><a href="#cb65-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-580"><a href="#cb65-580" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercise T.3: Grouping and Summarizing</span></span>
<span id="cb65-581"><a href="#cb65-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-582"><a href="#cb65-582" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Group the <span class="in">`mpg`</span> data by manufacturer and calculate the mean highway mpg for each</span>
<span id="cb65-583"><a href="#cb65-583" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Find the manufacturer with the highest average highway mpg</span>
<span id="cb65-584"><a href="#cb65-584" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Count how many models each manufacturer has in the dataset</span>
<span id="cb65-585"><a href="#cb65-585" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Calculate both mean and standard deviation of highway mpg by vehicle class</span>
<span id="cb65-586"><a href="#cb65-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-589"><a href="#cb65-589" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-590"><a href="#cb65-590" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb65-591"><a href="#cb65-591" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">|&gt;</span></span>
<span id="cb65-592"><a href="#cb65-592" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(manufacturer) <span class="sc">|&gt;</span></span>
<span id="cb65-593"><a href="#cb65-593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb65-594"><a href="#cb65-594" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_hwy =</span> <span class="fu">mean</span>(hwy),</span>
<span id="cb65-595"><a href="#cb65-595" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_models =</span> <span class="fu">n</span>()</span>
<span id="cb65-596"><a href="#cb65-596" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb65-597"><a href="#cb65-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mean_hwy))</span>
<span id="cb65-598"><a href="#cb65-598" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-599"><a href="#cb65-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-600"><a href="#cb65-600" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercise T.4: Data Wrangling Pipeline</span></span>
<span id="cb65-601"><a href="#cb65-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-602"><a href="#cb65-602" aria-hidden="true" tabindex="-1"></a>Construct a pipeline that:</span>
<span id="cb65-603"><a href="#cb65-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-604"><a href="#cb65-604" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Filters for a subset of manufacturers (e.g., "audi", "toyota", "honda")</span>
<span id="cb65-605"><a href="#cb65-605" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Selects relevant columns</span>
<span id="cb65-606"><a href="#cb65-606" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Creates a new calculated column</span>
<span id="cb65-607"><a href="#cb65-607" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Groups by a categorical variable</span>
<span id="cb65-608"><a href="#cb65-608" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Summarizes with multiple statistics</span>
<span id="cb65-609"><a href="#cb65-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-612"><a href="#cb65-612" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-613"><a href="#cb65-613" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb65-614"><a href="#cb65-614" aria-hidden="true" tabindex="-1"></a>mpg <span class="sc">|&gt;</span></span>
<span id="cb65-615"><a href="#cb65-615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(manufacturer <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"audi"</span>, <span class="st">"toyota"</span>, <span class="st">"honda"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb65-616"><a href="#cb65-616" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(manufacturer, model, year, cty, hwy) <span class="sc">|&gt;</span></span>
<span id="cb65-617"><a href="#cb65-617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">avg_mpg =</span> (cty <span class="sc">+</span> hwy) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb65-618"><a href="#cb65-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(manufacturer) <span class="sc">|&gt;</span></span>
<span id="cb65-619"><a href="#cb65-619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb65-620"><a href="#cb65-620" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_mpg =</span> <span class="fu">mean</span>(avg_mpg),</span>
<span id="cb65-621"><a href="#cb65-621" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_mpg =</span> <span class="fu">sd</span>(avg_mpg),</span>
<span id="cb65-622"><a href="#cb65-622" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb65-623"><a href="#cb65-623" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb65-624"><a href="#cb65-624" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-625"><a href="#cb65-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-626"><a href="#cb65-626" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercise T.5: Reshaping Data</span></span>
<span id="cb65-627"><a href="#cb65-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-628"><a href="#cb65-628" aria-hidden="true" tabindex="-1"></a>Practice with <span class="in">`pivot_longer()`</span> and <span class="in">`pivot_wider()`</span>:</span>
<span id="cb65-629"><a href="#cb65-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-630"><a href="#cb65-630" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Create a wide dataset with measurements across multiple time points</span>
<span id="cb65-631"><a href="#cb65-631" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Convert it to long format using <span class="in">`pivot_longer()`</span></span>
<span id="cb65-632"><a href="#cb65-632" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Convert it back to wide format using <span class="in">`pivot_wider()`</span></span>
<span id="cb65-633"><a href="#cb65-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-636"><a href="#cb65-636" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-637"><a href="#cb65-637" aria-hidden="true" tabindex="-1"></a><span class="co"># Example wide data</span></span>
<span id="cb65-638"><a href="#cb65-638" aria-hidden="true" tabindex="-1"></a>wide_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb65-639"><a href="#cb65-639" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),</span>
<span id="cb65-640"><a href="#cb65-640" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_0 =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">12</span>, <span class="dv">8</span>),</span>
<span id="cb65-641"><a href="#cb65-641" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_1 =</span> <span class="fu">c</span>(<span class="dv">15</span>, <span class="dv">18</span>, <span class="dv">12</span>),</span>
<span id="cb65-642"><a href="#cb65-642" aria-hidden="true" tabindex="-1"></a>  <span class="at">time_2 =</span> <span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">25</span>, <span class="dv">18</span>)</span>
<span id="cb65-643"><a href="#cb65-643" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-644"><a href="#cb65-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-645"><a href="#cb65-645" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to long format</span></span>
<span id="cb65-646"><a href="#cb65-646" aria-hidden="true" tabindex="-1"></a>long_data <span class="ot">&lt;-</span> wide_data <span class="sc">|&gt;</span></span>
<span id="cb65-647"><a href="#cb65-647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb65-648"><a href="#cb65-648" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"time"</span>),</span>
<span id="cb65-649"><a href="#cb65-649" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"timepoint"</span>,</span>
<span id="cb65-650"><a href="#cb65-650" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"measurement"</span></span>
<span id="cb65-651"><a href="#cb65-651" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb65-652"><a href="#cb65-652" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(long_data)</span>
<span id="cb65-653"><a href="#cb65-653" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-654"><a href="#cb65-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-655"><a href="#cb65-655" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercise T.6: Joining Data</span></span>
<span id="cb65-656"><a href="#cb65-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-657"><a href="#cb65-657" aria-hidden="true" tabindex="-1"></a>Create two related tibbles and practice joins:</span>
<span id="cb65-658"><a href="#cb65-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-661"><a href="#cb65-661" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb65-662"><a href="#cb65-662" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample data</span></span>
<span id="cb65-663"><a href="#cb65-663" aria-hidden="true" tabindex="-1"></a>experiments <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb65-664"><a href="#cb65-664" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_id =</span> <span class="fu">c</span>(<span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span>, <span class="st">"S4"</span>),</span>
<span id="cb65-665"><a href="#cb65-665" aria-hidden="true" tabindex="-1"></a>  <span class="at">treatment =</span> <span class="fu">c</span>(<span class="st">"control"</span>, <span class="st">"low"</span>, <span class="st">"medium"</span>, <span class="st">"high"</span>)</span>
<span id="cb65-666"><a href="#cb65-666" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-667"><a href="#cb65-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-668"><a href="#cb65-668" aria-hidden="true" tabindex="-1"></a>measurements <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb65-669"><a href="#cb65-669" aria-hidden="true" tabindex="-1"></a>  <span class="at">sample_id =</span> <span class="fu">c</span>(<span class="st">"S1"</span>, <span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span>),</span>
<span id="cb65-670"><a href="#cb65-670" aria-hidden="true" tabindex="-1"></a>  <span class="at">replicate =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb65-671"><a href="#cb65-671" aria-hidden="true" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(<span class="fl">10.2</span>, <span class="fl">9.8</span>, <span class="fl">15.3</span>, <span class="fl">18.7</span>)</span>
<span id="cb65-672"><a href="#cb65-672" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-673"><a href="#cb65-673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb65-674"><a href="#cb65-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-675"><a href="#cb65-675" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Perform a <span class="in">`left_join()`</span> to add treatment information to measurements</span>
<span id="cb65-676"><a href="#cb65-676" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Use <span class="in">`anti_join()`</span> to find samples that have no measurements</span>
<span id="cb65-677"><a href="#cb65-677" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Explain the difference between <span class="in">`inner_join()`</span> and <span class="in">`full_join()`</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Statistics for Bioengineering by William Cresko</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>